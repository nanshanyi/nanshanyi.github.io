<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[封装一个匹配特定字符可点击的Label]]></title>
      <url>http://nanshanyi.github.io/2016/09/10/%E5%B0%81%E8%A3%85%E4%B8%80%E4%B8%AA%E5%8C%B9%E9%85%8D%E7%89%B9%E5%AE%9A%E5%AD%97%E7%AC%A6%E5%8F%AF%E7%82%B9%E5%87%BB%E7%9A%84Label/</url>
      <content type="html"><![CDATA[<p>&#x8FD9;&#x4E2A;&#x529F;&#x80FD;&#x7528;&#x7684;&#x6700;&#x591A;&#x7684;&#x5C31;&#x662F;&#x5728;&#x5FAE;&#x535A;&#x91CC;&#x9762;&#xFF0C;&#x91CC;&#x9762;&#x6709;&#x7528;&#x6237;&#x540D;@&#x5357;&#x5C71;&#x5FC6;&#xFF0C;&#x7F51;&#x5740;<a href="http://www.jianshu.com/users/774b1d5616a7/latest_articles&#xFF0C;#&#x8BDD;&#x9898;#" target="_blank" rel="external">http://www.jianshu.com/users/774b1d5616a7/latest_articles&#xFF0C;#&#x8BDD;&#x9898;#</a> &#x7B49;&#x9700;&#x8981;&#x7279;&#x522B;&#x73B0;&#x5B9E;&#xFF0C;&#x8FD8;&#x9700;&#x8981;&#x6709;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#xFF0C;&#x8FD9;&#x79CD;&#x60C5;&#x51B5;&#x4E0B;&#x666E;&#x901A;&#x7684;label&#x663E;&#x793A;&#x5DF2;&#x7ECF;&#x6EE1;&#x8DB3;&#x4E0D;&#x4E86;&#x9700;&#x6C42;&#x4E86;&#x3002;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x6765;&#x81EA;&#x5DF1;&#x5199;&#x4E00;&#x4E2A;&#x53EF;&#x5B9E;&#x73B0;&#x76F8;&#x5E94;&#x529F;&#x80FD;&#x7684;label&#x3002;<br>&#x3000;&#x3000;&#x597D;&#x4E86;&#x5E9F;&#x8BDD;&#x4E0D;&#x591A;&#x8BF4;&#xFF0C;&#x8BA9;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#xFF0C;&#x5927;&#x81F4;&#x6D41;&#x7A0B;&#x5982;&#x4E0B;&#xFF1A;<br><img src="/2016/09/10/&#x5C01;&#x88C5;&#x4E00;&#x4E2A;&#x5339;&#x914D;&#x7279;&#x5B9A;&#x5B57;&#x7B26;&#x53EF;&#x70B9;&#x51FB;&#x7684;Label/966908-f27bbdadc93c7346.png" width="%60" height="%60"><br><a id="more"></a></p>
<p>#####1&#x3001;&#x4E3B;&#x8981;&#x7528;&#x5230;&#x7684;&#x5C5E;&#x6027;<br>textStorage&#xFF0C;layoutManager&#xFF0C;textContainer&#x7684;&#x5173;&#x7CFB;<br>1&#xFF09;NSTextStorage&#x662F;NSMutableAttributedString&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x7531;&#x4E8E;&#x53EF;&#x4EE5;&#x7075;&#x6D3B;&#x5730;&#x5F80;&#x6587;&#x5B57;&#x6DFB;&#x52A0;&#x6216;&#x4FEE;&#x6539;&#x5C5E;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x975E;&#x5E38;&#x9002;&#x7528;&#x4E8E;&#x4FDD;&#x5B58;&#x5E76;&#x4FEE;&#x6539;&#x6587;&#x5B57;&#x5C5E;&#x6027;&#x3002;<br>2&#xFF09;NSLayoutManager&#x7528;&#x6765;&#x7BA1;&#x7406;NSTextStorage&#x5176;&#x4E2D;&#x7684;&#x6587;&#x5B57;&#x5185;&#x5BB9;&#x7684;&#x6392;&#x7248;&#x5E03;&#x5C40;&#x3002;<br>3&#xFF09;NSTextContainer&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x77E9;&#x5F62;&#x533A;&#x57DF;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x5DF2;&#x7ECF;&#x8FDB;&#x884C;&#x4E86;&#x6392;&#x7248;&#x5E76;&#x8BBE;&#x7F6E;&#x597D;&#x5C5E;&#x6027;&#x7684;&#x6587;&#x5B57;<br>&#x4E09;&#x8005;&#x5173;&#x7CFB;&#x5982;&#x56FE;&#x6240;&#x793A;<br><img src="/2016/09/10/&#x5C01;&#x88C5;&#x4E00;&#x4E2A;&#x5339;&#x914D;&#x7279;&#x5B9A;&#x5B57;&#x7B26;&#x53EF;&#x70B9;&#x51FB;&#x7684;Label/966908-c7bbb6aa396eac57.png" width="%60" height="%60"></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x662F;NSMutableAttributedString&#x7684;&#x5B50;&#x7C7B;&#xFF0C;&#x7531;&#x4E8E;&#x53EF;&#x4EE5;&#x7075;&#x6D3B;&#x5730;&#x5F80;&#x6587;&#x5B57;&#x6DFB;&#x52A0;&#x6216;&#x4FEE;&#x6539;&#x5C5E;&#x6027;&#xFF0C;&#x6240;&#x4EE5;&#x975E;&#x5E38;&#x9002;&#x7528;&#x4E8E;&#x4FDD;&#x5B58;&#x5E76;&#x4FEE;&#x6539;&#x6587;&#x5B57;&#x5C5E;&#x6027;&#x3002;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSTextStorage</span> *textStorage;</span><br><span class="line"><span class="comment">//&#x7BA1;&#x7406;NSTextStorage&#x5176;&#x4E2D;&#x7684;&#x6587;&#x5B57;&#x5185;&#x5BB9;&#x7684;&#x6392;&#x7248;&#x5E03;&#x5C40;&#x3002;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSLayoutManager</span> *layoutManager;</span><br><span class="line"><span class="comment">//&#x5B9A;&#x4E49;&#x4E86;&#x4E00;&#x4E2A;&#x77E9;&#x5F62;&#x533A;&#x57DF;&#x7528;&#x4E8E;&#x5B58;&#x653E;&#x5DF2;&#x7ECF;&#x8FDB;&#x884C;&#x4E86;&#x6392;&#x7248;&#x5E76;&#x8BBE;&#x7F6E;&#x597D;&#x5C5E;&#x6027;&#x7684;&#x6587;&#x5B57;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSTextContainer</span> *textContainer;</span><br></pre></td></tr></table></figure>
<p>&#x9700;&#x8981;&#x91CD;&#x5199;&#x7CFB;&#x7EDF;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x8BB2;&#x4E3B;&#x8981;&#x7684;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">- (instancetype)initWithFrame:(<span class="built_in">CGRect</span>)frame</span><br><span class="line">{</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (<span class="keyword">self</span>) {</span><br><span class="line">       <span class="comment">//&#x51C6;&#x5907;&#x6587;&#x672C;</span></span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">self</span> prepareTextSystem];</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x8BBE;&#x7F6E;&#x5BB9;&#x5668;&#x5927;&#x5C0F;&#x4E3A;label&#x7684;&#x5C3A;&#x5BF8;</span></span><br><span class="line">- (<span class="keyword">void</span>)layoutSubviews{</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.textContainer.size = <span class="keyword">self</span>.frame.size;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x91CD;&#x5199;drawTextInRect&#x65B9;&#x6CD5;&#x7ED8;&#x5236;&#x80CC;&#x666F;&#xFF0C;&#x6587;&#x5B57;</span></span><br><span class="line">- (<span class="keyword">void</span>)drawTextInRect:(<span class="built_in">CGRect</span>)rect{</span><br><span class="line">&#xA0;&#xA0; &#xA0;<span class="comment">//&#x5982;&#x679C;&#x6709;&#x9009;&#x4E2D;&#x7684;range&#xFF0C;&#x6539;&#x53D8;&#x6587;&#x5B57;&#x80CC;&#x666F;&#x989C;&#x8272;&#x3002;</span></span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (_selectedRangeValue) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="built_in">UIColor</span> *selectColor = _isSelected ? [<span class="built_in">UIColor</span> colorWithWhite:<span class="number">0.6</span> alpha:<span class="number">0.2</span>] : [<span class="built_in">UIColor</span> clearColor];</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x6587;&#x5B57;&#x80CC;&#x666F;&#x989C;&#x8272;</span></span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">self</span>.textStorage addAttribute:<span class="built_in">NSBackgroundColorAttributeName</span> value:selectColor range:<span class="keyword">self</span>.selectedRangeValue.rangeValue];</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="comment">//&#x7ED8;&#x5236;&#x80CC;&#x666F;&#x989C;&#x8272;</span></span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">self</span>.layoutManager drawBackgroundForGlyphRange:<span class="keyword">self</span>.selectedRangeValue.rangeValue atPoint:<span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0</span>)];</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSRange</span> range = <span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="keyword">self</span>.textStorage.length);</span><br><span class="line">&#xA0; &#xA0; [<span class="keyword">self</span>.layoutManager drawGlyphsForGlyphRange:range atPoint:<span class="built_in">CGPointZero</span>];</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>#####2&#x3001;&#x51C6;&#x5907;&#x6587;&#x672C;&#x663E;&#x793A;<br>&#x3000;&#x3000;&#x8FD9;&#x91CC;&#x9762;&#x4F1A;&#x7528;&#x5230;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#xFF0C;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x662F;&#x4E00;&#x95E8;&#x633A;&#x6DF1;&#x7684;&#x5B66;&#x95EE;&#x3002;&#x6709;&#x4E0D;&#x592A;&#x4E86;&#x89E3;&#x7684;&#x7AE5;&#x978B;&#x53EF;&#x4EE5;&#x53C2;&#x8003;<br><a href="http://deerchao.net/tutorials/regex/regex-1.htm" target="_blank">&#x8FD9;&#x7BC7;&#x6587;&#x7AE0;</a></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)prepareTextSystem {</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x5C06;&#x5E03;&#x5C40;&#x6DFB;&#x52A0;&#x5230;storage</span></span><br><span class="line">&#xA0; &#xA0; [<span class="keyword">self</span>.textStorage addLayoutManager:<span class="keyword">self</span>.layoutManager];</span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x5C06;&#x5BB9;&#x5668;&#x6DFB;&#x52A0;&#x5230;&#x5E03;&#x5C40;&#x4E2D;</span></span><br><span class="line">&#xA0; &#xA0; [<span class="keyword">self</span>.layoutManager addTextContainer:<span class="keyword">self</span>.textContainer];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.userInteractionEnabled = <span class="literal">YES</span>;</span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x5DE6;&#x53F3;&#x8FB9;&#x8DDD;</span></span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.textContainer.lineFragmentPadding = <span class="number">10</span>;</span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)prepareText{</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSAttributedString</span> *attrString;</span><br><span class="line"><span class="comment">//&#x62FF;&#x5230;&#x6587;&#x672C;&#xFF0C;&#x6216;&#x8005;&#x5BCC;&#x6587;&#x672C;&#xFF0C;&#x62FF;&#x4E0D;&#x5230;&#x7F6E;&#x4E3A;&#x7A7A;</span></span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (<span class="keyword">self</span>.attributedText) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; attrString = <span class="keyword">self</span>.attributedText;</span><br><span class="line">&#xA0; &#xA0; }<span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">self</span>.text){</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; attrString = [[<span class="built_in">NSAttributedString</span> alloc]initWithString:<span class="keyword">self</span>.text];</span><br><span class="line">&#xA0; &#xA0; }<span class="keyword">else</span> {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; attrString = [[<span class="built_in">NSAttributedString</span> alloc]initWithString:<span class="string">@&quot;&quot;</span>];</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.selectedRangeValue = <span class="literal">nil</span>;</span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x6298;&#x884C;&#x6A21;&#x5F0F;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSMutableAttributedString</span> *attrMString = [<span class="keyword">self</span> addLineBreak:attrString];</span><br><span class="line">&#xA0; &#xA0; [<span class="keyword">self</span>.textStorage setAttributedString:attrMString];</span><br><span class="line">&#xA0;&#xA0; &#xA0;</span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x6B63;&#x5219;&#x5339;&#x914D;&#xFF0C;&#x5339;&#x914D;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;@XXX&#x548C;URL</span></span><br><span class="line">&#xA0;&#xA0; &#xA0; <span class="keyword">self</span>.linkRanges = [<span class="keyword">self</span> getRanges:<span class="string">@&quot;http(s)?://([\\w-]+\\.)+[\\w-]+(/[\\w- ./?%&amp;=]*)?&quot;</span>];</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">UIColor</span> *attrColor = _attrStrColor == <span class="literal">nil</span> ? [<span class="built_in">UIColor</span> blueColor] : _attrStrColor;</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">for</span> (<span class="built_in">NSValue</span> *rangeValue <span class="keyword">in</span> <span class="keyword">self</span>.linkRanges) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">self</span>.textStorage addAttribute:<span class="built_in">NSForegroundColorAttributeName</span> value:attrColor range:rangeValue.rangeValue];</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0;&#xA0; &#xA0;</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.userRanges = [<span class="keyword">self</span> getRanges:<span class="string">@&quot;@\\w{1,}?:&quot;</span>];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">for</span> (<span class="built_in">NSValue</span> *rangeValue <span class="keyword">in</span> <span class="keyword">self</span>.userRanges) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">self</span>.textStorage addAttribute:<span class="built_in">NSForegroundColorAttributeName</span> value:attrColor range:rangeValue.rangeValue];</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0;&#xA0; &#xA0;<span class="comment">//&#x5339;&#x914D;&#x5B8C;&#x6210;&#x8C03;&#x7528;setNeedsDisplay&#xFF0C;&#x6765;&#x89E6;&#x53D1;drawTextInRect&#x7ED8;&#x5236;&#x6587;&#x5B57;</span></span><br><span class="line">&#xA0; &#xA0; [<span class="keyword">self</span> setNeedsDisplay];</span><br><span class="line">}</span><br><span class="line"><span class="comment">//&#x6DFB;&#x52A0;&#x6298;&#x884C;&#x6A21;&#x5F0F;</span></span><br><span class="line">- (<span class="built_in">NSMutableAttributedString</span>*)addLineBreak:(<span class="built_in">NSAttributedString</span> *) attrString{</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSMutableAttributedString</span> *attrMString = [[<span class="built_in">NSMutableAttributedString</span> alloc]initWithAttributedString:attrString];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (attrMString.length == <span class="number">0</span>) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">return</span> attrMString;</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSRange</span> range = <span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSMutableDictionary</span> *dict = (<span class="built_in">NSMutableDictionary</span>*)[attrMString attributesAtIndex:<span class="number">0</span> effectiveRange:&amp;range];</span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x91CC;&#x9762;&#x6709;NSShadow,NSParagraphStyle,NSFont,NSColor&#x56DB;&#x4E2A;&#x503C;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;%@&quot;</span>,dict);</span><br><span class="line">&#xA0;&#xA0; &#xA0;</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSMutableParagraphStyle</span> *paragraphStyle = [dict[<span class="built_in">NSParagraphStyleAttributeName</span>] mutableCopy] ;</span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x8BBE;&#x7F6E;paragraphStyle&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x4E3A;&#x7A7A;&#xFF0C;&#x5219;&#x8BBE;&#x7F6E;&#x6298;&#x884C;&#x6A21;&#x5F0F;,&#x4E3A;&#x7A7A;&#x5219;&#x81EA;&#x5DF1;&#x751F;&#x6210;&#x5E76;add</span></span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (paragraphStyle) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; paragraphStyle.lineBreakMode = <span class="built_in">NSLineBreakByCharWrapping</span>;</span><br><span class="line">&#xA0; &#xA0; }<span class="keyword">else</span> {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; paragraphStyle = [[<span class="built_in">NSMutableParagraphStyle</span> alloc]init];</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; paragraphStyle.lineBreakMode = <span class="built_in">NSLineBreakByCharWrapping</span>;</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; [attrMString addAttribute:<span class="built_in">NSParagraphStyleAttributeName</span> value:paragraphStyle range:range];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">return</span> attrMString;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>#####3&#x3001;&#x6B63;&#x5219;&#x7684;&#x5339;&#x914D;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">NSMutableArray</span>&lt;<span class="built_in">NSValue</span> *&gt; *)getRanges:(<span class="built_in">NSString</span>*)pattern{</span><br><span class="line">&#xA0;&#xA0; &#xA0;<span class="comment">//&#x751F;&#x6210;&#x5339;&#x914D;&#x89C4;&#x5219;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSRegularExpression</span> *regular = [[<span class="built_in">NSRegularExpression</span> alloc]initWithPattern:pattern options:<span class="built_in">NSRegularExpressionCaseInsensitive</span> error:<span class="literal">nil</span>];</span><br><span class="line"><span class="comment">//&#x6839;&#x636E;&#x5339;&#x914D;&#x89C4;&#x5219;&#x5339;&#x914D;&#x76F8;&#x5E94;&#x7684;&#x6587;&#x5B57;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSArray</span> *results = [regular matchesInString:<span class="keyword">self</span>.textStorage.string options:<span class="built_in">NSMatchingReportCompletion</span> range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, <span class="keyword">self</span>.textStorage.string.length)];</span><br><span class="line"><span class="comment">//&#x7531;&#x4E8E;OC&#x7684;&#x6570;&#x7EC4;&#x53EA;&#x80FD;&#x653E;&#x5BF9;&#x8C61;&#xFF0C;NSRange&#x662F;&#x4E0D;&#x80FD;&#x653E;&#x8FDB;&#x53BB;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x5728;&#x6B64;&#x8F6C;&#x6362;&#x4E3A;NSValue&#x6765;&#x653E;&#x5165;&#x6570;&#x7EC4;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSMutableArray</span> *ranges = [<span class="built_in">NSMutableArray</span> array];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">for</span> (<span class="built_in">NSTextCheckingResult</span> *result <span class="keyword">in</span> results) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="built_in">NSValue</span> *value = [<span class="built_in">NSValue</span> valueWithRange:result.range];</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [ranges addObject:value];</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">return</span> ranges;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>#####4&#x3001;&#x70B9;&#x51FB;&#x4EA4;&#x4E92;&#x5904;&#x7406;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)touchesBegan:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event{</span><br><span class="line">  <span class="comment">//&#x8BB0;&#x5F55;&#x662F;&#x5426;&#x6709;&#x9009;&#x4E2D;</span></span><br><span class="line">&#xA0; &#xA0; _isSelected = <span class="literal">YES</span>;</span><br><span class="line"><span class="comment">//&#x62FF;&#x5230;touch&#x7684;&#x4F4D;&#x7F6E;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">CGPoint</span> selectPoint = [[touches anyObject] locationInView:<span class="keyword">self</span>];</span><br><span class="line"><span class="comment">//&#x83B7;&#x53D6;touch&#x7684;&#x4F4D;&#x7F6E;&#x5728;&#x90A3;&#x4E2A;range&#x8303;&#x56F4;&#x5185;&#xFF0C;&#x62FF;&#x5230;selectedRange</span></span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.selectedRangeValue = [<span class="keyword">self</span> getSelectRange:selectPoint];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (!_selectedRangeValue) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">super</span> touchesBegan:touches withEvent:event];</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event{</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (!_selectedRangeValue) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">super</span> touchesEnded:touches withEvent:event];</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">return</span>;</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line"><span class="comment">//&#x662F;&#x5426;&#x6709;&#x9009;&#x4E2D;&#x7F6E;&#x4E3A;NO</span></span><br><span class="line">&#xA0; &#xA0; _isSelected = <span class="literal">NO</span>;</span><br><span class="line"><span class="comment">//&#x66F4;&#x65B0;label&#x663E;&#x793A;</span></span><br><span class="line">&#xA0; &#xA0; [<span class="keyword">self</span> setNeedsDisplay];</span><br><span class="line"><span class="comment">//&#x56DE;&#x8C03;Block&#x89E6;&#x53D1;&#x76F8;&#x5E94;&#x7684;&#x4E8B;&#x4EF6;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSString</span> *contentText = [<span class="keyword">self</span>.textStorage.string substringWithRange:_selectedRangeValue.rangeValue];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">switch</span> (_tapHandleType) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">case</span> TapHandleUser:</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">if</span> (_userTaphandle) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; _userTaphandle(<span class="keyword">self</span>,contentText,_selectedRangeValue.rangeValue);</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">break</span>;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">case</span> TapHandlelink:</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">if</span> (_linkTapHandle) {</span><br><span class="line">&#xA0;&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; _linkTapHandle(<span class="keyword">self</span>,contentText,_selectedRangeValue.rangeValue);</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">break</span>;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">default</span>:</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">break</span>;</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0;&#xA0; &#xA0;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//&#x83B7;&#x53D6;&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;&#x5728;&#x54EA;&#x4E2A;range&#x8303;&#x56F4;&#x5185;</span></span><br><span class="line">-(<span class="built_in">NSValue</span>*)getSelectRange:(<span class="built_in">CGPoint</span>)selectPoint{</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">if</span> (<span class="keyword">self</span>.textStorage.length == <span class="number">0</span>) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; <span class="comment">//&#x6839;&#x636E;&#x7535;&#x673A;&#x7684;&#x4F4D;&#x7F6E;&#x5F97;&#x5230;&#x70B9;&#x51FB;&#x7684;&#x662F;label&#x5185;&#x7684;&#x7B2C;&#x51E0;&#x4E2A;&#x5B57;&#x7B26;&#x7D22;&#x5F15;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSInteger</span> index = [<span class="keyword">self</span>.layoutManager glyphIndexForPoint:selectPoint inTextContainer:<span class="keyword">self</span>.textContainer];</span><br><span class="line"><span class="comment">//&#x904D;&#x5386;&#x6240;&#x6709;range,&#x786E;&#x5B9A;index&#x5728;&#x54EA;&#x4E2A;range&#x8303;&#x56F4;&#x5185;</span></span><br><span class="line">&#xA0; &#xA0; <span class="keyword">for</span> (<span class="built_in">NSValue</span> *rangeValue <span class="keyword">in</span> <span class="keyword">self</span>.linkRanges) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="built_in">NSRange</span> range = rangeValue.rangeValue;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">if</span> (index &gt;= range.location &amp;&amp; index &lt;range.location + range.length) {</span><br><span class="line"><span class="comment">//&#x4E00;&#x65E6;&#x904D;&#x5386;&#x5230;&#x5C31;&#x8BB0;&#x5F55;&#x70B9;&#x51FB;&#x7684;&#x8303;&#x56F4;&#x7C7B;&#x578B;&#xFF0C;&#x8C03;&#x7528;setNeedsDisplay&#x89E6;&#x53D1;&#x6587;&#x5B57;label&#x91CD;&#x65B0;&#x7ED8;&#x5236;</span></span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; _tapHandleType = TapHandlelink;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">self</span> setNeedsDisplay];</span><br><span class="line"><span class="comment">//&#x8FD4;&#x56DE;range&#x8303;&#x56F4;</span></span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">return</span> rangeValue;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">for</span> (<span class="built_in">NSValue</span> *rangeValue <span class="keyword">in</span> <span class="keyword">self</span>.userRanges) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="built_in">NSRange</span> range = rangeValue.rangeValue;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">if</span> (index &gt;= range.location &amp;&amp; index &lt;range.location + range.length) {</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; _tapHandleType = TapHandleUser;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; [<span class="keyword">self</span> setNeedsDisplay];</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; &#xA0; &#xA0; <span class="keyword">return</span> rangeValue;</span><br><span class="line">&#xA0; &#xA0; &#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; }</span><br><span class="line">&#xA0; &#xA0; _tapHandleType = TapHandleNone;</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>#####5&#x3001;&#x603B;&#x7ED3;<br>&#x3000;&#x3000;1&#x3001;&#x8FD9;&#x91CC;&#x9762;&#x4E3B;&#x8981;&#x7528;&#x5230;&#x4E86;&#x4E09;&#x4E2A;&#x91CD;&#x8981;&#x7684;&#x5C5E;&#x6027;&#xFF1A;NSTextStorage&#x3001;NSLayoutManager&#x3001;NSTextContainer&#x8981;&#x9AD8;&#x660E;&#x767D;&#x5176;&#x4E2D;&#x7684;&#x5173;&#x7CFB;&#x3002;&#x4E0A;&#x9762;&#x6709;&#x56FE;&#x4ECB;&#x7ECD;&#x3002;<br>&#x3000;&#x3000;2&#x3001;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x73B0;&#x5728;&#x57FA;&#x672C;&#x4E0A;&#x5927;&#x90E8;&#x5206;&#x8BED;&#x8A00;&#x90FD;&#x652F;&#x6301;&#x6B63;&#x5219;&#xFF0C;&#x91CC;&#x9762;&#x7684;&#x5B66;&#x95EE;&#x5F88;&#x591A;&#xFF0C;&#x9700;&#x8981;&#x591A;&#x52A0;&#x5B66;&#x4E60;&#x3002;<br>&#x3000;&#x3000;3&#x3001;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x7684;&#x5904;&#x7406;&#x3002;<br>&#x8FD9;&#x662F;<a href="https://github.com/nanshanyi/GHLabel" target="_blank">GitHub&#x5730;&#x5740;</a>&#x53EF;&#x4EE5;&#x5728;&#x6B64;&#x67E5;&#x770B;&#x6E90;&#x7801;&#x3002;&#x672C;&#x6587;&#x4E3A;&#x539F;&#x521B;&#xFF0C;&#x5982;&#x9700;&#x8F6C;&#x8F7D;&#x8BF7;&#x6CE8;&#x660E;&#x51FA;&#x5904;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[NSString的Copy与Strong你用对了吗？]]></title>
      <url>http://nanshanyi.github.io/2016/08/12/NSString%E7%9A%84Copy%E4%B8%8EStrong%E4%BD%A0%E7%94%A8%E5%AF%B9%E4%BA%86%E5%90%97%EF%BC%9F/</url>
      <content type="html"><![CDATA[<p>NSString&#x6211;&#x4EEC;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#x7C7B;,&#x4F46;&#x662F;&#x5728;&#x4F60;@property&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5230;&#x5E95;&#x662F;&#x7528;Strong&#xFF0C;&#x8FD8;&#x662F;Copy&#x4FEE;&#x9970;&#x3002;&#x4F60;&#x7528;&#x5BF9;&#x4E86;&#x5417;&#xFF1F;</p>
<h5 id="&#x7528;&#x4F8B;&#x5B50;&#x6765;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;"><a href="#&#x7528;&#x4F8B;&#x5B50;&#x6765;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;" class="headerlink" title="&#x7528;&#x4F8B;&#x5B50;&#x6765;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;"></a>&#x7528;&#x4F8B;&#x5B50;&#x6765;&#x8BF4;&#x660E;&#x4E00;&#x4E0B;</h5><p>######&#x5148;&#x4F7F;&#x7528;NSString<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">NSString</span> *strongStr;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, &#xA0; <span class="keyword">copy</span>) <span class="built_in">NSString</span> *copyedStr;</span><br><span class="line"><span class="comment">//&#x4E0D;&#x53EF;&#x4EE5;&#x5199;&#x6210;copyStr&#x4F1A;&#x62A5;property follows cocoa naming convention for returning &apos;owned&apos; objects</span></span><br><span class="line"><span class="comment">//&#x610F;&#x601D;&#x662F;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;copy&#x6765;&#x4F5C;&#x4E3A;&#x5F00;&#x5934;&#x547D;&#x540D;&#xFF0C;copy&#x662F;cocoa&#x7528;&#x7684;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x8FD9;&#x91CC;&#x58F0;&#x660E;&#x4E86;&#x4E24;&#x4E2A;NSString&#x53D8;&#x91CF;&#xFF0C;&#x4E00;&#x4E2A;&#x7528;strong&#x4FEE;&#x9970;&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x7528;copy&#x6765;&#x4FEE;&#x9970;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6765;&#x7528;&#x4E00;&#x4E2A;NSString&#x5BF9;&#x4E24;&#x4E2A;string&#x8D4B;&#x503C;&#x3002;<br><a id="more"></a></p>
<p>######&#x8F93;&#x51FA;&#x67E5;&#x770B;&#x4E00;&#x4E0B;&#x7ED3;&#x679C;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#xA0; &#xA0; <span class="built_in">NSString</span> *testStr = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@&quot;nanshanyi&quot;</span>];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.strongStr = testStr;</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.copyedStr = testStr;</span><br><span class="line">&#xA0;&#xA0; &#xA0;</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;testStr: &#xA0; %p, %p&quot;</span>,testStr,&amp;testStr);</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;strongStr: %p, %p&quot;</span>,_strongStr,&amp;_strongStr);</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;copyedStr: %p, %p&quot;</span>,_copyedStr,&amp;_copyedStr);</span><br><span class="line"><span class="comment">//&#x524D;&#x9762;&#x7684;&#x662F;&#x5185;&#x5B58;&#x5730;&#x5740;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x662F;&#x6307;&#x9488;&#x5730;&#x5740;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">testStr: &#xA0; <span class="number">0xa01c06542cac2d0a</span>, <span class="number">0x16fdb1f48</span></span><br><span class="line">strongStr: <span class="number">0xa01c06542cac2d0a</span>, <span class="number">0x1346e6030</span></span><br><span class="line">copyedStr: <span class="number">0xa01c06542cac2d0a</span>, <span class="number">0x1346e6038</span></span><br></pre></td></tr></table></figure>
<p>&#x3000;&#x3000;&#x6839;&#x636E;&#x8F93;&#x51FA;&#x7684;&#x5185;&#x5B58;&#x5730;&#x5740;&#xFF0C;&#x6211;&#x4EEC;&#x53D1;&#x73B0;&#xFF0C;&#x4E0D;&#x7BA1;&#x7528;&#x7684;&#x662F;strong&#x8FD8;&#x662F;copy&#xFF0C;&#x6307;&#x5411;&#x7684;&#x90FD;&#x662F;&#x540C;&#x4E00;&#x4E2A;&#x5730;&#x5740;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;testStr&#x7684;&#x5730;&#x5740;&#x3002;strongStr&#x548C;copyedStr&#x90FD;&#x53EA;&#x662F;&#x5BF9;testStr&#x7684;&#x5F15;&#x7528;&#xFF0C;&#x53EA;&#x4F1A;&#x5BFC;&#x81F4;testStr&#x7684;&#x8BA1;&#x6570;&#x5668;&#x52A0;1&#xFF0C;&#x5E76;&#x6CA1;&#x6709;&#x62F7;&#x8D1D;&#x4E00;&#x4EFD;&#x65B0;&#x7684;&#xFF0C;testStr&#x7684;retainCount&#x5E94;&#x8BE5;&#x662F;3&#x3002;</p>
<p>######&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x6539;&#x7528;NSMutableString<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#xA0; &#xA0; <span class="built_in">NSMutableString</span> *testStr = [<span class="built_in">NSMutableString</span> stringWithFormat:<span class="string">@&quot;nanshanyi&quot;</span>];</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.strongStr = testStr;</span><br><span class="line">&#xA0; &#xA0; <span class="keyword">self</span>.copyedStr = testStr;</span><br><span class="line">&#xA0;&#xA0; &#xA0;</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;testStr: &#xA0; %p, %p&quot;</span>,testStr,&amp;testStr);</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;strongStr: %p, %p&quot;</span>,_strongStr,&amp;_strongStr);</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;copyedStr: %p, %p&quot;</span>,_copyedStr,&amp;_copyedStr);</span><br><span class="line"></span><br><span class="line">&#xA0; &#xA0; [testStr appendString:<span class="string">@&quot;123&quot;</span>];<span class="comment">//&#x4FEE;&#x6539;&#x4E00;&#x4E0B;</span></span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;testStr: &#xA0; %@, %p&quot;</span>,testStr,&amp;testStr);</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;strongStr: %@, %p&quot;</span>,_strongStr,&amp;_strongStr);</span><br><span class="line">&#xA0; &#xA0; <span class="built_in">NSLog</span>(<span class="string">@&quot;copyedStr: %@, %p&quot;</span>,_copyedStr,&amp;_copyedStr);</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x6211;&#x4EEC;&#x518D;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x7ED3;&#x679C;&#xFF1A;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">testStr: &#xA0; <span class="number">0x15cdf87f0</span>, <span class="number">0x16fd99f48</span></span><br><span class="line">strongStr: <span class="number">0x15cdf87f0</span>, <span class="number">0x15cdf3ad0</span></span><br><span class="line">copyedStr: <span class="number">0xa0b20b31520b9419</span>, <span class="number">0x15cdf3ad8</span></span><br><span class="line"><span class="comment">//&#x4FEE;&#x6539;&#x540E;&#x8F93;&#x51FA;&#x4E00;&#x4E0B;&#x5B57;&#x7B26;&#x4E32;&#x5185;&#x5BB9;</span></span><br><span class="line">testStr: &#xA0; nanshanyi123, <span class="number">0x16fd99f48</span></span><br><span class="line">strongStr: nanshanyi123, <span class="number">0x15cdf3ad0</span></span><br><span class="line">copyedStr: nanshanyi, <span class="number">0x15cdf3ad8</span></span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#xFF0C;copy&#x4FEE;&#x9970;&#x7684;copyedStr&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x5DF2;&#x7ECF;&#x4E0D;&#x518D;&#x662F;&#x7B80;&#x5355;&#x7684;&#x5F15;&#x7528;&#x4E86;&#xFF0C;&#x800C;&#x662F;&#x62F7;&#x8D1D;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#xFF0C;&#x8BA9;copyedStr&#x6307;&#x5411;&#x4E86;&#x8FD9;&#x4E2A;&#x65B0;&#x7684;&#x5730;&#x5740;&#x3002;&#x6B64;&#x65F6;testStr&#x7684;retainCount&#x5E94;&#x8BE5;&#x662F;2&#x3002;<br>&#x3000;&#x3000;&#x7136;&#x540E;&#x6211;&#x4EEC;&#x628A;testStr&#x4FEE;&#x6539;&#x4E00;&#x4E0B;&#xFF0C;&#x540E;&#x9762;&#x63A5;&#x4E0A;&#x4E86;&#x201C;123&#x201D;&#xFF0C;&#x8F93;&#x51FA;&#x5185;&#x5BB9;&#x4F1A;&#x53D1;&#x73B0;testStr&#x53D8;&#x5316;&#x540E;&#xFF0C;strongStr&#x4F1A;&#x968F;&#x4E4B;&#x6539;&#x53D8;&#x3002;&#x800C;copyStr&#x5219;&#x4E0D;&#x4F1A;&#x968F;&#x4E4B;&#x53D8;&#x5316;&#x3002;</p>
<p>#####&#x603B;&#x7ED3;<br>&#x3000;&#x3000;&#x7531;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x53EF;&#x4EE5;&#x5F97;&#x51FA;&#xFF1A;&#x5F53;&#x539F;&#x5B57;&#x7B26;&#x4E32;&#x662F;NSString&#x65F6;&#xFF0C;&#x7531;&#x4E8E;&#x662F;&#x4E0D;&#x53EF;&#x53D8;&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x6240;&#x4EE5;&#xFF0C;&#x4E0D;&#x7BA1;&#x662F;&#x4F7F;&#x7528;strong&#x8FD8;&#x662F;copy&#x4FEE;&#x9970;&#xFF0C;&#x90FD;&#x662F;&#x6307;&#x5411;&#x539F;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;copy&#x64CD;&#x4F5C;&#x53EA;&#x662F;&#x505A;&#x4E86;&#x6B21;<strong>&#x6D45;&#x62F7;&#x8D1D;</strong>&#x3002;<br>&#x3000;&#x3000;&#x800C;&#x5F53;&#x6E90;&#x5B57;&#x7B26;&#x4E32;&#x662F;NSMutableString&#x65F6;&#xFF0C;strong&#x53EA;&#x662F;&#x5C06;&#x539F;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x52A0;1&#xFF0C;&#x800C;copy<br>&#x5219;&#x662F;&#x5BF9;&#x539F;&#x5B57;&#x7B26;&#x4E32;&#x505A;&#x4E86;&#x6B21;<strong>&#x6DF1;&#x62F7;&#x8D1D;</strong>&#xFF0C;&#x4ECE;&#x800C;&#x751F;&#x6210;&#x4E86;&#x4E00;&#x4E2A;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4E14;copy&#x7684;&#x5BF9;&#x8C61;&#x6307;&#x5411;&#x8FD9;&#x4E2A;&#x65B0;&#x7684;&#x5BF9;&#x8C61;&#x3002;&#x53E6;&#x5916;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x4E2A;copy&#x5C5E;&#x6027;&#x5BF9;&#x8C61;&#x7684;&#x7C7B;&#x578B;&#x59CB;&#x7EC8;&#x662F;NSString&#xFF0C;&#x800C;&#x4E0D;&#x662F;NSMutableString&#xFF0C;&#x5982;&#x679C;&#x60F3;&#x8BA9;&#x62F7;&#x8D1D;&#x8FC7;&#x6765;&#x7684;&#x5BF9;&#x8C61;&#x662F;&#x53EF;&#x53D8;&#x7684;&#xFF0C;&#x5C31;&#x9700;&#x8981;&#x4F7F;mutableCopy&#x3002;<br>&#x3000;&#x3000;&#x6240;&#x4EE5;&#xFF0C;&#x5982;&#x679C;&#x539F;&#x5B57;&#x7B26;&#x4E32;&#x662F;NSMutableString&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F7F;&#x7528;strong&#x53EA;&#x4F1A;&#x589E;&#x52A0;&#x5F15;&#x7528;&#x8BA1;&#x6570;&#x5668;&#x3002;&#x4F46;&#x662F;copy&#x4F1A;&#x6267;&#x884C;&#x4E00;&#x6B21;<strong>&#x6DF1;&#x62F7;&#x8D1D;</strong>&#xFF0C;&#x4F1A;&#x9020;&#x6210;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x5185;&#x5B58;&#x6D6A;&#x8D39;&#x3002;&#x800C;&#x5982;&#x679C;&#x539F;&#x5B57;&#x7B26;&#x4E32;&#x662F;NSString&#x65F6;&#xFF0C;copy&#x548C;strong&#x6548;&#x679C;&#x4E00;&#x6837;&#xFF0C;&#x5C31;&#x4E0D;&#x4F1A;&#x6709;&#x8FD9;&#x4E2A;&#x95EE;&#x9898;&#x3002;<br>&#x3000;&#x3000;&#x4F46;&#x662F;&#xFF0C;&#x4E00;&#x822C;&#x6211;&#x4EEC;&#x58F0;&#x660E;NSString&#x65F6;&#xFF0C;&#x4E5F;&#x4E0D;&#x4F1A;&#x5E0C;&#x671B;&#x5B83;&#x6539;&#x53D8;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x822C;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5EFA;&#x8BAE;&#x7528;copy&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x907F;&#x514D;NSMutableString&#x5E26;&#x6765;&#x7684;&#x5947;&#x8469;&#x9519;&#x8BEF;&#x3002;</p>
<p>#####&#x987A;&#x4FBF;&#x63D0;&#x4E00;&#x4E0B;assign&#x4E0E;weak<br>&#x3000;&#x3000;&#x6211;&#x4EEC;&#x90FD;&#x77E5;&#x9053;&#xFF0C;assign&#x7528;&#x6765;&#x4FEE;&#x9970;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#xFF0C;weak&#x7528;&#x6765;&#x4FEE;&#x9970;OC&#x5BF9;&#x8C61;&#x3002;<br>&#x3000;&#x3000;&#x5176;&#x5B9E;&#x7167;&#x7406;&#x8BF4;assign&#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x6765;&#x4FEE;&#x9970;&#x5BF9;&#x8C61;&#x3002;&#x4F46;&#x662F;assign&#x4FEE;&#x9970;&#x7684;&#x5BF9;&#x8C61;&#x5728;&#x6B64;&#x5BF9;&#x8C61;&#x91CA;&#x653E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6307;&#x9488;&#x5730;&#x5740;&#x4F9D;&#x7136;&#x5B58;&#x5728;&#xFF0C;&#x4E0D;&#x4F1A;&#x88AB;&#x7F6E;&#x4E3A;nil&#xFF0C;&#x8FD9;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x5F88;&#x4E25;&#x91CD;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4F1A;&#x4EA7;&#x751F;&#x91CE;&#x6307;&#x9488;&#x3002;&#x4F46;&#x662F;&#x7528;weak&#x6765;&#x4FEE;&#x9970;&#x7684;&#x8BDD;&#x5728;&#x5BF9;&#x8C61;&#x91CA;&#x653E;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x628A;&#x6307;&#x9488;&#x7F6E;&#x4E3A;nil&#xFF0C;&#x4ECE;&#x800C;&#x907F;&#x514D;&#x91CE;&#x6307;&#x9488;&#x7684;&#x51FA;&#x73B0;&#x3002;<br>&#x3000;&#x3000;&#x90A3;&#x4F60;&#x53C8;&#x4F1A;&#x95EE;&#x4E86;&#xFF0C;&#x90A3;&#x51ED;&#x5565;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;assign&#x3002;&#x8FD9;&#x4E2A;&#x5C31;&#x53C8;&#x8981;&#x626F;&#x5230;&#x5806;&#x548C;&#x6808;&#x7684;&#x95EE;&#x9898;&#x4E86;&#xFF0C;&#x57FA;&#x672C;&#x6570;&#x636E;&#x7C7B;&#x578B;&#x4E00;&#x822C;&#x662F;&#x88AB;&#x5206;&#x914D;&#x5230;&#x6808;&#x7A7A;&#x95F4;&#x3002;&#x800C;&#x6808;&#x662F;&#x7531;&#x7CFB;&#x7EDF;&#x81EA;&#x52A8;&#x7BA1;&#x7406;&#x5206;&#x914D;&#x548C;&#x91CA;&#x653E;&#x3002;&#x5C31;&#x4E0D;&#x4F1A;&#x9020;&#x6210;&#x91CE;&#x6307;&#x9488;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[研究一下陀螺仪和加速度计]]></title>
      <url>http://nanshanyi.github.io/2016/07/18/%E7%A0%94%E7%A9%B6%E4%B8%80%E4%B8%8B%E9%99%80%E8%9E%BA%E4%BB%AA%E5%92%8C%E5%8A%A0%E9%80%9F%E5%BA%A6%E8%AE%A1/</url>
      <content type="html"><![CDATA[<h5 id="&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x6548;&#x679C;"><a href="#&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x6548;&#x679C;" class="headerlink" title="&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x6548;&#x679C;"></a>&#x5148;&#x6765;&#x770B;&#x4E00;&#x4E0B;&#x6548;&#x679C;</h5><p><img src="/2016/07/18/&#x7814;&#x7A76;&#x4E00;&#x4E0B;&#x9640;&#x87BA;&#x4EEA;&#x548C;&#x52A0;&#x901F;&#x5EA6;&#x8BA1;/motion.gif" width="40%" height="40%"><br>&#x8FD9;&#x662F;&#x901A;&#x8FC7;&#x8C03;&#x7528;iOS&#x7684;&#x9640;&#x87BA;&#x4EEA;&#x548C;&#x52A0;&#x901F;&#x5EA6;&#x8BA1;&#x3002;&#x901A;&#x8FC7;&#x503E;&#x659C;&#x624B;&#x673A;&#x5B9E;&#x73B0;&#x7684;&#x6548;&#x679C;</p>
<h5 id="Core-Motion"><a href="#Core-Motion" class="headerlink" title="Core Motion"></a>Core Motion</h5><p> &#x3000;&#x3000;&#x52A0;&#x901F;&#x5EA6;&#x8BA1;&#x548C;&#x9640;&#x87BA;&#x4EEA;&#x662F;&#x901A;&#x8FC7;Core Motion&#x6846;&#x67B6;&#xFF0C;&#x6765;&#x7BA1;&#x7406;&#x8BBF;&#x95EE;&#x7684;&#x3002;&#x6B64;&#x6846;&#x67B6;&#x63D0;&#x4F9B;&#x4E86;CMMotionManager&#x7C7B;&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x7684;&#x6570;&#x636E;&#x90FD;&#x662F;&#x7528;&#x6765;&#x63CF;&#x8FF0;&#x8BBE;&#x5907;&#x7684;&#x79FB;&#x52A8;&#x7684;&#x3002;&#x8FD8;&#x63D0;&#x4F9B;&#x4E86;CMAccelerometerData&#x548C;CMGroData&#xFF0C;&#x4ED6;&#x4EEC;&#x53EF;&#x4EE5;&#x8BBF;&#x95EE;&#x539F;&#x751F;&#x7684;&#x52A0;&#x901F;&#x5EA6;&#x8BA1;&#x548C;&#x9640;&#x87BA;&#x4EEA;&#x4FE1;&#x606F;&#x3002;&#x53E6;&#x5916;&#x8FD8;&#x6709;CMDeviceMotion&#xFF0C;&#x8FD9;&#x4E2A;&#x7C7B;&#x91CC;&#x9762;&#x5305;&#x542B;&#x6709;&#x52A0;&#x901F;&#x5EA6;&#x8BA1;&#x548C;&#x9640;&#x87BA;&#x4EEA;&#x7684;&#x6D4B;&#x91CF;&#x6570;&#x636E;&#xFF0C;&#x4EE5;&#x53CA;&#x65B9;&#x4F4D;&#x4FE1;&#x606F;&#x3002;&#x5373;&#x8BBE;&#x5907;&#x662F;&#x5E73;&#x653E;&#xFF0C;&#x671D;&#x4E0A;&#xFF0C;&#x671D;&#x4E0B;&#xFF0C;&#x8FD8;&#x662F;&#x671D;&#x5DE6;&#x7B49;&#x4FE1;&#x606F;&#x3002;&#x8BDD;&#x4E0D;&#x591A;&#x8BF4;&#x8FD8;&#x662F;&#x76F4;&#x63A5;&#x4E0A;&#x4EE3;&#x7801;&#x3002;<br> &#x3000;&#x3000;&#x5148;&#x6765;&#x4E2A;&#x5750;&#x6807;&#x7CFB;&#x4F5C;&#x4E3A;&#x53C2;&#x8003;<br> <img src="/2016/07/18/&#x7814;&#x7A76;&#x4E00;&#x4E0B;&#x9640;&#x87BA;&#x4EEA;&#x548C;&#x52A0;&#x901F;&#x5EA6;&#x8BA1;/xyz.png" width="40%" height="40%"><br><a id="more"></a></p>
<h5 id="&#x770B;&#x4E00;&#x4E0B;&#x5404;&#x9879;&#x6570;&#x636E;"><a href="#&#x770B;&#x4E00;&#x4E0B;&#x5404;&#x9879;&#x6570;&#x636E;" class="headerlink" title="&#x770B;&#x4E00;&#x4E0B;&#x5404;&#x9879;&#x6570;&#x636E;"></a>&#x770B;&#x4E00;&#x4E0B;&#x5404;&#x9879;&#x6570;&#x636E;</h5><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">#define kUpdateInterval (1.f / 60.f)//&#x5B9A;&#x4E49;&#x4E00;&#x4E2A;&#x66F4;&#x65B0;&#x65F6;&#x95F4;</span><br><span class="line">@property (nonatomic,strong)CMMotionManager *motionManager;</span><br><span class="line">@property (nonatomic,strong)NSOperationQueue *quene;</span><br><span class="line">//&#x58F0;&#x660E;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;</span><br><span class="line"></span><br><span class="line">self.motionManager = [[CMMotionManager alloc]init];</span><br><span class="line">NSOperationQueue *quene = [[NSOperationQueue alloc]init];</span><br><span class="line">&#x521D;&#x59CB;&#x5316;&#x4E00;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x52A8;&#x4F5C;&#x7BA1;&#x7406;&#x5668;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x7EBF;&#x7A0B;&#x6765;&#x8FD0;&#x884C;&#xFF0C;&#x4EE5;&#x4FBF;&#x5728;&#x6BCF;&#x6B21;&#x53D1;&#x751F;&#x4E8B;&#x4EF6;&#x65F6;&#x653E;&#x5165;&#x8981;&#x6267;&#x884C;&#x7684;&#x5DE5;&#x4F5C;&#x3002;&#x82F9;&#x679C;&#x6587;&#x6863;&#x4E4B;&#x5904;&#x4E0D;&#x8981;&#x653E;&#x5728;&#x9ED8;&#x8BA4;&#x961F;&#x5217;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x4E8B;&#x4EF6;&#x586B;&#x6EE1;&#xFF0C;&#x65E0;&#x6CD5;&#x5904;&#x7406;&#x522B;&#x7684;&#x4E8B;&#x4EF6;</span><br><span class="line"></span><br><span class="line">    if (self.motionManager.deviceMotionAvailable) {</span><br><span class="line">        self.motionManager.deviceMotionUpdateInterval = 0.1;</span><br><span class="line">        //&#x8BBE;&#x7F6E;&#x66F4;&#x65B0;&#x6570;&#x636E;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;</span><br><span class="line">        [self.motionManager startDeviceMotionUpdatesToQueue: quene withHandler:^(CMDeviceMotion * _Nullable motion, NSError * _Nullable error) {</span><br><span class="line">            CMRotationRate rotationRate = motion.rotationRate;</span><br><span class="line">           //&#x65CB;&#x8F6C;&#x901F;&#x7387;&#x5BF9;&#x5E94;x&#xFF0C;y&#xFF0C;z&#x5206;&#x522B;&#x662F;&#x8BBE;&#x5907;&#x7ED5;x&#xFF0C;y&#xFF0C;z &#x8F74;&#xFF08;&#x4E0A;&#x9762;&#x6709;&#x56FE;&#x53C2;&#x8003;&#xFF09;</span><br><span class="line">           &#x7684;&#x65CB;&#x8F6C;&#x901F;&#x7387;&#xFF0C;&#x987A;&#x65F6;&#x9488;&#x4E3A;&#x6B63;&#xFF0C;&#x9006;&#x65F6;&#x9488;&#x4E3A;&#x8D1F;</span><br><span class="line">            CMAcceleration gravity = motion.gravity;</span><br><span class="line">            //&#x81EA;&#x7136;&#x52A0;&#x901F;&#x5EA6;&#xFF0C;&#x53EF;&#x662F;&#x8BC6;&#x522B;&#x624B;&#x673A;&#x7684;&#x653E;&#x7F6E;&#x65B9;&#x5411;&#xFF0C;&#x8BBE;&#x5907;&#x5E73;&#x653E;&#x5728;&#x684C;&#x4E0A;&#xFF0C;z=-1;</span><br><span class="line">               &#x5C4F;&#x5E55;&#x671D;&#x5DE6;&#x4FA7;&#x7ACB;&#xFF0C;x = -1&#xFF1B;&#x5145;&#x7535;&#x53E3;&#x671D;&#x4E0B;&#x5782;&#x76F4;&#x653E;&#x7F6E;&#xFF0C;y=-1</span><br><span class="line">            CMAcceleration userAcc = motion.userAcceleration;</span><br><span class="line">            //&#x7528;&#x6237;&#x8FD0;&#x52A8;&#x624B;&#x673A;&#x9020;&#x6210;&#x7684;&#x52A0;&#x901F;&#x5EA6;&#xFF0C;&#x5206;&#x522B;&#x5411;xyz&#x65B9;&#x5411;&#x8FD0;&#x52A8;&#x65F6;&#xFF0C;&#x6B63;&#x5411;&#x65F6;&#x5373;&#x4E3A;&#x6B63;&#x503C;</span><br><span class="line">            CMAttitude *attitude = motion.attitude;</span><br><span class="line">            //&#x8BBE;&#x5907;&#x7684;&#x65CB;&#x8F6C;&#x7A0B;&#x5EA6;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7406;&#x89E3;&#x4E3A;&#x8BBE;&#x5907;&#x7ED5;xyz&#x8F74;&#x65CB;&#x8F6C;&#x7684;&#x7A0B;&#x5EA6;&#xFF0C;&#x5355;&#x4F4D;&#x662F;</span><br><span class="line">            &#x5F27;&#x5EA6;&#xFF0C;&#x5373;&#x65CB;&#x8F6C;&#x4E00;&#x5468;&#x7684;&#x503C;&#x4E3A;2&#x3C0;&#xFF0C;&#x624B;&#x673A;&#x7ED5;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;&#xFF1A;&#x628A;&#x624B;&#x673A;&#x5E73;&#x653E;&#x5728;&#x684C;&#x9762;&#x4E0A;&#xFF0C;</span><br><span class="line">            &#x65CB;&#x8F6C;&#x624B;&#x673A;Yaw(&#x504F;&#x79FB;)&#x5F00;&#x59CB;&#x53D8;&#x5316;&#xFF0C;&#x65CB;&#x8F6C;180&#xB0;&#x65F6;yaw = 3.14;</span><br><span class="line">            &#x7ED5;Y&#x8F74;&#x65CB;&#x8F6C;&#x65F6;Roll&#x53D8;&#x5316;&#xFF1B;&#x7ED5;X&#x8F74;&#x65CB;&#x8F6C;&#x65F6;Pitch&#x53D8;&#x5316;&#xFF08;&#x65B9;&#x5411;&#x4E0D;&#x5728;&#x591A;&#x505A;&#x8BA8;&#x8BBA;&#xFF0C;&#x53C2;&#x8003;&#x7CFB;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x6CA1;&#x6CD5;&#x7EDF;&#x4E00;&#xFF09;</span><br><span class="line">            NSString *gyroscopeText = [NSString   stringWithFormat:@&quot;Rotation:\\n x = %.2f\\n y = %.2f\\n</span><br><span class="line">  z = %.2f&quot;,rotationRate.x,rotationRate.y,rotationRate.z];</span><br><span class="line">            NSString *acceleratiorText = [NSString stringWithFormat:@&quot;Accelertion: \\n Gravity x = %.2f\\tUser x = %.2f</span><br><span class="line">\\n Gravity y = %.2f\\tUser y = %.2f \\n Gravity z = %.2f\\tUser z = %.2f \\n&quot;,gravity.x,userAcc.x,gravity.y,userAcc.y,gravity.z,userAcc.z];</span><br><span class="line"></span><br><span class="line">            NSString *attitudeText = [NSString stringWithFormat:@&quot;Attitute:\\n Roll = %.2f\\nPitch = %.2f</span><br><span class="line">\\nYaw = %.2f\\n&quot;,attitude.roll,attitude.pitch,attitude.yaw];</span><br><span class="line">//            NSLog(@&quot;%@&quot;,gyroscopeText);</span><br><span class="line">            dispatch_async(dispatch_get_main_queue(), ^{</span><br><span class="line">                _gyroscopeLabel.text = gyroscopeText;</span><br><span class="line">                _accelerometerLabel.text = acceleratiorText;</span><br><span class="line">                _attitudeLabel.text = attitudeText;</span><br><span class="line">            });</span><br><span class="line">        }];</span><br><span class="line">    }</span><br></pre></td></tr></table></figure>
<p>#####&#x7136;&#x540E;&#x6211;&#x4EEC;&#x6765;&#x505A;&#x4E00;&#x4E2A;Demo<br>  controller&#x4E2D;&#x4EE3;&#x7801;&#x5B9E;&#x73B0;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#define kUpdateInterval (1.f / 60.f)//&#x66F4;&#x65B0;&#x9891;&#x7387;&#x9AD8;&#x4E00;&#x70B9;</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BallViewController</span> ()</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)CMMotionManager *motionManager;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">NSOperationQueue</span> *quene;</span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad {</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    BallView *ballView = [[BallView alloc]initWithFrame:<span class="keyword">self</span>.view.bounds];</span><br><span class="line"><span class="comment">//&#x81EA;&#x5DF1;&#x5199;&#x7684;&#x7C7B;&#x7EE7;&#x627F;&#x81EA;UIView</span></span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:ballView];</span><br><span class="line">    <span class="keyword">self</span>.motionManager = [[CMMotionManager alloc]init];</span><br><span class="line">    <span class="keyword">self</span>.quene = [[<span class="built_in">NSOperationQueue</span> alloc]init];</span><br><span class="line">    <span class="keyword">self</span>.motionManager.deviceMotionUpdateInterval = kUpdateInterval;</span><br><span class="line">    [<span class="keyword">self</span>.motionManager startDeviceMotionUpdatesToQueue:_quene withHandler:^(CMDeviceMotion * _Nullable motion, <span class="built_in">NSError</span> * _Nullable error) {</span><br><span class="line"><span class="comment">//&#x6B64;&#x5904;&#x4E5F;&#x53EF;&#x4EE5;&#x4F20;&#x5165;motion.userAcceleration&#x3002;&#xFF08;&#x7528;&#x6237;&#x79FB;&#x52A8;&#x624B;&#x673A;&#x4EA7;&#x751F;&#x7684;&#x52A0;&#x901F;&#x5EA6;&#xFF09;&#x8FD9;&#x6837;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x6447;&#x52A8;&#x6765;&#x63A7;&#x5236;&#xFF08;ballView&#x91CC;&#x9762;&#x7684;&#x653E;&#x5927;&#x500D;&#x6570;&#x8BB0;&#x5F97;&#x8981;&#x6539;&#x5927;&#x4E00;&#x70B9;&#xFF09;</span></span><br><span class="line">        [ballView setAcceleration:motion.gravity];</span><br><span class="line">        <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^{</span><br><span class="line">        [ballView update];</span><br><span class="line">       <span class="comment">//&#x4E3B;&#x7EBF;&#x7A0B;&#x66F4;&#x65B0;UI</span></span><br><span class="line">        });</span><br><span class="line">    }];</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>BallView&#x7684;&#x5B9E;&#x73B0;<br>.h&#x6587;&#x4EF6;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">&lt;CoreMotion/CoreMotion.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BallView</span> : <span class="title">UIView</span></span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)CMAcceleration acceleration;</span><br><span class="line">- (<span class="keyword">void</span>)update;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure></p>
<p>.m&#x6587;&#x4EF6;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">BallView</span> ()</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">CGFloat</span> width;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">CGFloat</span> height;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">CGFloat</span> imageWidth;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">CGFloat</span> imageHeight;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">UIImage</span> *image;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">UIImageView</span> *imageView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">CGPoint</span> currentPoint;<span class="comment">//&#x5F53;&#x524D;ImageView&#x4F4D;&#x7F6E;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">CGFloat</span> ballXVelocity;<span class="comment">//X&#x65B9;&#x5411;&#x901F;&#x5EA6;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">assign</span>)<span class="built_in">CGFloat</span> ballYVelocity;<span class="comment">//Y&#x65B9;&#x5411;&#x901F;&#x5EA6;</span></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">BallView</span></span></span><br><span class="line"></span><br><span class="line">- (instancetype)initWithFrame:(<span class="built_in">CGRect</span>)frame{</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> initWithFrame:frame];</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>) {</span><br><span class="line">        [<span class="keyword">self</span> commoninit];</span><br><span class="line">        <span class="keyword">self</span>.backgroundColor = [<span class="built_in">UIColor</span> whiteColor];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)commoninit{</span><br><span class="line">    <span class="keyword">self</span>.image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@&quot;btn_nav04@3x&quot;</span>];</span><br><span class="line">    <span class="keyword">self</span>.imageView = [[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">self</span>.imageWidth, <span class="keyword">self</span>.imageHeight)];</span><br><span class="line">    <span class="keyword">self</span>.imageView.image = _image;</span><br><span class="line">    [<span class="keyword">self</span> addSubview:<span class="keyword">self</span>.imageView];</span><br><span class="line">    <span class="keyword">self</span>.currentPoint = <span class="built_in">CGPointMake</span>(<span class="keyword">self</span>.bounds.size.width/<span class="number">2.</span>f+<span class="keyword">self</span>.image.size.width/<span class="number">2.</span>f, <span class="keyword">self</span>.bounds.size.height/<span class="number">2.</span>f+<span class="keyword">self</span>.image.size.height/<span class="number">2.</span>f);</span><br><span class="line">    <span class="keyword">self</span>.imageView.center = _currentPoint;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setCurrentPoint:(<span class="built_in">CGPoint</span>)newPoint{</span><br><span class="line">    _currentPoint = newPoint;</span><br><span class="line">        <span class="comment">//&#x8FB9;&#x7F18;&#x5224;&#x65AD;</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.currentPoint.x &lt;= <span class="keyword">self</span>.imageWidth/<span class="number">2.</span>f) {</span><br><span class="line">        _currentPoint.x = <span class="keyword">self</span>.imageWidth/<span class="number">2.</span>f;</span><br><span class="line">        <span class="keyword">self</span>.ballXVelocity = -_ballXVelocity/<span class="number">2.</span>f;</span><br><span class="line">        <span class="comment">//&#x53CD;&#x5F39;&#x6548;&#x679C;&#xFF0C;&#x63A5;&#x89E6;&#x8FB9;&#x7F18;&#x540E;&#x52A0;&#x901F;&#x5EA6;&#x53CD;&#x5411;&#x51CF;&#x534A;</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.currentPoint.y &lt;= <span class="keyword">self</span>.imageHeight/<span class="number">2.</span>f) {</span><br><span class="line">        _currentPoint.y = <span class="keyword">self</span>.imageHeight/<span class="number">2.</span>f;</span><br><span class="line">        <span class="keyword">self</span>.ballYVelocity = -_ballYVelocity/<span class="number">2.</span>f;</span><br><span class="line">        <span class="comment">//&#x53CD;&#x5F39;&#x6548;&#x679C;&#xFF0C;&#x63A5;&#x89E6;&#x8FB9;&#x7F18;&#x540E;&#x52A0;&#x901F;&#x5EA6;&#x53CD;&#x5411;&#x51CF;&#x534A;</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.currentPoint.x &gt;= <span class="keyword">self</span>.width -<span class="keyword">self</span>.imageWidth/<span class="number">2.</span>f ) {</span><br><span class="line">        _currentPoint.x = <span class="keyword">self</span>.width -<span class="keyword">self</span>.imageWidth/<span class="number">2.</span>f;</span><br><span class="line">        <span class="keyword">self</span>.ballXVelocity = -_ballXVelocity/<span class="number">2.</span>f;</span><br><span class="line">        <span class="comment">//&#x53CD;&#x5F39;&#x6548;&#x679C;&#xFF0C;&#x63A5;&#x89E6;&#x8FB9;&#x7F18;&#x540E;&#x52A0;&#x901F;&#x5EA6;&#x53CD;&#x5411;&#x51CF;&#x534A;</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.currentPoint.y &gt;= <span class="keyword">self</span>.height -<span class="keyword">self</span>.imageHeight/<span class="number">2.</span>f ) {</span><br><span class="line">        _currentPoint.y = <span class="keyword">self</span>.height -<span class="keyword">self</span>.imageHeight/<span class="number">2.</span>f;</span><br><span class="line">        <span class="keyword">self</span>.ballYVelocity = -_ballYVelocity/<span class="number">2.</span>f;</span><br><span class="line">       <span class="comment">//&#x53CD;&#x5F39;&#x6548;&#x679C;&#xFF0C;&#x63A5;&#x89E6;&#x8FB9;&#x7F18;&#x540E;&#x52A0;&#x901F;&#x5EA6;&#x53CD;&#x5411;&#x51CF;&#x534A;</span></span><br><span class="line">    }</span><br><span class="line">    [<span class="keyword">self</span> updateCenter];</span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)updateCenter{</span><br><span class="line">    <span class="keyword">self</span>.imageView.center = _currentPoint;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)update{</span><br><span class="line">    <span class="keyword">static</span> <span class="built_in">NSDate</span> *lastUpdateTime = <span class="literal">nil</span>;</span><br><span class="line">    <span class="keyword">if</span> (lastUpdateTime != <span class="literal">nil</span>) {</span><br><span class="line">        <span class="built_in">NSTimeInterval</span> secondsSinceLastDraw = [[<span class="built_in">NSDate</span> date] timeIntervalSinceDate:lastUpdateTime];<span class="comment">//&#x4E24;&#x6B21;&#x66F4;&#x65B0;&#x7684;&#x65F6;&#x95F4;&#x5DEE;</span></span><br><span class="line">        <span class="keyword">self</span>.ballXVelocity = <span class="keyword">self</span>.ballXVelocity + (<span class="keyword">self</span>.acceleration.x * secondsSinceLastDraw);</span><br><span class="line">        <span class="comment">//X&#x65B9;&#x5411;&#x4E0A;&#x539F;&#x901F;&#x5EA6;&#x52A0;&#x4E0A;&#x52A0;&#x901F;&#x5EA6;&#x4E58;&#x4EE5;&#x65F6;&#x95F4;&#xFF0C;&#x8BA1;&#x7B97;&#x5F53;&#x524D;&#x901F;&#x5EA6;</span></span><br><span class="line">        <span class="keyword">self</span>.ballYVelocity = <span class="keyword">self</span>.ballYVelocity - (<span class="keyword">self</span>.acceleration.y * secondsSinceLastDraw);</span><br><span class="line">        <span class="comment">//Y&#x65B9;&#x5411;&#x4E0A;&#x539F;&#x901F;&#x5EA6;&#x52A0;&#x4E0A;&#x52A0;&#x901F;&#x5EA6;&#x4E58;&#x4EE5;&#x65F6;&#x95F4;&#xFF0C;&#x8BA1;&#x7B97;&#x5F53;&#x524D;&#x901F;&#x5EA6;</span></span><br><span class="line">        <span class="built_in">CGFloat</span> xAccel = secondsSinceLastDraw * <span class="keyword">self</span>.ballXVelocity * <span class="number">1000</span>;</span><br><span class="line">        <span class="comment">//&#x8BA1;&#x7B97;&#x4F4D;&#x7F6E;&#x53D8;&#x5316;&#x91CF;&#x3002;&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x503C;&#x5F88;&#x5C0F;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x8981;&#x653E;&#x5927;&#x4E00;&#x4E9B;&#x624D;&#x66F4;&#x52A0;&#x771F;&#x5B9E;&#x6B64;&#x5904;</span></span><br><span class="line">        <span class="comment">//&#x82E5;&#x60F3;&#x4F7F;&#x7528;&#x6447;&#x52A8;&#xFF0C;&#x8981;&#x628A;&#x653E;&#x5927;&#x500D;&#x6570;&#x8C03;&#x5927;&#xFF0C;10000&#x6548;&#x679C;&#x4E0D;&#x9519;</span></span><br><span class="line">        <span class="built_in">CGFloat</span> yAccel = secondsSinceLastDraw * <span class="keyword">self</span>.ballYVelocity * <span class="number">1000</span>;</span><br><span class="line">        <span class="keyword">self</span>.currentPoint = <span class="built_in">CGPointMake</span>(<span class="keyword">self</span>.currentPoint.x + xAccel, <span class="keyword">self</span>.currentPoint.y + yAccel);</span><br><span class="line">    }</span><br><span class="line">    lastUpdateTime = [<span class="built_in">NSDate</span> date];</span><br><span class="line">}</span><br><span class="line"><span class="meta">#pragma mark - widthAndHeight</span></span><br><span class="line">- (<span class="built_in">CGFloat</span>)width{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.bounds.size.width;</span><br><span class="line">}</span><br><span class="line">- (<span class="built_in">CGFloat</span>)height{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.bounds.size.height;</span><br><span class="line">}</span><br><span class="line">- (<span class="built_in">CGFloat</span>)imageWidth{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.image.size.width;</span><br><span class="line">}</span><br><span class="line">- (<span class="built_in">CGFloat</span>)imageHeight{</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.image.size.height;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x8FD9;&#x6837;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#xFF0C;&#x503E;&#x659C;&#x624B;&#x673A;&#x6765;&#x79FB;&#x52A8;&#x56FE;&#x7247;&#xFF0C;&#x5C31;&#x50CF;&#x771F;&#x662F;&#x7684;&#x91CD;&#x529B;&#x4EA7;&#x751F;&#x7684;&#x6548;&#x679C;&#x4E00;&#x6837;&#x3002;&#x540C;&#x6837;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#xFF0C;&#x6447;&#x52A8;&#x7684;&#x6548;&#x679C;&#x3002;&#xFF08;&#x5C31;&#x50CF;&#x5B89;&#x5353;&#x7684;360&#x539F;&#x6765;&#x7684;&#x7248;&#x672C;&#x6709;&#x4E2A;&#x6447;&#x52A8;&#x7684;&#x7403;&#x6E05;&#x7406;&#x5185;&#x5B58;&#x90A3;&#x6837;&#x7684;&#x6548;&#x679C;&#xFF09;&#x3002;<br>&#x3000;&#x3000;&#x5982;&#x9700;&#x8F6C;&#x8F7D;&#x8BF7;&#x6CE8;&#x660E;&#x51FA;&#x5904;&#xFF0C;&#x8BF7;&#x5C0A;&#x91CD;&#x4F5C;&#x8005;&#x7684;&#x52B3;&#x52A8;&#x6210;&#x679C;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOS开发10个使用小技巧]]></title>
      <url>http://nanshanyi.github.io/2016/06/27/xiaojiqiao/</url>
      <content type="html"><![CDATA[<p>&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x6211;&#x4EEC;&#x603B;&#x4F1A;&#x9047;&#x5230;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;&#x5C0F;&#x95EE;&#x9898;&#xFF0C;&#x6709;&#x4E9B;&#x5C0F;&#x95EE;&#x9898;&#x5E76;&#x4E0D;&#x662F;&#x5341;&#x5206;&#x5BB9;&#x6613;&#x89E3;&#x51B3;&#x3002;&#x5728;&#x6B64;&#x6211;&#x5C31;&#x603B;&#x7ED3;&#x4E00;&#x4E0B;&#xFF0C;&#x6211;&#x5728;&#x5F00;&#x53D1;&#x4E2D;&#x9047;&#x5230;&#x7684;&#x5404;&#x79CD;&#x5C0F;&#x95EE;&#x9898;&#xFF0C;&#x4EE5;&#x53CA;&#x6211;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x3002;&#x6BD4;&#x8F83;&#x666E;&#x904D;&#x7684;&#x6211;&#x5C31;&#x4E0D;&#x518D;&#x63D0;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x4E3B;&#x8981;&#x8BB2;&#x4E00;&#x4E9B;&#x4F60;&#x53EF;&#x80FD;&#x4E0D;&#x77E5;&#x9053;&#x7684;&#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x4E5F;&#x6709;&#x53EF;&#x80FD;&#x4F60;&#x90FD;&#x77E5;&#x9053;&#xFF0C;&#x5927;&#x795E;&#x5C31;&#x4E0D;&#x5FC5;&#x5F80;&#x4E0B;&#x770B;&#x4E86;&#xFF09;</p>
<h4 id="&#x63A7;&#x4EF6;&#x7684;&#x5C40;&#x90E8;&#x5706;&#x89D2;&#x95EE;&#x9898;"><a href="#&#x63A7;&#x4EF6;&#x7684;&#x5C40;&#x90E8;&#x5706;&#x89D2;&#x95EE;&#x9898;" class="headerlink" title="&#x63A7;&#x4EF6;&#x7684;&#x5C40;&#x90E8;&#x5706;&#x89D2;&#x95EE;&#x9898;"></a>&#x63A7;&#x4EF6;&#x7684;&#x5C40;&#x90E8;&#x5706;&#x89D2;&#x95EE;&#x9898;</h4><p>&#x3000;&#x3000;&#x4F60;&#x662F;&#x4E0D;&#x662F;&#x4E5F;&#x9047;&#x5230;&#x8FC7;&#x8FD9;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x4E00;&#x4E2A;button&#x6216;&#x8005;label&#xFF0C;&#x53EA;&#x8981;&#x53F3;&#x8FB9;&#x7684;&#x4E24;&#x4E2A;&#x89D2;&#x5706;&#x89D2;&#xFF0C;&#x6216;&#x8005;&#x53EA;&#x8981;&#x4E00;&#x4E2A;&#x5706;&#x89D2;&#x3002;&#x8BE5;&#x600E;&#x4E48;&#x529E;&#x5462;&#x3002;&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x56FE;&#x5C42;&#x8499;&#x7248;&#x6765;&#x5E2E;&#x52A9;&#x6211;&#x4EEC;&#x4E86;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CGRect</span> rect = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">50</span>);</span><br><span class="line"><span class="built_in">CGSize</span> radio = <span class="built_in">CGSizeMake</span>(<span class="number">5</span>, <span class="number">5</span>);<span class="comment">//&#x5706;&#x89D2;&#x5C3A;&#x5BF8;</span></span><br><span class="line"><span class="built_in">UIRectCorner</span> corner = <span class="built_in">UIRectCornerTopLeft</span>|<span class="built_in">UIRectCornerTopRight</span>;<span class="comment">//&#x8FD9;&#x53EA;&#x5706;&#x89D2;&#x4F4D;&#x7F6E;</span></span><br><span class="line"><span class="built_in">UIBezierPath</span> *path = [<span class="built_in">UIBezierPath</span> bezierPathWithRoundedRect:rect byRoundingCorners:corner cornerRadii:radio];</span><br><span class="line"><span class="built_in">CAShapeLayer</span> *masklayer = [[<span class="built_in">CAShapeLayer</span> alloc]init];<span class="comment">//&#x521B;&#x5EFA;shapelayer</span></span><br><span class="line">masklayer.frame = button.bounds;</span><br><span class="line">masklayer.path = path.CGPath;<span class="comment">//&#x8BBE;&#x7F6E;&#x8DEF;&#x5F84;</span></span><br><span class="line">button.layer.mask = masklayer;</span><br></pre></td></tr></table></figure></p>
<p>&#x4E3E;&#x4F8B;&#x4E3A;button&#xFF0C;&#x5176;&#x5B83;&#x7EE7;&#x627F;&#x81EA;UIView&#x7684;&#x63A7;&#x4EF6;&#x90FD;&#x53EF;&#x4EE5;<br><a id="more"></a></p>
<h4 id="navigationBar&#x7684;&#x900F;&#x660E;&#x95EE;&#x9898;"><a href="#navigationBar&#x7684;&#x900F;&#x660E;&#x95EE;&#x9898;" class="headerlink" title="navigationBar&#x7684;&#x900F;&#x660E;&#x95EE;&#x9898;"></a>navigationBar&#x7684;&#x900F;&#x660E;&#x95EE;&#x9898;</h4><p>&#x3000;&#x3000;&#x5982;&#x679C;&#x4EC5;&#x4EC5;&#x628A;navigationBar&#x7684;alpha&#x8BBE;&#x4E3A;0&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x5C31;&#x76F8;&#x5F53;&#x4E8E;&#x628A;navigationBar&#x7ED9;&#x9690;&#x85CF;&#x4E86;&#xFF0C;&#x5927;&#x5BB6;&#x90FD;&#x77E5;&#x9053;&#xFF0C;&#x7236;&#x89C6;&#x56FE;&#x7684;alpha&#x8BBE;&#x7F6E;&#x4E3A;0&#x7684;&#x8BDD;&#xFF0C;&#x90A3;&#x4E48;&#x5B50;&#x89C6;&#x56FE;&#x5168;&#x90FD;&#x4F1A;&#x900F;&#x660E;&#x7684;&#x3002;&#x90A3;&#x4E48;&#x76F8;&#x5E94;&#x7684;navigationBar&#x7684;&#x6807;&#x9898;&#x548C;&#x5DE6;&#x53F3;&#x4E24;&#x4E2A;&#x6309;&#x94AE;&#x90FD;&#x4F1A;&#x6D88;&#x5931;&#x3002;&#x8FD9;&#x6837;&#x663E;&#x7136;&#x8FBE;&#x4E0D;&#x5230;&#x6211;&#x4EEC;&#x8981;&#x6C42;&#x7684;&#x6548;&#x679C;&#x3002;<br>&#x3000;&#x3000;&#xFF08;1&#xFF09;&#x5982;&#x679C;&#x4EC5;&#x4EC5;&#x662F;&#x60F3;&#x8981;navigationBar&#x900F;&#x660E;&#xFF0C;&#x6309;&#x94AE;&#x548C;&#x6807;&#x9898;&#x90FD;&#x5728;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;&#x65B9;&#x6CD5;&#xFF1A;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">    [<span class="keyword">self</span>.navigationController.navigationBar setBackgroundImage:[<span class="built_in">UIImage</span> new]</span><br><span class="line">forBarMetrics:<span class="built_in">UIBarMetricsDefault</span>];<span class="comment">//&#x7ED9;navigationBar&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;&#x7A7A;&#x7684;&#x80CC;&#x666F;&#x56FE;&#x7247;&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x900F;&#x660E;&#xFF0C;&#x800C;&#x4E14;&#x6807;&#x9898;&#x6309;&#x94AE;&#x90FD;&#x5728;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x7EC6;&#x5FC3;&#x7684;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x4E0A;&#x9762;&#x6709;&#x4E00;&#x6761;&#x7EBF;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/966908-3b7d38b83a9e353c.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="IMG_0025.PNG"><br>&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x505A;&#x8FDB;&#x4E00;&#x6B65;&#x5904;&#x7406;&#xFF0C;&#x628A;&#x7EBF;&#x53BB;&#x6389;&#xFF0C;&#x5982;&#x4E0B;&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#xFF1A;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.navigationController.navigationBar.shadowImage = [<span class="built_in">UIImage</span> new];</span><br><span class="line"><span class="comment">//&#x5176;&#x5B9E;&#x8FD9;&#x4E2A;&#x7EBF;&#x4E5F;&#x662F;image&#x63A7;&#x5236;&#x7684;&#x3002;&#x8BBE;&#x4E3A;&#x7A7A;&#x5373;&#x53EF;</span></span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#xFF08;2&#xFF09;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x5728;&#x900F;&#x660E;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#x5B9E;&#x73B0;&#x6839;&#x636E;&#x4E0B;&#x62C9;&#x8DDD;&#x79BB;&#xFF0C;&#x7531;&#x900F;&#x660E;&#x53D8;&#x5F97;&#x4E0D;&#x900F;&#x660E;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x90A3;&#x4E48;&#x4E0A;&#x9762;&#x90A3;&#x4E2A;&#x5C31;&#x663E;&#x5F97;&#x529B;&#x4E0D;&#x4ECE;&#x5FC3;&#x4E86;&#xFF0C;&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x91C7;&#x7528;&#x53E6;&#x5916;&#x4E00;&#x79CD;&#x65B9;&#x6CD5;&#x4E86;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//navigationBar&#x662F;&#x4E00;&#x4E2A;&#x590D;&#x5408;&#x89C6;&#x56FE;&#xFF0C;&#x5B83;&#x662F;&#x6709;&#x8BB8;&#x591A;&#x4E2A;&#x63A7;&#x4EF6;&#x7EC4;&#x6210;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x6211;&#x4EEC;&#x5C31;&#x53EF;&#x4EE5;&#x4ECE;&#x4ED6;&#x7684;&#x5185;&#x90E8;&#x5165;&#x624B;</span></span><br><span class="line">[[<span class="keyword">self</span>.navigationController.navigationBar subviews] objectAtIndex:<span class="number">0</span>].alpha = <span class="number">0</span>;<span class="comment">//&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x6839;&#x636E;scrollView&#x7684;&#x504F;&#x79FB;&#x91CF;&#x6765;&#x8BBE;&#x7F6E;alpha&#x5C31;&#x5B9E;&#x73B0;&#x4E86;&#x6E10;&#x53D8;&#x900F;&#x660E;&#x7684;&#x6548;&#x679C;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5168;&#x5C40;&#x8BBE;&#x7F6E;navigationBar&#x6807;&#x9898;&#x7684;&#x6837;&#x5F0F;&#x548C;barItem&#x7684;&#x6807;&#x9898;&#x6837;&#x5F0F;"><a href="#&#x5168;&#x5C40;&#x8BBE;&#x7F6E;navigationBar&#x6807;&#x9898;&#x7684;&#x6837;&#x5F0F;&#x548C;barItem&#x7684;&#x6807;&#x9898;&#x6837;&#x5F0F;" class="headerlink" title="&#x5168;&#x5C40;&#x8BBE;&#x7F6E;navigationBar&#x6807;&#x9898;&#x7684;&#x6837;&#x5F0F;&#x548C;barItem&#x7684;&#x6807;&#x9898;&#x6837;&#x5F0F;"></a>&#x5168;&#x5C40;&#x8BBE;&#x7F6E;navigationBar&#x6807;&#x9898;&#x7684;&#x6837;&#x5F0F;&#x548C;barItem&#x7684;&#x6807;&#x9898;&#x6837;&#x5F0F;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//UIColorWithHexRGB( )&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x7684;&#xFF0C;&#x8FD9;&#x91CC;&#x53EA;&#x9700;&#x8981;&#x7ED9;&#x4E2A;&#x989C;&#x8272;&#x5C31;&#x597D;&#x4E86;</span></span><br><span class="line"> [[<span class="built_in">UINavigationBar</span> appearance] setBarTintColor:<span class="built_in">UIColorWithHexRGB</span>(<span class="number">0xfefefe</span>)];</span><br><span class="line"></span><br><span class="line">    [[<span class="built_in">UINavigationBar</span> appearance] setTitleTextAttributes:@{<span class="built_in">NSFontAttributeName</span>:[<span class="built_in">UIFont</span> boldSystemFontOfSize:<span class="number">18</span>],<span class="built_in">NSForegroundColorAttributeName</span>:<span class="built_in">UIColorWithHexRGB</span>(<span class="number">0xfe6d27</span>)}];</span><br><span class="line"></span><br><span class="line">    [[<span class="built_in">UITabBarItem</span> appearance] setTitleTextAttributes:@{<span class="built_in">NSFontAttributeName</span> : [<span class="built_in">UIFont</span> boldSystemFontOfSize:<span class="number">10</span>],<span class="built_in">NSForegroundColorAttributeName</span> : <span class="built_in">UIColorWithHexRGB</span>(<span class="number">0x666666</span>)} forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line"></span><br><span class="line">    [[<span class="built_in">UITabBarItem</span> appearance] setTitleTextAttributes:@{<span class="built_in">NSFontAttributeName</span> : [<span class="built_in">UIFont</span> boldSystemFontOfSiz</span><br></pre></td></tr></table></figure>
<h4 id="navigationBar&#x9690;&#x85CF;&#x663E;&#x793A;&#x7684;&#x8FC7;&#x5EA6;"><a href="#navigationBar&#x9690;&#x85CF;&#x663E;&#x793A;&#x7684;&#x8FC7;&#x5EA6;" class="headerlink" title="navigationBar&#x9690;&#x85CF;&#x663E;&#x793A;&#x7684;&#x8FC7;&#x5EA6;"></a>navigationBar&#x9690;&#x85CF;&#x663E;&#x793A;&#x7684;&#x8FC7;&#x5EA6;</h4><p>  &#x3000;&#x3000;&#x76F8;&#x4FE1;&#x5728;&#x4F7F;&#x7528;&#x4E2D;&#x80AF;&#x5B9A;&#x9047;&#x5230;&#x8FC7;&#xFF0C;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x9690;&#x85CF;navigationBar&#xFF0C;&#x53E6;&#x4E00;&#x4E2A;&#x4E0D;&#x9690;&#x85CF;&#x3002;&#x4E24;&#x4E2A;&#x9875;&#x9762;&#x8FDB;&#x884C;push&#x548C;pop&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x6709;&#x4FA7;&#x6ED1;&#x624B;&#x52BF;&#x8FD4;&#x56DE;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E0D;&#x505A;&#x5904;&#x7406;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x6ED1;&#x52A8;&#x8FD4;&#x56DE;&#x65F6;&#xFF0C;navigationBar&#x4F4D;&#x7F6E;&#x662F;&#x7A7A;&#x7684;&#xFF0C;&#x76F4;&#x63A5;&#x663E;&#x793A;&#x4E00;&#x4E2A;&#x9ED1;&#x8272;&#x6216;&#x8005;&#x663E;&#x793A;&#x4E0B;&#x9762;&#x4E00;&#x5C42;&#x89C6;&#x56FE;&#xFF0C;&#x5F88;&#x96BE;&#x770B;&#x3002;&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x52A0;&#x5165;&#x8FC7;&#x5EA6;&#x52A8;&#x753B;&#x6765;&#x9690;&#x85CF;&#x6216;&#x663E;&#x793A;navigationBar&#xFF1A;<br>&#x5728;&#x8FD4;&#x56DE;&#x540E;&#x5C06;&#x8981;&#x51FA;&#x73B0;&#x7684;&#x9875;&#x9762;&#x5B9E;&#x73B0;viewWillAppear&#x65B9;&#x6CD5;&#xFF0C;&#x9700;&#x8981;&#x9690;&#x85CF;&#x5C31;&#x8BBE;&#x4E3A;YES&#xFF0C;&#x9700;&#x8981;&#x663E;&#x793A;&#x5C31;&#x8BBE;&#x4E3A;NO<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)viewWillAppear:(<span class="built_in">BOOL</span>)animated{</span><br><span class="line">    [<span class="keyword">super</span> viewWillAppear:animated];</span><br><span class="line">    [<span class="keyword">self</span>.navigationController setNavigationBarHidden:<span class="literal">NO</span> animated:<span class="literal">YES</span>];</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x4FA7;&#x6ED1;&#x624B;&#x52BF;&#x8FD4;&#x56DE;"><a href="#&#x4FA7;&#x6ED1;&#x624B;&#x52BF;&#x8FD4;&#x56DE;" class="headerlink" title="&#x4FA7;&#x6ED1;&#x624B;&#x52BF;&#x8FD4;&#x56DE;"></a>&#x4FA7;&#x6ED1;&#x624B;&#x52BF;&#x8FD4;&#x56DE;</h4><p>  &#x3000;&#x3000;iOS&#x7684;&#x4FA7;&#x6ED1;&#x8FD4;&#x56DE;&#x624B;&#x52BF;&#x6709;&#x7740;&#x5F88;&#x597D;&#x7684;&#x64CD;&#x4F5C;&#x4F53;&#x9A8C;&#xFF0C;&#x4E0D;&#x652F;&#x6301;&#x4FA7;&#x6ED1;&#x8FD4;&#x56DE;&#x7684;&#x5E94;&#x7528;&#x7EDD;&#x5BF9;&#x4E0D;&#x662F;&#x597D;&#x5E94;&#x7528;&#x3002;&#x4F46;&#x662F;&#x5728;&#x5F00;&#x53D1;&#x8FC7;&#x7A0B;&#x4E2D;&#x5728;&#x81EA;&#x5B9A;&#x4E49;&#x4E86;&#x8FD4;&#x56DE;&#x6309;&#x94AE;&#xFF0C;&#x6216;&#x8005;&#x67D0;&#x4E9B;webView,tableView&#x7B49;&#x9875;&#x9762;&#xFF0C;&#x4FA7;&#x6ED1;&#x8FD4;&#x56DE;&#x624B;&#x52BF;&#x5931;&#x6548;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x5C31;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x6765;&#x8FDB;&#x884C;&#x8BBE;&#x7F6E;&#x4E00;&#x4E0B;&#x4E86;,&#x53EF;&#x4EE5;&#x5728;&#x57FA;&#x7C7B;&#x91CC;&#x9762;&#x534F;&#x5546;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.navigationController respondsToSelector:<span class="keyword">@selector</span>(interactivePopGestureRecognizer)]) {</span><br><span class="line"><span class="comment">//&#x9700;&#x8981;&#x9075;&#x5FAA;&#x4E00;&#x4E0B;&#x624B;&#x52BF;&#x7684;&#x4EE3;&#x7406;</span></span><br><span class="line">       <span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.delegate = <span class="keyword">self</span>;</span><br><span class="line">        <span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.enabled = <span class="literal">YES</span>;</span><br><span class="line">    }</span><br></pre></td></tr></table></figure></p>
<p>  &#x3000;&#x3000;&#x95EE;&#x9898;&#xFF1A;&#x5F53;&#x8FD4;&#x56DE;navigationController&#x7684;&#x6700;&#x9876;&#x5C42;&#x7684;Controller&#x7684;&#x65F6;&#x5019;&#x3002;&#x518D;&#x6B21;&#x4FA7;&#x6ED1;&#xFF0C;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x4F60;&#x5728;&#x70B9;&#x51FB;&#x4E00;&#x4E2A;push&#x9875;&#x9762;&#x7684;&#x64CD;&#x4F5C;&#xFF0C;&#x4F60;&#x4F1A;&#x53D1;&#x73B0;&#x5361;&#x90A3;&#x4E86;&#xFF0C;&#x534A;&#x5929;&#x624D;&#x4F1A;&#x6709;&#x53CD;&#x5E94;&#x3002;<br>  &#x3000;&#x3000;&#x8FD9;&#x662F;&#x7531;&#x4E8E;&#xFF0C;&#x5728;&#x6700;&#x9876;&#x5C42;Controller&#x624B;&#x52BF;&#x4F9D;&#x7136;&#x6709;&#x6548;&#xFF0C;&#x4F46;&#x662F;&#x6ED1;&#x52A8;&#x540E;&#xFF0C;&#x5E76;&#x627E;&#x4E0D;&#x5230;&#x8FD4;&#x56DE;&#x7684;&#x9875;&#x9762;&#x3002;&#x9020;&#x6210;&#x8F6F;&#x4EF6;&#x5361;&#x987F;&#xFF0C;&#x5047;&#x6B7B;&#x6240;&#x4EE5;&#x5C31;&#x8981;&#x5728;rootViewController&#x4E2D;&#x8BA9;&#x6B64;&#x624B;&#x52BF;&#x5931;&#x6548;&#x3002;&#x628A;&#x4E0B;&#x9762;&#x7684;&#x8BBE;&#x4E3A;NO<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//&#x8BB0;&#x5F97;&#x5199;&#x5728;didAppear&#x91CC;&#x9762;</span></span><br><span class="line">- (<span class="keyword">void</span>)viewDidAppear:(<span class="built_in">BOOL</span>)animated{</span><br><span class="line">    <span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.enabled = <span class="literal">NO</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>  &#x3000;&#x3000;&#x5F53;&#x7136;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E00;&#x4E2A;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#xFF0C;&#x5199;&#x7684;&#x76F8;&#x5F53;&#x68D2;&#x3002;&#x4ED6;&#x5BF9;&#x7CFB;&#x7EDF;&#x7684;&#x4FA7;&#x6ED1;&#x8FD4;&#x56DE;&#x624B;&#x52BF;&#x8FDB;&#x884C;&#x62D3;&#x5C55;&#xFF0C;&#x4E0D;&#x7528;&#x4ECE;&#x8FB9;&#x7F18;&#x6ED1;&#x52A8;&#xFF0C;&#x53EA;&#x8981;&#x53F3;&#x6ED1;&#x5373;&#x53EF;&#x8FD4;&#x56DE;&#x3002;&#x6700;&#x91CD;&#x8981;&#x7684;&#x662F;&#xFF0C;&#x4ED6;&#x53EA;&#x9700;&#x8981;&#x52A0;&#x5165;&#x9879;&#x76EE;&#x4E2D;&#x5373;&#x53EF;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x4E00;&#x884C;&#x4EE3;&#x7801;&#x5373;&#x53EF;&#x5B9E;&#x73B0;&#x3002;&#x9644;&#x4E0A;<a href="https://github.com/forkingdog/FDFullscreenPopGesture" target="blank">github &#x7F51;&#x5740;</a></p>
<h4 id="&#x7ED9;webView&#x6DFB;&#x52A0;&#x5934;&#x89C6;&#x56FE;"><a href="#&#x7ED9;webView&#x6DFB;&#x52A0;&#x5934;&#x89C6;&#x56FE;" class="headerlink" title="&#x7ED9;webView&#x6DFB;&#x52A0;&#x5934;&#x89C6;&#x56FE;"></a>&#x7ED9;webView&#x6DFB;&#x52A0;&#x5934;&#x89C6;&#x56FE;</h4><p>webView&#x662F;&#x4E00;&#x4E2A;&#x590D;&#x5408;&#x89C6;&#x56FE;&#xFF0C;&#x91CC;&#x9762;&#x5305;&#x542B;&#x6709;&#x4E00;&#x4E2A;scrollView&#xFF0C;scrollView&#x91CC;&#x9762;&#x662F;&#x4E00;&#x4E2A;UIWebBrowserView&#xFF08;&#x8D1F;&#x8D23;&#x663E;&#x793A;WebView&#x7684;&#x5185;&#x5BB9;&#xFF09;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIView</span> *webBrowserView = <span class="keyword">self</span>.webView.scrollView.subviews[<span class="number">0</span>];<span class="comment">//&#x62FF;&#x5230;webView&#x7684;webBrowserView</span></span><br><span class="line">    <span class="keyword">self</span>.backHeadImageView = [[<span class="built_in">UIImageView</span> alloc]initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, kScreenWidth, kScreenWidth*<span class="number">2</span>/<span class="number">3.0</span>)];</span><br><span class="line">    [_backHeadImageView sd_setImageWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="keyword">self</span>.imageUrl] placeholderImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@&quot;placeholderImage&quot;</span>]];</span><br><span class="line">    [<span class="keyword">self</span>.webView insertSubview:_backHeadImageView belowSubview:<span class="keyword">self</span>.webView.scrollView];</span><br><span class="line">    <span class="comment">//&#x628A;backHeadImageView&#x63D2;&#x5165;&#x5230;webView&#x7684;scrollView&#x4E0B;&#x9762;</span></span><br><span class="line">    <span class="built_in">CGRect</span> frame = <span class="keyword">self</span>.webBrowserView.frame;</span><br><span class="line">    frame.origin.y = <span class="built_in">CGRectGetMaxY</span>(_backHeadImageView.frame);</span><br><span class="line">    <span class="keyword">self</span>.webBrowserView.frame = frame;</span><br><span class="line">    <span class="comment">//&#x66F4;&#x6539;webBrowserView&#x7684;frame&#x5411;&#x4E0B;&#x79FB;backHeadImageView&#x7684;&#x9AD8;&#x5EA6;&#xFF0C;&#x4F7F;&#x5176;&#x53EF;&#x89C1;</span></span><br></pre></td></tr></table></figure></p>
<h4 id="&#x6A21;&#x6001;&#x8DF3;&#x8F6C;&#x7684;&#x52A8;&#x753B;&#x8BBE;&#x7F6E;"><a href="#&#x6A21;&#x6001;&#x8DF3;&#x8F6C;&#x7684;&#x52A8;&#x753B;&#x8BBE;&#x7F6E;" class="headerlink" title="&#x6A21;&#x6001;&#x8DF3;&#x8F6C;&#x7684;&#x52A8;&#x753B;&#x8BBE;&#x7F6E;"></a>&#x6A21;&#x6001;&#x8DF3;&#x8F6C;&#x7684;&#x52A8;&#x753B;&#x8BBE;&#x7F6E;</h4><p>  &#x3000;&#x3000;&#x8BBE;&#x7F6E;&#x6A21;&#x6001;&#x8DF3;&#x8F6C;&#x7684;&#x52A8;&#x753B;&#xFF0C;&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#x4E86;&#x56DB;&#x79CD;&#x53EF;&#x4F9B;&#x9009;&#x62E9;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DetailViewController *detailVC = [[DetailViewController alloc]init];</span><br><span class="line"><span class="comment">//UIModalTransitionStyleFlipHorizontal &#x7FFB;&#x8F6C;</span></span><br><span class="line"><span class="comment">//UIModalTransitionStyleCoverVertical &#x5E95;&#x90E8;&#x6ED1;&#x51FA;</span></span><br><span class="line"><span class="comment">//UIModalTransitionStyleCrossDissolve &#x6E10;&#x663E;</span></span><br><span class="line"><span class="comment">//UIModalTransitionStylePartialCurl &#x7FFB;&#x9875;</span></span><br><span class="line">detailVC.modalTransitionStyle = <span class="built_in">UIModalTransitionStylePartialCurl</span>;</span><br><span class="line">[<span class="keyword">self</span> presentViewController:detailVC animated:<span class="literal">YES</span> completion:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x56FE;&#x7247;&#x5904;&#x7406;&#x53EA;&#x62FF;&#x5230;&#x56FE;&#x7247;&#x7684;&#x4E00;&#x90E8;&#x5206;"><a href="#&#x56FE;&#x7247;&#x5904;&#x7406;&#x53EA;&#x62FF;&#x5230;&#x56FE;&#x7247;&#x7684;&#x4E00;&#x90E8;&#x5206;" class="headerlink" title="&#x56FE;&#x7247;&#x5904;&#x7406;&#x53EA;&#x62FF;&#x5230;&#x56FE;&#x7247;&#x7684;&#x4E00;&#x90E8;&#x5206;"></a>&#x56FE;&#x7247;&#x5904;&#x7406;&#x53EA;&#x62FF;&#x5230;&#x56FE;&#x7247;&#x7684;&#x4E00;&#x90E8;&#x5206;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageNamed:filename];</span><br><span class="line"><span class="built_in">CGImageRef</span> imageRef = image.CGImage;</span><br><span class="line"><span class="built_in">CGRect</span> rect = <span class="built_in">CGRectMake</span>(origin.x, origin.y ,size.width, size.height);</span><br><span class="line"><span class="comment">//&#x8FD9;&#x91CC;&#x7684;&#x5BBD;&#x9AD8;&#x662F;&#x76F8;&#x5BF9;&#x4E8E;&#x56FE;&#x7247;&#x7684;&#x771F;&#x5B9E;&#x5927;&#x5C0F;</span></span><br><span class="line"><span class="comment">//&#x6BD4;&#x5982;&#x4F60;&#x7684;&#x56FE;&#x7247;&#x662F;400x400&#x7684;&#x90A3;&#x4E48;&#xFF08;0&#xFF0C;0&#xFF0C;400&#xFF0C;400&#xFF09;&#x5C31;&#x662F;&#x56FE;&#x7247;&#x7684;&#x5168;&#x5C3A;&#x5BF8;&#xFF0C;&#x60F3;&#x53D6;&#x54EA;&#x4E00;&#x90E8;&#x5206;&#x5C31;&#x8BBE;&#x7F6E;&#x76F8;&#x5E94;&#x5750;&#x6807;&#x5373;&#x53EF;</span></span><br><span class="line"><span class="built_in">CGImageRef</span> imageRefRect = <span class="built_in">CGImageCreateWithImageInRect</span>(imageRef, rect);</span><br><span class="line"><span class="built_in">UIImage</span> *imageRect = [[<span class="built_in">UIImage</span> alloc] initWith<span class="built_in">CGImage</span>:imageRefRect];</span><br></pre></td></tr></table></figure>
<h4 id="&#x7ED9;UIView&#x8BBE;&#x7F6E;&#x56FE;&#x7247;"><a href="#&#x7ED9;UIView&#x8BBE;&#x7F6E;&#x56FE;&#x7247;" class="headerlink" title="&#x7ED9;UIView&#x8BBE;&#x7F6E;&#x56FE;&#x7247;"></a>&#x7ED9;UIView&#x8BBE;&#x7F6E;&#x56FE;&#x7247;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">    <span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@&quot;playing&quot;</span>];</span><br><span class="line">    _layerView.layer.contents = (__bridge <span class="keyword">id</span>)image.CGImage;</span><br><span class="line">_layerView.layer.contentsCenter = <span class="built_in">CGRectMake</span>(<span class="number">0.25</span>, <span class="number">0.25</span>, <span class="number">0.5</span>, <span class="number">0.5</span>);</span><br><span class="line"><span class="comment">//&#x540C;&#x6837;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x663E;&#x793A;&#x7684;&#x56FE;&#x7247;&#x8303;&#x56F4;</span></span><br><span class="line"><span class="comment">//&#x4E0D;&#x8FC7;&#x6B64;&#x5904;&#x7565;&#x6709;&#x4E0D;&#x540C;&#xFF0C;&#x8FD9;&#x91CC;&#x7684;&#x56DB;&#x4E2A;&#x503C;&#x5747;&#x4E3A;0-1&#x4E4B;&#x95F4;&#xFF1B;&#x5BF9;&#x5E94;&#x7684;&#x4F9D;&#x7136;&#x662F;&#x5199;x,y,widt,height</span></span><br></pre></td></tr></table></figure>
<h4 id="&#x7ED9;TableView&#x6216;&#x8005;CollectionView&#x7684;cell&#x6DFB;&#x52A0;&#x7B80;&#x5355;&#x52A8;&#x753B;&#xFF0C;&#x50CF;&#x8FD9;&#x6837;"><a href="#&#x7ED9;TableView&#x6216;&#x8005;CollectionView&#x7684;cell&#x6DFB;&#x52A0;&#x7B80;&#x5355;&#x52A8;&#x753B;&#xFF0C;&#x50CF;&#x8FD9;&#x6837;" class="headerlink" title="&#x7ED9;TableView&#x6216;&#x8005;CollectionView&#x7684;cell&#x6DFB;&#x52A0;&#x7B80;&#x5355;&#x52A8;&#x753B;&#xFF0C;&#x50CF;&#x8FD9;&#x6837;"></a>&#x7ED9;TableView&#x6216;&#x8005;CollectionView&#x7684;cell&#x6DFB;&#x52A0;&#x7B80;&#x5355;&#x52A8;&#x753B;&#xFF0C;&#x50CF;&#x8FD9;&#x6837;</h4><p><img src="http://upload-images.jianshu.io/upload_images/966908-4f826be8fca0bb4a.gif?imageMogr2/auto-orient/strip" alt="888.gif"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/966908-a6cf7dd499ba351e.gif?imageMogr2/auto-orient/strip" alt="555.gif"><br>&#x53EA;&#x8981;&#x5728;willDisplayCell&#x65B9;&#x6CD5;&#x4E2D;&#x5BF9;&#x5C06;&#x8981;&#x663E;&#x793A;&#x7684;cell&#x505A;&#x52A8;&#x753B;&#x5373;&#x53EF;&#xFF1A;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView willDisplayCell:(<span class="built_in">UITableViewCell</span> *)cell forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath{</span><br><span class="line">    <span class="built_in">NSArray</span> *array =  tableView.indexPathsForVisibleRows;</span><br><span class="line">    <span class="built_in">NSIndexPath</span> *firstIndexPath = array[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x8BBE;&#x7F6E;anchorPoint</span></span><br><span class="line">    cell.layer.anchorPoint = <span class="built_in">CGPointMake</span>(<span class="number">0</span>, <span class="number">0.5</span>);</span><br><span class="line">    <span class="comment">//&#x4E3A;&#x4E86;&#x9632;&#x6B62;cell&#x89C6;&#x56FE;&#x79FB;&#x52A8;&#xFF0C;&#x91CD;&#x65B0;&#x628A;cell&#x653E;&#x56DE;&#x539F;&#x6765;&#x7684;&#x4F4D;&#x7F6E;</span></span><br><span class="line">    cell.layer.position = <span class="built_in">CGPointMake</span>(<span class="number">0</span>, cell.layer.position.y);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x8BBE;&#x7F6E;cell &#x6309;&#x7167;z&#x8F74;&#x65CB;&#x8F6C;90&#x5EA6;&#xFF0C;&#x6CE8;&#x610F;&#x662F;&#x5F27;&#x5EA6;</span></span><br><span class="line">    <span class="keyword">if</span> (firstIndexPath.row &lt; indexPath.row) {</span><br><span class="line">            cell.layer.transform = <span class="built_in">CATransform3DMakeRotation</span>(M_PI_2, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1.0</span>);</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        cell.layer.transform = <span class="built_in">CATransform3DMakeRotation</span>(- M_PI_2, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1.0</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    cell.alpha = <span class="number">0.0</span>;</span><br><span class="line"></span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">1</span> animations:^{</span><br><span class="line">        cell.layer.transform = <span class="built_in">CATransform3DIdentity</span>;</span><br><span class="line">        cell.alpha = <span class="number">1.0</span>;</span><br><span class="line">    }];</span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)collectionView:(<span class="built_in">UICollectionView</span> *)collectionView willDisplayCell:(<span class="built_in">UICollectionViewCell</span> *)cell forItemAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (indexPath.row % <span class="number">2</span> != <span class="number">0</span>) {</span><br><span class="line">        cell.transform = <span class="built_in">CGAffineTransformTranslate</span>(cell.transform, kScreenWidth/<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        cell.transform = <span class="built_in">CGAffineTransformTranslate</span>(cell.transform, -kScreenWidth/<span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">    }</span><br><span class="line">    cell.alpha = <span class="number">0.0</span>;</span><br><span class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.7</span> animations:^{</span><br><span class="line">        cell.transform = <span class="built_in">CGAffineTransformIdentity</span>;</span><br><span class="line">        cell.alpha = <span class="number">1.0</span>;</span><br><span class="line">    } completion:^(<span class="built_in">BOOL</span> finished) {</span><br><span class="line"></span><br><span class="line">    }];</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x5982;&#x9700;&#x8F6C;&#x8F7D;&#x8BF7;&#x6CE8;&#x660E;&#x51FA;&#x5904;&#xFF0C;&#x8BF7;&#x5C0A;&#x91CD;&#x4F5C;&#x8005;&#x7684;&#x52B3;&#x52A8;&#x6210;&#x679C;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOS10上手]]></title>
      <url>http://nanshanyi.github.io/2016/06/14/iOS10%E4%B8%8A%E6%89%8B/</url>
      <content type="html"><![CDATA[<p>Apple &#x5728;&#x4ECA;&#x5929;&#x51CC;&#x6668;&#x53D1;&#x5E03;&#x4E86;&#x5168;&#x65B0;&#x4E00;&#x4EE3;&#x7684;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;iOS10.0beta&#xFF0C;&#x4ECA;&#x5929;&#x5728;&#x7B2C;&#x4E00;&#x65F6;&#x95F4;&#x7528;iPhone6sP&#x66F4;&#x65B0;&#x4E86;&#x8BE5;&#x7CFB;&#x7EDF;&#xFF0C;&#x73B0;&#x5728;&#x901A;&#x8FC7;&#x7CFB;&#x7EDF;&#x622A;&#x56FE;&#x7ED9;&#x5927;&#x5BB6;&#x5E26;&#x6765;&#x7B2C;&#x4E00;&#x624B;&#x7684;&#x4F53;&#x9A8C;&#x3002;<br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-8b373729ba35b9a3.png" width="60%" height="60%"><br>&#x3000;&#x3000;iOS10&#x7684;&#x9501;&#x5C4F;&#x754C;&#x9762;&#x6539;&#x53D8;&#x8F83;&#x5927;&#xFF0C;&#x539F;&#x6709;&#x7684;&#x201C;&#x5411;&#x53F3;&#x6ED1;&#x52A8;&#x89E3;&#x9501;&#x201D;&#x529F;&#x80FD;&#x88AB;&#x201C;&#x6309;&#x4E0B;&#x4E3B;&#x9891;&#x5E55;&#x6309;&#x94AE;&#x4EE5;&#x6253;&#x5F00;&#x201D;&#x66FF;&#x6362;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8BF4;&#x7B2C;&#x4E00;&#x4E0B;&#x6309;&#x70B9;&#x4EAE;&#x5C4F;&#x5E55;&#xFF0C;&#x518D;&#x6309;&#x4E00;&#x4E0B;&#x65B9;&#x53EF;&#x89E3;&#x9501;&#x3002;&#x5982;&#x679C;&#x4F7F;&#x7528;Touch ID&#x8FD8;&#x662F;&#x76F4;&#x63A5;&#x89E3;&#x9501;&#x3002;&#x4F46;&#x662F;&#x65B0;&#x52A0;&#x5165;&#x7684;&#x62FF;&#x8D77;&#x4EAE;&#x5C4F;&#xFF0C;&#x653E;&#x4E0B;&#x7184;&#x5C4F;&#x3002;&#x771F;&#x7684;&#x5F88;&#x8D5E;&#xFF0C;&#x8981;&#x770B;&#x4E00;&#x4E0B;&#x65F6;&#x95F4;&#xFF0C;&#x76F4;&#x63A5;&#x62FF;&#x8D77;&#x5C4F;&#x5E55;&#x5C31;&#x70B9;&#x4EAE;&#x3002;&#x9501;&#x5C4F;&#x754C;&#x9762;&#x5DE6;&#x6ED1;&#x51FA;&#x73B0;widget&#xFF0C;&#x7B49;&#x63A7;&#x4EF6;&#x3002;<br><a id="more"></a><br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-c1ecb4451c126850.png" width="60%" height="60%"></p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-c3ce28564877bc2b.png" width="60%" height="60%"><br>&#x3000;&#x3000;&#x53F3;&#x6ED1;&#x5219;&#x662F;&#x6253;&#x5F00;&#x76F8;&#x673A;&#x64CD;&#x4F5C;&#x3002;&#x76F8;&#x673A;&#x672C;&#x8EAB;&#x4E5F;&#x662F;&#x5DE6;&#x53F3;&#x6ED1;&#x52A8;&#x5207;&#x6362;&#x529F;&#x80FD;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x80FD;&#x5728;&#x6ED1;&#x52A8;&#x8FD4;&#x56DE;&#xFF0C;&#x53EA;&#x80FD;&#x70B9;&#x51FB;home&#x952E;&#x3002;&#x70B9;&#x51FB;&#x7F16;&#x8F91;&#x53EF;&#x4EE5;&#x6DFB;&#x52A0;Widget&#x3002;&#x9501;&#x5C4F;&#x754C;&#x9762;&#x7684;&#x901A;&#x77E5;&#x4E5F;&#x662F;&#x5361;&#x7247;&#x5F0F;&#x7684;&#x3002;&#x6309;&#x538B;&#x53EF;&#x4EE5;&#x9884;&#x89C8;&#x6D88;&#x606F;&#x8BE6;&#x60C5;,&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x8FDB;&#x884C;&#x6D88;&#x606F;&#x56DE;&#x590D;</p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-bd456476ef5722d3.png" width="60%" height="60%"></p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-3210e9cdbfdadbfb.png" width="60%" height="60%"></p>
<p>&#x3000;&#x3000;&#x4E3B;&#x5C4F;&#x5E55;&#x53D8;&#x5316;&#x4E0D;&#x662F;&#x5F88;&#x5927;&#x8DDF;&#x539F;&#x6765;&#x57FA;&#x672C;&#x4FDD;&#x6301;&#x4E00;&#x81F4;&#x3002;&#x957F;&#x5B89;&#x53EF;&#x4EE5;&#x5220;&#x9664;&#x56FE;&#x6807;&#xFF0C;&#x7CFB;&#x7EDF;&#x5E94;&#x7528;&#x4E5F;&#x652F;&#x6301;&#x5378;&#x8F7D;&#x4E86;&#xFF08;&#x8FD9;&#x91CC;&#x5E76;&#x6CA1;&#x6709;&#x771F;&#x6B63;&#x7684;&#x5378;&#x8F7D;&#xFF0C;&#x53EA;&#x662F;&#x9690;&#x85CF;&#x6389;&#x4E86;&#x5E94;&#x7528;&#x56FE;&#x6807;&#x800C;&#x5DF2;&#xFF0C;&#x53E6;&#x5916;&#x6587;&#x4EF6;&#x5939;&#x6253;&#x5F00;&#x7684;&#x6BDB;&#x73BB;&#x7483;&#x6548;&#x679C;&#x4E5F;&#x6BD4;&#x539F;&#x6765;&#x66F4;&#x52A0;&#x900F;&#x660E;&#x4E86;&#x3002;&#x65B0;&#x6DFB;&#x52A0;&#x4E86;&#x5BB6;&#x5EAD;&#x7CFB;&#x7EDF;&#x5E94;&#x7528;&#xFF0C;&#x4E0D;&#x8FC7;&#x6211;&#x4EEC;&#x7528;&#x57FA;&#x672C;&#x6CA1;&#x7528;<br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-0cbf31b5589d5970.png" width="60%" height="60%"><br> &#x3000;&#x3000;&#x4E0B;&#x62C9;&#x901A;&#x77E5;&#x680F;&#x73B0;&#x5728;&#x53EA;&#x6709;&#x4E00;&#x680F;&#xFF08;&#x5728;&#x684C;&#x9762;&#x7684;&#x65F6;&#x5019;&#x53EA;&#x6709;&#x4E00;&#x680F;&#xFF09;,&#x5728;&#x5E94;&#x7528;&#x91CC;&#x9762;&#x65F6;&#x4E0B;&#x62C9;&#x4F1A;&#x6709;&#x4E24;&#x680F;&#xFF0C;&#x5DE6;&#x8FB9;&#x4E00;&#x680F;&#x8FD8;&#x662F;widget&#x3002;<br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-eb12e8404ff4ad5b.png" width="60%" height="60%"></p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-b76a0d19081f1bbd.png" width="60%" height="60%"><br>&#x3000;&#x3000;&#x63A7;&#x5236;&#x4E2D;&#x5FC3;&#x53D8;&#x5316;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x660E;&#x663E;&#x7684;&#xFF0C;&#x6837;&#x5F0F;&#x53D8;&#x4E3A;&#x4E86;&#x5361;&#x7247;&#x5F0F;&#xFF0C;&#x4E0A;&#x9762;&#x7684;&#x5FEB;&#x6377;&#x5F00;&#x5173;&#x6CA1;&#x6709;&#x52A0;&#x5165;3D Touch&#x7565;&#x6709;&#x9057;&#x61BE;&#x3002;&#x4E0B;&#x9762;&#x7684;&#x624B;&#x7535;&#x7B52;&#x7B49;&#x5FEB;&#x6377;&#x65B9;&#x5F0F;&#x52A0;&#x5165;&#x4E86;3D Touch&#x64CD;&#x4F5C;.&#x5DE6;&#x6ED1;&#x662F;&#x97F3;&#x4E50;&#x63A7;&#x5236;&#x5361;&#x7247;</p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-47ad13018918c9a0.png" width="60%" height="60%"><br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-94f87f47fc40def5.png" width="60%" height="60%"><br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-aef33cc77453af61.png" width="60%" height="60%"></p>
<p>&#x3000;&#x3000;&#x73B0;&#x5728;&#x4E0D;&#x7BA1;&#x5E94;&#x7528;&#x662F;&#x5426;&#x652F;&#x6301;3D Touch&#xFF0C;&#x6309;&#x538B;&#x90FD;&#x4F1A;&#x6709;&#x4E00;&#x4E2A;share&#x9009;&#x9879;&#x3002;&#x539F;&#x6709;&#x652F;&#x6301;&#x7684;&#x5E94;&#x7528;&#x4E5F;&#x90FD;&#x4F1A;&#x589E;&#x52A0;&#x4E00;&#x4E2A;share&#x9879;&#x3002;&#x8BBE;&#x7F6E;&#x7684;3D Touch&#x83DC;&#x5355;&#x6DFB;&#x52A0;&#x4E86;&#x8702;&#x7A9D;&#x79FB;&#x52A8;&#x6570;&#x636E;&#x9009;&#x9879;&#x3002;&#x53E6;&#x5916;&#x5728;&#x65E0;&#x7EBF;&#x7F51;&#x7684;&#x8BBE;&#x7F6E;&#x4E2D;&#x65B0;&#x6DFB;&#x52A0;&#x4E86;&#x8054;&#x7F51;&#x7BA1;&#x7406;&#xFF0C;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x5355;&#x4E2A;&#x5E94;&#x7528;&#x5728;wifi&#x4E0B;&#x6216;&#x5728;&#x6570;&#x636E;&#x6D41;&#x91CF;&#x4E0B;&#xFF0C;&#x6216;&#x8005;&#x4E8C;&#x8005;&#x5747;&#x53EF;&#x8054;&#x7F51;&#x3002;&#x4F46;&#x662F;&#x6C49;&#x5316;&#x7565;&#x6709;&#x95EE;&#x9898;<br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-a53e9ef235150671.png" width="60%" height="60%"></p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-85ec905f8b654cae.png" width="60%" height="60%"><br>  &#x3000;&#x3000;&#x8BBE;&#x7F6E;&#x4E2D;&#x65B0;&#x6DFB;&#x52A0;&#x4E86;Siri&#x9879;&#x548C;&#x56FE;&#x6807;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x4E1C;&#x897F;&#x6CA1;&#x4EC0;&#x4E48;&#x53D8;&#x5316;<br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-844b6900f27540e7.png" width="60%" height="60%"><br>  &#x3000;&#x3000;&#x672C;&#x6B21;&#x66F4;&#x65B0;message&#x53D8;&#x5316;&#x8FD8;&#x662F;&#x6BD4;&#x8F83;&#x5927;&#x7684;&#xFF0C;&#x6DFB;&#x52A0;&#x4E86;&#x597D;&#x591A;&#x529F;&#x80FD;&#xFF0C;&#x65B0;&#x7684;&#x8868;&#x60C5;&#xFF0C;&#x548C;&#x65B0;&#x7684;&#x624B;&#x5199;&#x8F93;&#x5165;&#xFF0C;&#x76F4;&#x63A5;&#x53D1;&#x9001;<br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-9f51fd4d3ef825d0.png" width="60%" height="60%"><br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-3a16530c12cfcbc3.png" width="60%" height="60%"></p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-ecb2b3146f647b36.png" width="60%" height="60%"><br>  &#x3000;&#x3000;&#x5065;&#x5EB7;&#x5E94;&#x7528;&#x7684;UI&#x53D8;&#x5316;&#x4E5F;&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x8FD9;&#x91CC;&#x53D1;&#x73B0;&#x4E00;&#x4E2A;BUG&#xFF0C;&#x6B65;&#x6570;&#x8DDD;&#x79BB;&#x548C;&#x697C;&#x5C42;&#x662F;&#x53EF;&#x4EE5;3D Touch&#x9884;&#x89C8;&#x7684;&#xFF0C;&#x5DE6;&#x53F3;&#x6ED1;&#x52A8;&#x53EF;&#x4EE5;&#x5207;&#x6362;&#x65E5;&#x671F;&#x3002;&#x4F46;&#x662F;&#x5207;&#x6362;&#x5230;&#x6628;&#x5929;&#x540E;&#x6309;&#x538B;&#x9884;&#x89C8;&#xFF0C;&#x6570;&#x636E;&#x73B0;&#x5B9E;&#x7684;&#x8FD8;&#x662F;&#x4ECA;&#x5929;&#x7684;<br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-f014db15256c6be1.png" width="60%" height="60%"></p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-9bd74d9190e5c978.png" width="60%" height="60%"><br><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-aa3aa7c3082ac73c .png" width="60%" height="60%"><br>  &#x3000;&#x3000;&#x65F6;&#x949F;&#x91C7;&#x7528;&#x4E86;&#x9ED1;&#x8272;&#x4E3B;&#x9898;&#xFF0C;&#x5168;&#x9ED1;&#x7684;&#x3002;&#x611F;&#x89C9;&#x6CA1;&#x6709;&#x767D;&#x8272;&#x7684;&#x597D;&#x770B;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x4E00;&#x4E0B;</p>
<p><img src="/2016/06/14/iOS10&#x4E0A;&#x624B;/966908-d7af8c36d981ecdd.png" width="60%" height="60%"></p>
<p>  &#x3000;&#x3000;&#x5730;&#x56FE;&#x548C;&#x76F8;&#x518C;&#x4E5F;&#x8FDB;&#x884C;&#x4E86;&#x76F8;&#x5E94;&#x529F;&#x80FD;&#x7684;&#x6DFB;&#x52A0;&#xFF0C;&#x7531;&#x4E8E;&#x53D8;&#x5316;&#x7B97;&#x5927;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4E0D;&#x518D;&#x63D0;&#x4E86;&#x82F9;&#x679C;&#x4E5F;&#x5728;iOS10&#x4E2D;&#x8868;&#x73B0;&#x51FA;&#x4E86;&#x8DB3;&#x591F;&#x591A;&#x7684;&#x5F00;&#x653E;&#x8BDA;&#x610F;&#xFF0C;&#x76EE;&#x524D;Siri&#x3001;iMessage&#x3001;&#x82F9;&#x679C;&#x5730;&#x56FE;&#x670D;&#x52A1;&#x5747;&#x5411;&#x7B2C;&#x4E09;&#x65B9;&#x5E94;&#x7528;&#x5F00;&#x653E;&#xFF0C;&#x4EE5;&#x4F9B;&#x5F00;&#x53D1;&#x8005;&#x4F7F;&#x7528;&#x3002;&#x82F9;&#x679C;&#x7684;&#x7167;&#x7247;&#x529F;&#x80FD;&#x8FDB;&#x6B65;&#x6BD4;&#x8F83;&#x660E;&#x663E;&#xFF0C;&#x5F53;&#x7136;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x8BF4;&#x5B83;&#x4E0E;&#x8C37;&#x6B4C;&#x76F8;&#x518C;&#x66F4;&#x52A0;&#x63A5;&#x8FD1;&#x4E86;&#xFF0C;&#x9664;&#x4E86;&#x652F;&#x6301;&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x9762;&#x90E8;&#x4EE5;&#x53CA;&#x573A;&#x666F;&#x5916;&#xFF0C;&#x5B83;&#x8FD8;&#x80FD;&#x50CF;&#x8C37;&#x6B4C;&#x76F8;&#x518C;&#x4E00;&#x6837;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x7D22;&#x5F15;&#xFF0C;&#x5E76;&#x8FDB;&#x884C;&#x5173;&#x952E;&#x5B57;&#x7684;&#x9AD8;&#x7EA7;&#x641C;&#x7D22;&#xFF0C;&#x65B0;&#x589E;&#x7684;&#x56DE;&#x5FC6;&#x529F;&#x80FD;&#x76F8;&#x5F53;&#x4E0D;&#x9519;&#xFF0C;&#x82F9;&#x679C;&#x63D0;&#x4F9B;&#x4E86;&#x9ED8;&#x8BA4;&#x7684;&#x51E0;&#x79CD;&#x8BBE;&#x7F6E;&#x7EC4;&#x5408;&#xFF0C;&#x53EF;&#x4ECE;&#x4E91;&#x7AEF;&#x4E0B;&#x8F7D;&#x914D;&#x4E50;&#xFF0C;&#x7136;&#x540E;&#x5B83;&#x4F1A;&#x6309;&#x7167;&#x6B4C;&#x66F2;&#x7684;&#x65CB;&#x5F8B;&#x8282;&#x594F;&#x81EA;&#x52A8;&#x8FDB;&#x884C;&#x5408;&#x7406;&#x7684;&#x526A;&#x8F91;&#xFF0C;&#x51FA;&#x6765;&#x7684;&#x6548;&#x679C;&#x8FD8;&#x662F;&#x76F8;&#x5F53;&#x51FA;&#x8272;&#x7684;&#x3002;<br>  &#x3000;&#x3000;&#x5982;&#x679C;&#x4F60;&#x4E5F;&#x60F3;&#x4F53;&#x9A8C;iOS10&#xFF0C;<a href="http://pan.baidu.com/s/1ge7uFnX" target="_blank" rel="external">&#x70B9;&#x51FB;</a>&#x7528;safari&#x6253;&#x5F00;&#xFF0C;&#x5B89;&#x88C5;&#x6B64;&#x63CF;&#x8FF0;&#x6587;&#x4EF6;&#xFF0C;&#x5373;&#x53EF;&#x68C0;&#x67E5;&#x66F4;&#x65B0;&#x5230;iOS10&#xFF0C;&#x66F4;&#x65B0;&#x5347;&#x7EA7;&#x5373;&#x53EF;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[hexo创建个人博客]]></title>
      <url>http://nanshanyi.github.io/2016/06/05/hexoBlog/</url>
      <content type="html"><![CDATA[<p>&#x4F60;&#x662F;&#x4E0D;&#x662F;&#x89C1;&#x591A;&#x4E86;&#x5404;&#x79CD;&#x5927;v&#x7684;&#x4E2A;&#x4EBA;&#x535A;&#x5BA2;&#xFF0C;&#x662F;&#x4E0D;&#x662F;&#x4E5F;&#x60F3;&#x62E5;&#x6709;&#x8FD9;&#x6837;&#x7684;&#x4E00;&#x4E2A;&#x4E2A;&#x4EBA;&#x535A;&#x5BA2;&#xFF0C;&#xFF08;&#x9759;&#x9759;&#x7684;&#x88C5;B&#xFF01;&#xFF09;&#x770B;&#x8FD9;&#x91CC;&#xFF0C;&#x5C31;&#x5BF9;&#x4E86;&#x3002;&#x4E00;&#x6B65;&#x4E00;&#x6B65;&#x6559;&#x4F60;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x535A;&#x5BA2;&#x3002;<br>&#x3000;&#x3000;&#x73B0;&#x5728;&#x7528;&#x7684;&#x6BD4;&#x8F83;&#x591A;&#x7684;&#x5C31;&#x662F;<a href="https://hexo.io/zh-cn/" target="_blank" rel="external">hexo</a>&#xFF08;&#x5FEB;&#x901F;&#x3001;&#x7B80;&#x6D01;&#x4E14;&#x9AD8;&#x6548;&#x7684;&#x535A;&#x5BA2;&#x6846;&#x67B6;&#xFF09;&#xFF0C;&#x652F;&#x6301;markDown&#xFF0C;&#x6709;&#x4E30;&#x5BCC;&#x7684;&#x63D2;&#x4EF6;&#x548C;&#x4E3B;&#x9898;</p>
<h3 id="&#x5B89;&#x88C5;&#x73AF;&#x5883;"><a href="#&#x5B89;&#x88C5;&#x73AF;&#x5883;" class="headerlink" title="&#x5B89;&#x88C5;&#x73AF;&#x5883;"></a>&#x5B89;&#x88C5;&#x73AF;&#x5883;</h3><p>&#x3000;&#x3000;&#x5B89;&#x88C5;<a href="https://git-scm.com/" target="_blank" rel="external">git</a> &#x548C; <a href="https://nodejs.org/en/" target="_blank" rel="external">Node.js</a>,git&#x5C31;&#x4E0D;&#x7528;&#x591A;&#x8BF4;&#x4E86;&#xFF0C;&#x5982;&#x679C;&#x8FDE;git&#x90FD;&#x4E0D;&#x4F1A;&#x88C5;&#xFF0C;&#x8BF7;&#x51FA;&#x53BB;&#x628A;&#x95E8;&#x5173;&#x4E0A;&#x3002;<br>&#x3000;&#x3000;Node.js &#x7684;&#x5B89;&#x88C5;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x4E24;&#x79CD;&#x65B9;&#x6CD5;&#xFF0C;1&#x3001;&#x70B9;&#x51FB;&#x524D;&#x9762;&#x94FE;&#x63A5;&#x76F4;&#x63A5;&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;&#x5373;&#x53EF; 2&#x3001;&#x901A;&#x8FC7;&#x7EC8;&#x7AEF;&#x547D;&#x4EE4;&#x884C;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl https://raw.github.com/creationix/nvm/master/install.sh | sh</span><br></pre></td></tr></table></figure></p>
<p>&#x4E4B;&#x540E;&#x91CD;&#x542F;&#x7EC8;&#x7AEF;&#xFF0C;&#x5982;&#x679C;&#x8FD8;&#x627E;&#x4E0D;&#x5230;nvm&#x547D;&#x4EE4;&#x53EF;&#x5C1D;&#x8BD5;&#x91CD;&#x542F;&#x7535;&#x8111;<br>&#x63A5;&#x7740;&#x6267;&#x884C;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ nvm install 4</span><br></pre></td></tr></table></figure></p>
<p>&#x5373;&#x53EF;&#x5B89;&#x88C5;&#x5B8C;&#x6210;<br>&#x4EE5;&#x4E0A;&#x4E24;&#x4E2A;&#x6761;&#x4EF6;&#x5DF2;&#x5177;&#x5907;&#x7684;&#x8BDD;&#xFF0C;&#x5373;&#x53EF;&#x5F00;&#x59CB;&#x5B89;&#x88C5;hexo&#x535A;&#x5BA2;&#x6846;&#x67B6;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo-cli</span><br></pre></td></tr></table></figure></p>
<p>&#x6267;&#x884C;&#x5B8C;&#x6210;&#x540E;hexo&#x5C31;&#x5B89;&#x88C5;&#x6210;&#x529F;&#x4E86;&#xFF0C;&#x7B2C;&#x4E00;&#x6B65;&#x7ED3;&#x675F;&#xFF0C;&#x73AF;&#x5883;&#x914D;&#x7F6E;&#x5B8C;&#x6BD5;&#x53EF;&#x4EE5;&#x5F00;&#x59CB;&#x521B;&#x5EFA;&#x81EA;&#x5DF1;&#x7684;&#x535A;&#x5BA2;&#x4E86;<br><a id="more"></a></p>
<h3 id="github&#x4E0A;&#x521B;&#x5EFA;&#x4ED3;&#x5E93;"><a href="#github&#x4E0A;&#x521B;&#x5EFA;&#x4ED3;&#x5E93;" class="headerlink" title="github&#x4E0A;&#x521B;&#x5EFA;&#x4ED3;&#x5E93;"></a>github&#x4E0A;&#x521B;&#x5EFA;&#x4ED3;&#x5E93;</h3><p>&#x3000;&#x3000;github&#x5E10;&#x53F7;&#x7684;&#x521B;&#x5EFA;&#x6211;&#x4E5F;&#x4E0D;&#x518D;&#x6B21;&#x8D58;&#x8FF0;&#x4E86;&#x3002;&#x4E0B;&#x9762;&#x8BF4;&#x4E00;&#x4E0B;&#x4ED3;&#x5E93;&#x7684;&#x521B;&#x5EFA;&#xFF0C;&#x540D;&#x5B57;&#x524D;&#x9762;&#x90E8;&#x5206;&#x53EF;&#x4EE5;&#x81EA;&#x5DF1;&#x968F;&#x4FBF;&#x8D77;&#x3002;&#x540E;&#x9762;&#x90E8;&#x5206;&#x7EDF;&#x4E00;&#x4E3A;github.io &#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x5747;&#x4E0D;&#x9700;&#x8BBE;&#x7F6E;&#x3002;&#x5982;&#x4E0B;&#x56FE;&#xFF1A;<br><img src="http://upload-images.jianshu.io/upload_images/966908-31ea0d71b6effe97.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-09 &#x4E0B;&#x5348;5.36.45.png"></p>
<h3 id="&#x535A;&#x5BA2;&#x7684;&#x521B;&#x5EFA;"><a href="#&#x535A;&#x5BA2;&#x7684;&#x521B;&#x5EFA;" class="headerlink" title="&#x535A;&#x5BA2;&#x7684;&#x521B;&#x5EFA;"></a>&#x535A;&#x5BA2;&#x7684;&#x521B;&#x5EFA;</h3><h4 id="&#x521D;&#x59CB;&#x5316;"><a href="#&#x521D;&#x59CB;&#x5316;" class="headerlink" title="&#x521D;&#x59CB;&#x5316;"></a>&#x521D;&#x59CB;&#x5316;</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /Desktop  //cd&#x5230;&#x4F60;&#x7684;&#x684C;&#x9762;&#x6267;&#x884C;&#xFF1A;&#xFF08;init &#x540E;&#x9762;&#x7684;&#x5C31;&#x662F;&#x4F60;&#x7684;&#x540D;&#x5B57;&#xFF0C;&#x5F53;&#x7136;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x968F;&#x4FBF;&#x8D77;&#xFF0C;&#x4E0D;&#x5F71;&#x54CD;&#x7684;&#xFF0C;&#x4EC5;&#x4EC5;&#x662F;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#xFF09;</span><br><span class="line">$ hexo init nanshanyi.github.io</span><br></pre></td></tr></table></figure>
<p>&#x684C;&#x9762;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x5939;nanshanyi.github.io</p>
<h4 id="&#x57FA;&#x7840;&#x914D;&#x7F6E;"><a href="#&#x57FA;&#x7840;&#x914D;&#x7F6E;" class="headerlink" title="&#x57FA;&#x7840;&#x914D;&#x7F6E;"></a>&#x57FA;&#x7840;&#x914D;&#x7F6E;</h4><p>&#x3000;&#x3000;&#x6253;&#x5F00;_config.yml&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x57FA;&#x7840;&#x914D;&#x7F6E;&#xFF08;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<a href="http://www.sublimetext.com/" target="_blank" rel="external">sublime</a>&#x6216;&#x8005;<a href="https://atom.io/" target="_blank" rel="external">atom</a>&#x6765;&#x6253;&#x5F00;&#xFF0C;&#x90FD;&#x662F;&#x5F88;&#x5F88;&#x5F3A;&#x5927;&#x7684;&#x4EE3;&#x7801;&#x7F16;&#x8F91;&#x5668;&#xFF0C;&#x53EF;&#x5B89;&#x88C5;&#x5404;&#x79CD;&#x63D2;&#x4EF6;&#xFF0C;&#x524D;&#x7AEF;&#x5F00;&#x53D1;&#x5FC5;&#x5907;&#xFF09;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">title: &#x5357;&#x5C71;&#x4EBF;&#x7684;&#x6280;&#x672F;&#x535A;&#x5BA2;   //&#x535A;&#x5BA2;&#x540D;&#x5B57;</span><br><span class="line">subtitle: &#x79EF;&#x5C11;&#x6210;&#x591A;    //&#x5C0F;&#x6807;&#x9898;&#x53EF;&#x4EE5;&#x5199;&#x81EA;&#x5DF1;&#x559C;&#x6B22;&#x7684;&#x8BDD;</span><br><span class="line">description:          //&#x535A;&#x5BA2;&#x63CF;&#x8FF0;</span><br><span class="line">author: &#x5357;&#x5C71;&#x5FC6;     //&#x4F5C;&#x8005;&#x540D;&#x5B57;</span><br><span class="line">language: zh-Hans   //&#x8BED;&#x8A00;&#xFF08;&#x6B64;&#x5904;&#x4E3A;&#x7B80;&#x4F53;&#x4E2D;&#x6587;&#xFF09;</span><br><span class="line">url:  //&#x81EA;&#x5DF1;&#x8D2D;&#x4E70;&#x7684;&#x57DF;&#x540D;&#x7F51;&#x5740;&#xFF08;&#x6CA1;&#x6709;&#x53EF;&#x4E0D;&#x5199;&#xFF09;</span><br><span class="line">theme&#xFF1A;   //&#x4E3B;&#x9898;&#x7684;&#x540D;&#x5B57;</span><br><span class="line">deploy:</span><br><span class="line">type: git //&#x4F7F;&#x7528;git&#x53D1;&#x5E03;</span><br><span class="line">repo: https://github.com/nanshanyi/nanshanyi.github.io.git //&#x521A;&#x521A;&#x521B;&#x5EFA;&#x7684;github&#x4ED3;&#x5E93;&#x7684;&#x5730;&#x5740;</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x5B89;&#x88C5;&#x4E3B;&#x9898;"><a href="#&#x5B89;&#x88C5;&#x4E3B;&#x9898;" class="headerlink" title="&#x5B89;&#x88C5;&#x4E3B;&#x9898;"></a>&#x5B89;&#x88C5;&#x4E3B;&#x9898;</h4><p>&#x3000;&#x3000;&#x535A;&#x5BA2;&#x8981;&#x60F3;&#x70AB;&#x9177;&#x6F02;&#x4EAE;&#xFF0C;&#x4E00;&#x6B3E;&#x5408;&#x9002;&#x7684;&#x4E3B;&#x9898;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#xFF0C;hexo&#x672C;&#x8EAB;&#x5C31;&#x63D0;&#x4F9B;&#x4E86;50&#x79CD;<a href="https://hexo.io/themes/" target="_blank" rel="external">&#x4E3B;&#x9898;</a> &#x53EF;&#x4EE5;&#x9884;&#x89C8;&#x67E5;&#x770B;&#xFF0C;&#x9009;&#x62E9;&#x4E00;&#x6B3E;&#x81EA;&#x5DF1;&#x559C;&#x6B22;&#x7684;&#x4E3B;&#x9898;<br>&#x3000;&#x3000;&#x70B9;&#x51FB;&#x56FE;&#x7247;&#x5373;&#x53EF;&#x9884;&#x89C8;&#xFF0C;&#x770B;&#x5230;&#x6B64;&#x4E3B;&#x9898;&#x7684;&#x6548;&#x679C;&#xFF0C;&#x70B9;&#x51FB;&#x84DD;&#x8272;&#x4E3B;&#x9898;&#x540D;&#x5373;&#x53EF;&#x8FDB;&#x5165;&#x6B64;&#x4E3B;&#x9898;&#x7684;github&#x4ED3;&#x5E93;&#xFF0C;&#x4E00;&#x822C;&#x4E3B;&#x9898;&#x4F5C;&#x8005;&#x90FD;&#x5199;&#x6709;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x3002;<br><img src="http://upload-images.jianshu.io/upload_images/966908-241175b53edf7af2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-09 &#x4E0B;&#x5348;6.00.09.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x5230;nanshanyi.github.io&#x6587;&#x4EF6;&#x4E0B;</span><br><span class="line">$ git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x7684;&#x662F;&#x4E00;&#x6B3E;&#x7B80;&#x7EA6;&#x6F02;&#x4EAE;&#x7684;&#x4E3B;&#x9898;&#xFF0C;&#x4F7F;&#x7528;&#x7684;&#x4EBA;&#x633A;&#x591A;&#x7684;&#x3002;&#x4E4B;&#x540E;&#x5C31;&#x53EF;&#x4EE5;&#x5728;nanshanyi.github.io/themes&#x76EE;&#x5F55;&#x4E0B;&#x770B;&#x5230;nex&#xFF08;&#x4EE5;&#x4E0B;next&#x5747;&#x4E3A;&#x4E3B;&#x9898;&#x540D;&#xFF0C;&#x8DEF;&#x5F84;&#x4E2D;&#x4E3A;&#x4E3B;&#x9898;&#x6587;&#x4EF6;&#x5939;&#x540D;&#x3002;&#x4F7F;&#x7528;&#x7684;&#x4E3B;&#x9898;&#x4E0D;&#x540C;&#x53EA;&#x8981;&#x628A;next&#x6362;&#x6210;&#x76F8;&#x5E94;&#x7684;&#x540D;&#x5B57;&#x5373;&#x53EF;&#xFF09;&#x4E3B;&#x9898;&#x3002;&#x8FD9;&#x4E2A;&#x4E3B;&#x9898;&#x6709;&#x4E09;&#x79CD;&#x5E03;&#x5C40;&#x5C55;&#x793A;&#x5F62;&#x5F0F;&#xFF0C;&#x53EF;&#x81EA;&#x884C;&#x6311;&#x9009;&#x4E3B;&#x9898;&#x7684;&#x8BE6;&#x7EC6;&#x914D;&#x7F6E;<a href="http://theme-next.iissnan.com/getting-started.html" target="_blank" rel="external">&#x8BF7;&#x770B;&#x8FD9;&#x91CC;</a></p>
<h4 id="&#x521B;&#x5EFA;&#x535A;&#x5BA2;&#x6587;&#x7AE0;&#x4E0E;&#x53D1;&#x5E03;"><a href="#&#x521B;&#x5EFA;&#x535A;&#x5BA2;&#x6587;&#x7AE0;&#x4E0E;&#x53D1;&#x5E03;" class="headerlink" title="&#x521B;&#x5EFA;&#x535A;&#x5BA2;&#x6587;&#x7AE0;&#x4E0E;&#x53D1;&#x5E03;"></a>&#x521B;&#x5EFA;&#x535A;&#x5BA2;&#x6587;&#x7AE0;&#x4E0E;&#x53D1;&#x5E03;</h4><p>&#x3000;&#x3000;&#x5728;nanshanyi.github.io &#x76EE;&#x5F55;&#x4E0B;&#x7EC8;&#x7AEF;&#x547D;&#x4EE4;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new &apos;&#x6587;&#x4EF6;&#x540D;&apos; //&#x4F1A;&#x5728;source/_posts&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x540D;.md&#x6587;&#x4EF6;</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x8FD9;&#x5C31;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;markdown&#x7F16;&#x8F91;&#x5668;&#x5F00;&#x59CB;&#x5199;&#x81EA;&#x5DF1;&#x7684;&#x535A;&#x5BA2;&#x4E86;&#xFF08;&#x4E0A;&#x9762;&#x63D0;&#x5230;&#x6709;&#x5DE5;&#x5177;&#xFF09;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: new//&#x535A;&#x5BA2;&#x6807;&#x9898;</span><br><span class="line">date: 2016-05-10 10:47:49 //&#x521B;&#x5EFA;&#x65F6;&#x95F4;</span><br><span class="line">tags:  //&#x5206;&#x7C7B;&#x6807;&#x7B7E;</span><br><span class="line">---</span><br><span class="line">&#x3000;&#x3000;&#x8FD9;&#x91CC;&#x5199;&#x6B63;&#x6587;&#xFF08;&#x4E0A;&#x9762;&#x7684;---&#x662F;&#x5FC5;&#x8981;&#x7684;&#xFF09;</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x672C;&#x5730;&#x67E5;&#x770B;&#x6548;&#x679C;&#x9884;&#x89C8;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo s</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x6D4F;&#x89C8;&#x5668;&#x6253;&#x5F00;<a href="https://localhost:4000" target="_blank" rel="external">https://localhost:4000</a> &#x5373;&#x53EF;&#x67E5;&#x770B;&#x6548;&#x679C;<br>&#x3000;&#x3000;&#x53D1;&#x5E03;&#x5230; github&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo clean &amp;&amp; hexo g &amp;&amp; hexo d //&#x53D1;&#x5E03;&#x5230; github</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x53D1;&#x5E03;&#x5230; github &#x540E;&#x53EF;&#x4EE5;&#x4F7F;&#x7528; <a href="http://nanshanyi.github.io">http://nanshanyi.github.io</a> &#x8BBF;&#x95EE;&#xFF08;&#x8BF7;&#x4F7F;&#x7528;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x7F51;&#x5740;&#xFF09;</p>
<h4 id="&#x535A;&#x5BA2;&#x4E2D;&#x63D2;&#x5165;&#x56FE;&#x7247;-&#x97F3;&#x4E50;"><a href="#&#x535A;&#x5BA2;&#x4E2D;&#x63D2;&#x5165;&#x56FE;&#x7247;-&#x97F3;&#x4E50;" class="headerlink" title="&#x535A;&#x5BA2;&#x4E2D;&#x63D2;&#x5165;&#x56FE;&#x7247;,&#x97F3;&#x4E50;"></a>&#x535A;&#x5BA2;&#x4E2D;&#x63D2;&#x5165;&#x56FE;&#x7247;,&#x97F3;&#x4E50;</h4><p>&#x3000;&#x3000;&#x57FA;&#x672C;&#x5206;&#x4E3A;&#x4E24;&#x79CD;&#x529E;&#x6CD5;<br>&#xFF08;1&#xFF09;&#x653E;&#x5728;&#x672C;&#x5730;&#x6587;&#x4EF6;<br>&#x9996;&#x5148;&#x5728;nanshanyi.github.io&#x76EE;&#x5F55;&#x4E0B;&#x786E;&#x8BA4;_config.yml &#x4E2D;&#x6709; post_asset_folder:true &#x3002;<br> &#x5728; hexo &#x76EE;&#x5F55;&#xFF0C;&#x6267;&#x884C;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install https://github.com/CodeFalling/hexo-asset-image --save</span><br></pre></td></tr></table></figure>
<p>&#x3000;&#x3000;&#x4E4B;&#x540E;&#x518D;&#x4F7F;&#x7528; hexo new &#x2018;new&#x2019;&#x521B;&#x5EFA;&#x65B0;&#x535A;&#x5BA2;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x5728;source/_posts&#x91CC;&#x9762;&#x521B;&#x5EFA;.md&#x6587;&#x4EF6;&#x7684;&#x540C;&#x65F6;&#x751F;&#x6210;&#x4E00;&#x4E2A;&#x76F8;&#x540C;&#x7684;&#x540D;&#x5B57;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x3002;<br>&#x628A;&#x8BE5;&#x6587;&#x7AE0;&#x4E2D;&#x9700;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x56FE;&#x7247;&#x653E;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x5373;&#x53EF;&#x3002;<br>&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">![&#x201C;&#x56FE;&#x7247;&#x63CF;&#x8FF0;&#x201D;&#xFF08;&#x53EF;&#x4EE5;&#x4E0D;&#x5199;&#xFF09;](/&#x6587;&#x4EF6;&#x5939;&#x540D;/&#x4F60;&#x7684;&#x56FE;&#x7247;&#x540D;&#x5B57;.JPG)</span><br><span class="line">&#x4F8B;&#x5982;&#xFF1A;</span><br><span class="line">&#xFF01;[ ] (new/text.jpg)</span><br></pre></td></tr></table></figure></p>
<p>  &#xFF08;2&#xFF09;&#x653E;&#x5728;<a href="https://portal.qiniu.com/signup?code=3lglas6pgi2qa" target="_blank" rel="external">&#x4E03;&#x725B;</a>&#x4E0A;&#xFF0C;&#x9700;&#x8981;&#x5148;&#x6CE8;&#x518C;&#xFF0C;&#x4E0A;&#x4F20;&#x56FE;&#x7247;&#x751F;&#x6210;&#x94FE;&#x63A5;&#xFF0C;&#x76F4;&#x63A5;&#x5728;&#x6587;&#x7AE0;&#x4E2D;&#x4F7F;&#x7528;&#x94FE;&#x63A5;&#x5373;&#x53EF;&#x3002;<br>  &#xFF08;3&#xFF09;&#x63D2;&#x5165;&#x97F3;&#x4E50;<br>&#x3000;&#x3000;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7F51;&#x6613;&#x4E91;&#x97F3;&#x4E50;&#xFF0C;&#x641C;&#x7D22;&#x60F3;&#x8981;&#x7684;&#x6B4C;&#x66F2;&#xFF0C;&#x70B9;&#x51FB;&#x6B4C;&#x66F2;&#x540D;&#x5B57;&#x8FDB;&#x5165;&#x64AD;&#x653E;&#x5668;&#x9875;&#x9762;&#xFF0C;&#x70B9;&#x51FB;&#x751F;&#x6210;&#x5916;&#x94FE;&#x64AD;&#x653E;&#x5668;&#xFF1B;&#x590D;&#x5236;&#x4EE3;&#x7801;&#xFF0C;&#x76F4;&#x63A5;&#x7C98;&#x8D34;&#x5230;&#x535A;&#x6587;&#x4E2D;&#x5373;&#x53EF;&#x3002;&#x8FD9;&#x6837;&#x4F1A;&#x663E;&#x793A;&#x4E00;&#x4E2A;&#x7F51;&#x6613;&#x7684;&#x64AD;&#x653E;&#x5668;&#xFF0C;&#x53EF;&#x4EE5;&#x628A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=298 height=52 src=&quot;http://music.163.com/outchain/player?type=2&amp;id=32192436&amp;auto=1&amp;height=32&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">//&#x5176;&#x4E2D;&#x7684;width=298 height=52 &#x5747;&#x6539;&#x4E3A;0&#x5C31;&#x770B;&#x4E0D;&#x5230;&#x4E86;&#xFF0C;&#x4F9D;&#x7136;&#x53EF;&#x4EE5;&#x64AD;&#x653E;&#x97F3;&#x4E50;</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/966908-656c1aff502007d5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0B;&#x5348;2.01.52.png"><br><img src="http://upload-images.jianshu.io/upload_images/966908-ec51c5639bc1a023.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0B;&#x5348;1.56.58.png"></p>
<h3 id="&#x96C6;&#x6210;&#x591A;&#x8BF4;&#x8BC4;&#x8BBA;&#xFF0C;&#x5206;&#x4EAB;"><a href="#&#x96C6;&#x6210;&#x591A;&#x8BF4;&#x8BC4;&#x8BBA;&#xFF0C;&#x5206;&#x4EAB;" class="headerlink" title="&#x96C6;&#x6210;&#x591A;&#x8BF4;&#x8BC4;&#x8BBA;&#xFF0C;&#x5206;&#x4EAB;"></a>&#x96C6;&#x6210;&#x591A;&#x8BF4;&#x8BC4;&#x8BBA;&#xFF0C;&#x5206;&#x4EAB;</h3><p>&#x3000;&#x3000;&#x7533;&#x8BF7;<a href="http://duoshuo.com/" target="_blank" rel="external">&#x591A;&#x8BF4;</a>&#x5E10;&#x53F7;,&#x6253;&#x5F00;&#x9875;&#x9762;&#x70B9;&#x51FB;&#x6211;&#x8981;&#x5B89;&#x88C5;&#x6CE8;&#x518C;&#x5E10;&#x53F7;<br><img src="http://upload-images.jianshu.io/upload_images/966908-ed14c379d74f2b7e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0A;&#x5348;10.38.15.png"></p>
<p>&#x3000;&#x3000;&#x5728;themes/next&#x76EE;&#x5F55;&#x4E0B;&#x6253;&#x5F00; _config.yml&#xFF0C;&#x8BBE;&#x7F6E;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">duoshuo_shortname:  nanshanyi //&#x4E0A;&#x9762;&#x591A;&#x8BF4;&#x57DF;&#x540D;&#x4E2D;&#x586B;&#x7684;&#x5185;&#x5BB9;</span><br><span class="line">&#x9700;&#x8981;&#x5206;&#x4EAB;&#x7684;&#x6253;&#x5F00;duoshuo_share: true &#x5373;&#x53EF;&#xFF0C;&#x652F;&#x6301;&#x5206;&#x4EAB;&#x5230;&#x5FAE;&#x535A;&#x3001;QQ&#x7A7A;&#x95F4;&#x3001;&#x5FAE;&#x4FE1;</span><br></pre></td></tr></table></figure></p>
<p>&#x7136;&#x540E;&#x6253;&#x5F00;themes\landscape\layout_partial\article.ejs&#x6587;&#x4EF6;<br>&#x628A;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (!index &amp;&amp; post.comments &amp;&amp; config.disqus_shortname){ %&gt;</span><br><span class="line">&lt;section id=&quot;comments&quot;&gt;</span><br><span class="line">  &lt;div id=&quot;disqus_thread&quot;&gt;</span><br><span class="line">    &lt;noscript&gt;Please enable JavaScript to view the &lt;a href=&quot;//disqus.com/?ref_noscript&quot;&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/section&gt;</span><br><span class="line">&lt;% } %&gt;</span><br></pre></td></tr></table></figure></p>
<p>&#x66FF;&#x6362;&#x4E3A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;% if (!index &amp;&amp; post.comments &amp;&amp; config.duoshuo_shortname){ %&gt;</span><br><span class="line">  &lt;section id=&quot;comments&quot;&gt;</span><br><span class="line">    &lt;!-- &#x591A;&#x8BF4;&#x8BC4;&#x8BBA;&#x6846; start --&gt;</span><br><span class="line">    &lt;div class=&quot;ds-thread&quot; data-thread-key=&quot;&lt;%= post.layout %&gt;-&lt;%= post.slug %&gt;&quot; data-title=&quot;&lt;%= post.title %&gt;&quot; data-url=&quot;&lt;%= page.permalink %&gt;&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;!-- &#x591A;&#x8BF4;&#x8BC4;&#x8BBA;&#x6846; end --&gt;</span><br><span class="line">    &lt;!-- &#x591A;&#x8BF4;&#x516C;&#x5171;JS&#x4EE3;&#x7801; start (&#x4E00;&#x4E2A;&#x7F51;&#x9875;&#x53EA;&#x9700;&#x63D2;&#x5165;&#x4E00;&#x6B21;) --&gt;</span><br><span class="line">    &lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">    var duoshuoQuery = {short_name:&apos;&lt;%= config.duoshuo_shortname %&gt;&apos;};</span><br><span class="line">      (function() {</span><br><span class="line">        var ds = document.createElement(&apos;script&apos;);</span><br><span class="line">        ds.type = &apos;text/javascript&apos;;ds.async = true;</span><br><span class="line">        ds.src = (document.location.protocol == &apos;https:&apos; ? &apos;https:&apos; : &apos;http:&apos;) + &apos;//static.duoshuo.com/embed.js&apos;;</span><br><span class="line">        ds.charset = &apos;UTF-8&apos;;</span><br><span class="line">        (document.getElementsByTagName(&apos;head&apos;)[0]</span><br><span class="line">         || document.getElementsByTagName(&apos;body&apos;)[0]).appendChild(ds);</span><br><span class="line">      })();</span><br><span class="line">      &lt;/script&gt;</span><br><span class="line">    &lt;!-- &#x591A;&#x8BF4;&#x516C;&#x5171;JS&#x4EE3;&#x7801; end --&gt;</span><br><span class="line">  &lt;/section&gt;</span><br><span class="line">  &lt;% } %&gt;</span><br></pre></td></tr></table></figure></p>
<p>&#x7136;&#x540E;&#x4F60;hexo s ,&#x6253;&#x5F00;<a href="http://localhost:4000/" target="_blank" rel="external">http://localhost:4000/</a> &#x6253;&#x5F00;&#x6587;&#x7AE0;&#x770B;&#x4E00;&#x4E0B;&#xFF0C;&#x8BC4;&#x8BBA;&#x548C;&#x5206;&#x4EAB;&#x5DF2;&#x7ECF;&#x9759;&#x9759;&#x7684;&#x8EBA;&#x5728;&#x90A3;&#x4E86;<br><img src="http://upload-images.jianshu.io/upload_images/966908-8a2b28fd906fae93.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0B;&#x5348;3.36.43.png"></p>
<h3 id="&#x6DFB;&#x52A0;&#x6807;&#x7B7E;&#x9875;"><a href="#&#x6DFB;&#x52A0;&#x6807;&#x7B7E;&#x9875;" class="headerlink" title="&#x6DFB;&#x52A0;&#x6807;&#x7B7E;&#x9875;"></a>&#x6DFB;&#x52A0;&#x6807;&#x7B7E;&#x9875;</h3><p>&#x3000;&#x3000;&#x5728;nanshanyi.github.io&#x6587;&#x4EF6;&#x76EE;&#x5F55;&#x4E0B;&#x6267;&#x884C;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new page tags //&#x4F1A;&#x5728;nanshanyi.github.io/source&#x4E0B;&#x521B;&#x5EFA;tags&#x6587;&#x4EF6;&#x5939;&#x5185;&#x90E8;&#x662F;&#x4E00;&#x4E2A;index.md&#x548C;index&#x6587;&#x4EF6;&#x5939;</span><br></pre></td></tr></table></figure></p>
<p>&#x4FEE;&#x6539;nanshanyi.github.io/themes/next/_config.yml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: /      //&#x4E3B;&#x9875;</span><br><span class="line">  #categories: /categories //&#x5206;&#x7C7B;</span><br><span class="line">  archives: /archives   //&#x5F52;&#x6863;</span><br><span class="line">  tags: /tags   //&#x6807;&#x7B7E;&#xFF08;&#x6DFB;&#x52A0;&#x6B64;&#x884C;&#x5373;&#x53EF;&#xFF09;</span><br><span class="line">  about: /about   //&#x5173;&#x4E8E;</span><br><span class="line">  #commonweal: /404.html</span><br></pre></td></tr></table></figure></p>
<p>&#x9996;&#x9875;&#x83DC;&#x5355;&#x5C31;&#x4F1A;&#x6709;&#x4FBF;&#x7B7E;&#x9879;&#xFF0C;&#x70B9;&#x51FB;&#x5373;&#x53EF;&#x8FDB;&#x5165;&#x6807;&#x7B7E;&#x9875;&#x3002;</p>
<h3 id="&#x6DFB;&#x52A0;&#x641C;&#x7D22;&#x529F;&#x80FD;"><a href="#&#x6DFB;&#x52A0;&#x641C;&#x7D22;&#x529F;&#x80FD;" class="headerlink" title="&#x6DFB;&#x52A0;&#x641C;&#x7D22;&#x529F;&#x80FD;"></a>&#x6DFB;&#x52A0;&#x641C;&#x7D22;&#x529F;&#x80FD;</h3><p>&#x3000;&#x3000;next&#x652F;&#x6301;Swiftype &#x3001;&#x5FAE;&#x641C;&#x7D22;&#x548C;Local Search<br>&#x3000;&#x3000;&#xFF08;1&#xFF09;Swiftype &#xFF08;&#x6536;&#x8D39;&#x7684;&#x6CA1;&#x6709;&#x514D;&#x8D39;&#x7248;&#xFF0C;&#x8FDB;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;15&#x5929;&#xFF09;&#x662F;&#x4E3A;&#x7F51;&#x7AD9;&#x548C;&#x79FB;&#x52A8;&#x5E94;&#x7528;&#x63D0;&#x4F9B;&#x5185;&#x90E8;&#x641C;&#x7D22;&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x70B9;&#x51FB;&#x8FDB;&#x5165;<a href="https://swiftype.com/users/sign_up" target="_blank" rel="external">Swiftype&#x6CE8;&#x518C;&#x9875;&#x9762;</a> &#xFF0C;&#x6CE8;&#x518C;&#x4E4B;&#x540E;&#x9700;&#x8981;&#x586B;&#x5199;&#x81EA;&#x5DF1;&#x7684;&#x535A;&#x5BA2;&#x7684;&#x7F51;&#x5740;<br>&#x7136;&#x540E;&#x9009;&#x62E9;<br><img src="http://upload-images.jianshu.io/upload_images/966908-7aed60a7543e2571.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0B;&#x5348;9.07.45.png"><br>&#x9009;&#x62E9; install Search<br><img src="http://upload-images.jianshu.io/upload_images/966908-8cfb4600366ab1c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0B;&#x5348;9.10.01.png"><br>&#x9014;&#x4E2D;&#x7684;&#x5373;&#x4E3A;swiftype_key<br>&#x4FEE;&#x6539;nanshanyi.github.io/themes/next/_config.yml&#x4E2D;&#x7684;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swiftype_key:&#x4E0A;&#x9762;&#x7EA2;&#x5708;&#x4E2D;&#x7684;&#x5185;&#x5BB9;</span><br></pre></td></tr></table></figure></p>
<p>&#x70B9;&#x51FB; resume Configuration &#x9009;&#x62E9; search field edit<br><img src="http://upload-images.jianshu.io/upload_images/966908-6673e77e95e084da.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0B;&#x5348;9.49.27.png"><br>save<br>&#x53D1;&#x5E03;&#x5373;&#x53EF;&#x770B;&#x5230;&#x6548;&#x679C;<br><img src="http://upload-images.jianshu.io/upload_images/966908-fd0c0885439ef44d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-05-10 &#x4E0B;&#x5348;9.54.34.png"><br>    &#xFF08;2&#xFF09;&#x6DFB;&#x52A0;&#x672C;&#x5730;&#x641C;&#x7D22;<br>&#x5B89;&#x88C5; hexo-generator-search&#xFF0C;&#x5728;nanshanyi.github.io&#x76EE;&#x5F55;&#x4E0B;&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#xFF1A;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-generator-search --save</span><br></pre></td></tr></table></figure></p>
<p>&#x5728;nanshanyi.github.io/themes/next/_config.yml&#x6DFB;&#x52A0;<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">search:</span><br><span class="line">      path: search.xml</span><br><span class="line">      field: post</span><br></pre></td></tr></table></figure></p>
<p>  &#x53D1;&#x5E03;&#x5373;&#x53EF;&#x770B;&#x5230;&#x6548;&#x679C;&#xFF0C;&#x548C;&#x4E0A;&#x9762;&#x7684; swiftType &#x6548;&#x679C;&#x5DEE;&#x4E0D;&#x591A;&#xFF0C;&#x5C31;&#x4E0D;&#x518D;&#x7C98;&#x56FE;&#x7247;&#x4E86;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOS JavaScriptCore实现OC与JS的交互]]></title>
      <url>http://nanshanyi.github.io/2016/05/22/jstooc/</url>
      <content type="html"><![CDATA[<p>  JS &#x4E0E; OC &#x7684;&#x4EA4;&#x4E92;&#x539F;&#x6765;&#x6CA1;&#x6709;&#x597D;&#x597D;&#x7814;&#x7A76;&#x8FC7;&#xFF0C;&#x7528;&#x7684;&#x90FD;&#x662F;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x62E6;&#x622A; Url &#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x901A;&#x8FC7;&#x5B9A;&#x4E49;&#x4E13;&#x7528;&#x7684; Url &#x6765;&#x62E6;&#x622A;&#x5173;&#x952E;&#x5B57;&#x6765;&#x8FDB;&#x884C;&#x7279;&#x5B9A;&#x5904;&#x7406;&#x3002;&#x4F46;&#x8FD9;&#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x7B80;&#x5355;&#x7684;&#x4F20;&#x503C;&#xFF0C;&#x8FDB;&#x884C;&#x4E00;&#x4E9B;&#x7B80;&#x5355;&#x7684;&#x4EA4;&#x4E92;&#x3002;&#x6D89;&#x53CA;&#x5230;&#xFF0C;JS &#x8C03;&#x7528; OC &#x65B9;&#x6CD5;&#x6216;&#x8005; OC &#x8C03;&#x7528; JS &#x65B9;&#x6CD5;&#xFF0C;&#x4E00;&#x4E9B;&#x6BD4;&#x8F83;&#x590D;&#x6742;&#x7684;&#x4EA4;&#x4E92;&#x903B;&#x8F91;&#x7684;&#x65F6;&#x5019;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5C31;&#x663E;&#x5F97;&#x529B;&#x4E0D;&#x4ECE;&#x5FC3;&#x4E86;&#x3002;&#x6EE1;&#x8DB3;&#x4E0D;&#x4E86;&#x6211;&#x4EEC;&#x7684;&#x9700;&#x6C42;&#x3002;&#x5F53;&#x7136;&#x4E5F;&#x6709;&#x6BD4;&#x8F83;&#x597D;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x5982;&#xFF1A;WebViewJavascriptBridge&#x3002;&#x4F46;&#x4E00;&#x822C;&#x7CFB;&#x7EDF;&#x7684;&#x65B9;&#x6CD5;&#x8DB3;&#x591F;&#x7528;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5C31;&#x6CA1;&#x5FC5;&#x8981;&#x4F7F;&#x7528;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x3002;&#x8FD9;&#x6837;&#x5373;&#x6709;&#x5229;&#x4E8E;&#x51CF;&#x5C0F;&#x5B89;&#x88C5;&#x5305;&#x4F53;&#x79EF;&#xFF0C;&#x53C8;&#x53EF;&#x4EE5;&#x51CF;&#x5C11;&#x7B2C;&#x4E09;&#x65B9;&#x7684;&#x4E0D;&#x7A33;&#x5B9A;&#x6027;&#x7B49;&#x56E0;&#x7D20;&#x7684;&#x5E72;&#x6270;</p>
<h3 id="&#x62E6;&#x622A;url&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FDB;&#x884C;&#x7B80;&#x5355;&#x4EA4;&#x4E92;"><a href="#&#x62E6;&#x622A;url&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FDB;&#x884C;&#x7B80;&#x5355;&#x4EA4;&#x4E92;" class="headerlink" title="&#x62E6;&#x622A;url&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FDB;&#x884C;&#x7B80;&#x5355;&#x4EA4;&#x4E92;"></a>&#x62E6;&#x622A;url&#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x8FDB;&#x884C;&#x7B80;&#x5355;&#x4EA4;&#x4E92;</h3><p>&#x3000;&#x3000;&#x5728;webView&#x7684;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#x4E2D;&#x5904;&#x7406;<br>&#x3000;&#x3000;&#x8FD9;&#x91CC;&#x7B80;&#x5355;&#x4ECB;&#x7ECD;&#x4E00;&#x4E0B; URL &#x91CC;&#x9762;&#x7684;&#x4E00;&#x4E9B;&#x5C5E;&#x6027;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *scheme = url.scheme;<span class="comment">//&#x534F;&#x8BAE;&#xFF1A;http</span></span><br><span class="line"><span class="built_in">NSString</span> *host = url.host;<span class="comment">//&#x4E3B;&#x673A;&#x540D;</span></span><br><span class="line"><span class="built_in">NSNumber</span> *port = url.port;<span class="comment">//&#x7AEF;&#x53E3;&#x53F7;</span></span><br><span class="line"><span class="built_in">NSString</span> *path = url.path;<span class="comment">//&#x4E00;&#x822C;&#x7528;&#x6765;&#x8868;&#x793A;&#x4E3B;&#x673A;&#x4E0A;&#x7684;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x6216;&#x6587;&#x4EF6;&#x5730;&#x5740;</span></span><br><span class="line"><span class="built_in">NSString</span> *query = url.query;<span class="comment">//&#x53C2;&#x6570;&#xFF0C;&#x53D1;&#x7ED9;&#x670D;&#x52A1;&#x5668;&#x7684;&#x53C2;&#x6570;</span></span><br></pre></td></tr></table></figure></p>
<a id="more"></a>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)webView:(<span class="built_in">UIWebView</span> *)webView shouldStartLoadWithRequest:(<span class="built_in">NSURLRequest</span> *)request navigationType:(<span class="built_in">UIWebViewNavigationType</span>)navigationType{</span><br><span class="line">    <span class="built_in">NSURL</span> *url = request.URL;</span><br><span class="line">    <span class="keyword">if</span> ([url.scheme isEqualToString:<span class="string">@&quot;nanshanyi&quot;</span>]) {</span><br><span class="line">        <span class="comment">//&#x5728;&#x8FD9;&#x91CC;&#x505A;JavaScript&#x8C03;&#x7528;Objective-C&#x7684;&#x4E8B;&#x3002;</span></span><br><span class="line">        <span class="comment">//&#x9700;&#x8981;&#x4F20;&#x7684;&#x503C;&#x653E;&#x5728;url&#x540E;&#x9762;&#x7684;&#x53C2;&#x6570;&#x91CC;&#x5982;&#xFF1A;Nanshanyi://www.php8080.com?{&quot;title&quot;:&quot;&#x6807;&#x9898;&quot;,&quot;id&quot;:&quot;123&quot;,&quot;des&quot;:&quot;&#x63CF;&#x8FF0;&#x5185;&#x5BB9;&quot;}</span></span><br><span class="line">        <span class="built_in">NSString</span> *dataJson = url.query;<span class="comment">//&#x62FF;&#x5230;&#x540E;&#x9762;&#x7684;json&#x5B57;&#x7B26;&#x4E32;</span></span><br><span class="line">       <span class="built_in">NSString</span> *str = [dataJson stringByReplacingPercentEscapesUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;%@&quot;</span>,str);</span><br><span class="line"><span class="comment">//&#x6267;&#x884C;&#x4E00;&#x6BB5;js&#x4EE3;&#x7801;&#xFF0C;&#x5F39;&#x51FA;&#x63D0;&#x793A;&#x6846;</span></span><br><span class="line">        [webView stringByEvaluatingJavaScriptFromString:<span class="string">@&quot;alert(&apos;seccess&apos;)&quot;</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="&#x4F7F;&#x7528;JavaScriptCore&#x5B9E;&#x73B0;&#x4EA4;&#x4E92;"><a href="#&#x4F7F;&#x7528;JavaScriptCore&#x5B9E;&#x73B0;&#x4EA4;&#x4E92;" class="headerlink" title="&#x4F7F;&#x7528;JavaScriptCore&#x5B9E;&#x73B0;&#x4EA4;&#x4E92;"></a>&#x4F7F;&#x7528;JavaScriptCore&#x5B9E;&#x73B0;&#x4EA4;&#x4E92;</h3><p>&#x3000;&#x3000;JavaScriptCore&#x662F;&#x5C01;&#x88C5;&#x4E86;JavaScript&#x548C;Objective-C&#x6865;&#x63A5;&#x7684;Objective-C API&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x8F83;&#x5C11;&#x7684;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;JavaScript&#x4E0E;Objective-C&#x7684;&#x76F8;&#x4E92;&#x8C03;&#x7528;&#x3002;<br>&#x3000;&#x3000;&#x5728;iOS7&#x4E4B;&#x524D;&#xFF0C;&#x53EA;&#x80FD;&#x901A;&#x8FC7;&#x5411;UIWebView&#x53D1;&#x9001;stringByEvaluatingJavaScriptFromString:&#x6D88;&#x606F;&#x6765;&#x6267;&#x884C;&#x4E00;&#x6BB5;JavaScript&#x7684;&#x811A;&#x672C;&#x3002;&#x800C;&#x4E14;&#x5982;&#x679C;&#x60F3;&#x7528;JavaScript&#x6765;&#x8C03;&#x7528;Objective-C&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x5FC5;&#x987B;&#x6253;&#x5F00;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;URL&#xFF08;&#x4F8B;&#x5982;&#xFF1A;Nanshanyi://&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x5728;UIWebView&#x7684;delegate&#x65B9;&#x6CD5;webView:shouldStartLoadWithRequest:navigationType&#x4E2D;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x3002;&#x4E5F;&#x5C31;&#x662F;&#x4E0A;&#x95EE;&#x4E2D;&#x63D0;&#x5230;&#x7684;&#x65B9;&#x6CD5;<br>JavaScriptCore&#x4E2D;&#x7C7B;&#x53CA;&#x534F;&#x8BAE;&#xFF1A;<br>&#x3000;&#x3000;JSContext&#xFF1A;&#x7ED9;JavaScript&#x63D0;&#x4F9B;&#x8FD0;&#x884C;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x73AF;&#x5883;<br>&#x3000;&#x3000;JSValue&#xFF1A;JavaScript&#x548C;Objective-C&#x6570;&#x636E;&#x548C;&#x65B9;&#x6CD5;&#x7684;&#x6865;&#x6881;<br>&#x3000;&#x3000; JSManagedValue&#xFF1A;&#x7BA1;&#x7406;&#x6570;&#x636E;&#x548C;&#x65B9;&#x6CD5;&#x7684;&#x7C7B;<br>&#x3000;&#x3000;JSVirtualMachine&#xFF1A;&#x5904;&#x7406;&#x7EBF;&#x7A0B;&#x76F8;&#x5173;&#xFF0C;&#x4F7F;&#x7528;&#x8F83;&#x5C11;<br>&#x3000;&#x3000;JSExport&#xFF1A;&#x8FD9;&#x662F;&#x4E00;&#x4E2A;&#x534F;&#x8BAE;&#xFF0C;&#x5982;&#x679C;&#x91C7;&#x7528;&#x534F;&#x8BAE;&#x7684;&#x65B9;&#x6CD5;&#x4EA4;&#x4E92;&#xFF0C;&#x81EA;&#x5DF1;&#x5B9A;&#x4E49;&#x7684;&#x534F;&#x8BAE;&#x5FC5;&#x987B;&#x9075;&#x5B88;&#x6B64;&#x534F;&#x8BAE;</p>
<h4 id="&#x4F7F;&#x7528;Delegate&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;"><a href="#&#x4F7F;&#x7528;Delegate&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;" class="headerlink" title="&#x4F7F;&#x7528;Delegate&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;"></a>&#x4F7F;&#x7528;Delegate&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;</h4><p>&#x5148;&#x653E;&#x4E0A;js&#x7684;&#x7F51;&#x9875;&#x4EE3;&#x7801;&#xFF0C;&#x53EF;&#x4EE5;&#x5EFA;&#x4E00;&#x4E2A;HTML&#x6587;&#x4EF6;&#x76F4;&#x63A5;&#x590D;&#x5236;&#x8FDB;&#x53BB;&#x5373;&#x53EF;&#x4F7F;&#x7528;<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>OC&#x548C;JS&#x7684;&#x4EA4;&#x4E92;&#x4EE3;&#x7406;&#x65B9;&#x5F0F;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &#x751F;&#x6210;&#x4E00;&#x4E2A; button &#x6DFB;&#x52A0;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;JsToOcShare&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;callShare()&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span><br><span class="line">    function callShare() {</span><br><span class="line">        var shareContent = JSON.stringify({&quot;title&quot;: &quot;&#x5206;&#x4EAB;&quot;, &quot;desc&quot;: &quot;&#x5206;&#x4EAB;&#x5185;&#x5BB9;&quot;, &quot;shareUrl&quot;: &quot;http://www.jianshu.com/users/774b1d5616a7/latest_articles&quot;});</span><br><span class="line">        Nanshanyi.share(shareContent);</span><br><span class="line">    }</span><br><span class="line">    //   OC&#x8C03;JS</span><br><span class="line">    function showAlert(message){</span><br><span class="line">        alert(message);</span><br><span class="line">    }</span><br><span class="line">    //    JS&#x8C03;OC&#x6210;&#x529F;&#x540E;&#x56DE;&#x8C03;</span><br><span class="line">    var shareCallback = function(){</span><br><span class="line">        alert(&apos;success&apos;);</span><br><span class="line">    }</span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;JavaScriptCore/JavaScriptCore.h&gt;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">JSObjcDelegate</span> &lt;<span class="title">JSExport</span>&gt;</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)share:(<span class="built_in">NSString</span> *)shareContent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> : <span class="title">UIViewController</span>&lt;<span class="title">JSObjcDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>.m&#x6587;&#x4EF6;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&quot;ViewController.h&quot;</span></span></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ViewController</span> ()&lt;<span class="title">UIWebViewDelegate</span>&gt;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)<span class="built_in">UIWebView</span> *webView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>,<span class="keyword">strong</span>)JSContext *jsContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">ViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad {</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">    [<span class="keyword">self</span> CustomUI];</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)CustomUI{</span><br><span class="line">    <span class="keyword">self</span>.webView = [[<span class="built_in">UIWebView</span> alloc]initWithFrame:<span class="keyword">self</span>.view.bounds];</span><br><span class="line">    <span class="keyword">self</span>.webView.delegate = <span class="keyword">self</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view addSubview:_webView];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSURL</span> *url = [[<span class="built_in">NSBundle</span> mainBundle] URLForResource:<span class="string">@&quot;untitled3&quot;</span> withExtension:<span class="string">@&quot;html&quot;</span>];</span><br><span class="line">    [<span class="keyword">self</span>.webView loadRequest:[<span class="built_in">NSURLRequest</span> requestWithURL:url]];</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)webViewDidFinishLoad:(<span class="built_in">UIWebView</span> *)webView{</span><br><span class="line">    _jsContext = [webView valueForKeyPath:<span class="string">@&quot;documentView.webView.mainFrame.javaScriptContext&quot;</span>];</span><br><span class="line">    <span class="comment">//&#x4EE3;&#x7406;&#x65B9;&#x5F0F;JS&#x8C03;OC&#x65B9;&#x6CD5;</span></span><br><span class="line">    <span class="comment">//Nanshanyi &#x76F8;&#x5F53;&#x4E8E;&#x6865;&#x63A5;&#xFF0C;&#x901A;&#x8FC7;&#x5B83;&#x5C06; OC &#x4E0E; JS &#x8054;&#x7CFB;&#x8D77;&#x6765;</span></span><br><span class="line">    _jsContext[<span class="string">@&quot;Nanshanyi&quot;</span>] = <span class="keyword">self</span>;</span><br><span class="line">    _jsContext.exceptionHandler = ^(JSContext *context, JSValue *exceptionValue) {</span><br><span class="line">        context.exception = exceptionValue;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#xFF1A;%@&quot;</span>, exceptionValue);</span><br><span class="line">    };</span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)share:(<span class="built_in">NSString</span> *)shareContent {</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;share:%@&quot;</span>, shareContent);</span><br><span class="line">    <span class="comment">// &#x5206;&#x4EAB;&#x6210;&#x529F;&#x540E;,&#x56DE;&#x8C03;js&#x7684;&#x65B9;&#x6CD5;shareCallback</span></span><br><span class="line"><span class="comment">//    &#x4E5F;&#x5373;&#x662F; OC &#x8C03;&#x7528; JS &#x65B9;&#x6CD5;,&#x53EA;&#x8C03;&#x7528;&#x65B9;&#x6CD5;&#xFF0C;&#x6CA1;&#x6709;&#x53C2;&#x6570;&#x4F20;&#x9012;</span></span><br><span class="line">    JSValue *shareCallback = <span class="keyword">self</span>.jsContext[<span class="string">@&quot;shareCallback&quot;</span>];</span><br><span class="line">    [shareCallback callWithArguments:<span class="literal">nil</span>];</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x4F7F;&#x7528;Block&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;"><a href="#&#x4F7F;&#x7528;Block&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;" class="headerlink" title="&#x4F7F;&#x7528;Block&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;"></a>&#x4F7F;&#x7528;Block&#x65B9;&#x5F0F;&#x5B9E;&#x73B0;</h4><p>&#x540C;&#x6837;&#x653E;&#x4E0A;&#x4E00;&#x6BB5;&#x7B80;&#x5355;&#x7684;JS<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>OC&#x548C;JS&#x7684;&#x4EA4;&#x4E92;Block&#x65B9;&#x5F0F;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">value</span>=<span class="string">&quot;JsToOcShare&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;callShare(shareContent)&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span><br><span class="line">    var shareContent = JSON.stringify({&quot;title&quot;:&quot;&#x5206;&#x4EAB;&quot;, &quot;desc&quot;:&quot;&#x5206;&#x4EAB;&#x5185;&#x5BB9;&quot;, &quot;shareUrl&quot;:&quot;http://www.jianshu.com/users/774b1d5616a7/latest_articles&quot;});</span><br><span class="line"></span><br><span class="line">    function callShare(share) {</span><br><span class="line">    //share&#x4E3A;&#x5F62;&#x53C2;&#xFF0C;shareContent&#x4E3A;&#x5B9E;&#x53C2;&#xFF0C;&#x5373;&#x8981;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;</span><br><span class="line">    }</span><br><span class="line">    //  OC&#x8C03;JS message&#x4E3A;&#x4F20;&#x9012;&#x7684;&#x53C2;&#x6570;</span><br><span class="line">    function showAlert(message){</span><br><span class="line">        alert(message);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>WebView&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#x7684;&#x5B9E;&#x73B0;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)showAlert{<span class="comment">//&#x76F4;&#x63A5;&#x8C03;&#x7528;&#x8BE5;&#x65B9;&#x6CD5;&#x5B9E;&#x73B0;OC&#x8C03;&#x7528;JS&#xFF0C;&#x5E76;&#x4F20;&#x53C2;</span></span><br><span class="line">    <span class="built_in">NSString</span> *jsStr = <span class="string">@&quot;showAlert(&apos;ios js&#x4EA4;&#x4E92;&#x6210;&#x529F;,&#x6211;&#x662F;&#x7F51;&#x9875; alert&apos;)&quot;</span>;</span><br><span class="line">    [_jsContext evaluateScript:jsStr];</span><br><span class="line">}</span><br><span class="line">- (<span class="keyword">void</span>)webViewDidFinishLoad:(<span class="built_in">UIWebView</span> *)webView{</span><br><span class="line">    _jsContext = [webView valueForKeyPath:<span class="string">@&quot;documentView.webView.mainFrame.javaScriptContext&quot;</span>];</span><br><span class="line">    <span class="comment">//block &#x65B9;&#x5F0F; JS&#x76F4;&#x63A5;&#x8C03;&#x7528;OC&#xFF0C;&#x5E76;&#x4F20;&#x53C2;&#xFF0C;&#x7B80;&#x5355;&#x660E;&#x4E86;</span></span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">typeof</span>  (<span class="keyword">self</span>)weakSelf = <span class="keyword">self</span>;</span><br><span class="line">        _jsContext[<span class="string">@&quot;callShare&quot;</span>] =^(<span class="keyword">id</span> obj){</span><br><span class="line">            weakSelf.lable.text = obj;</span><br><span class="line">    <span class="comment">//&#x628A;&#x4F20;&#x8FC7;&#x6765;&#x7684;Json&#x5B57;&#x7B26;&#x4E32;&#xFF0C;&#x8F6C;&#x4E3A;&#x5B57;&#x5178;</span></span><br><span class="line">            <span class="built_in">NSData</span> *data = [(<span class="built_in">NSString</span> *)obj dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span> ];</span><br><span class="line">            <span class="built_in">NSDictionary</span> *dict = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="built_in">NSJSONReadingMutableContainers</span> error:<span class="literal">nil</span>];</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;%@&quot;</span>,dict);</span><br><span class="line"></span><br><span class="line">        };</span><br><span class="line">    _jsContext.exceptionHandler = ^(JSContext *context, JSValue *exceptionValue) {</span><br><span class="line">        context.exception = exceptionValue;</span><br><span class="line">  <span class="comment">//&#x6BD4;&#x5982;&#x628A;js&#x4E2D;&#x7684;&#x65B9;&#x6CD5;&#x540D;&#x6539;&#x6389;&#xFF0C;OC&#x627E;&#x4E0D;&#x5230;&#x76F8;&#x5E94;&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x91CC;&#x5C31;&#x4F1A;&#x6253;&#x5370;&#x5F02;&#x5E38;&#x4FE1;&#x606F;</span></span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;&#x5F02;&#x5E38;&#x4FE1;&#x606F;&#xFF1A;%@&quot;</span>, exceptionValue);</span><br><span class="line">    };</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x81F3;&#x6B64;&#xFF0C;&#x5DF2;&#x7ECF;&#x5B8C;&#x6210;&#x4E86;JS&#x4E0E;OC&#x7684;&#x7B80;&#x5355;&#x4EA4;&#x4E92;&#xFF0C;&#x5B9E;&#x73B0;&#x4E86;JS&#x4E0E;OC&#x65B9;&#x6CD5;&#x7684;&#x76F8;&#x4E92;&#x8C03;&#x7528;&#xFF0C;&#x4E0E;&#x4F20;&#x503C;&#x3002;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x5BF9;&#x7684;&#x8BF7;&#x6279;&#x8BC4;&#x6307;&#x6B63;&#xFF0C;&#x4E92;&#x76F8;&#x5B66;&#x4E60;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[iOS原生方法实现二维码生成与扫描]]></title>
      <url>http://nanshanyi.github.io/2016/05/10/qrcode/</url>
      <content type="html"><![CDATA[<p>&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x751F;&#x6210;&#x6709;&#x597D;&#x591A;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#xFF0C;&#x5982;Z-Xing&#x3002;&#x4F46;&#x662F;&#x4E3A;&#x4E86;&#x63A7;&#x5236;&#x5B89;&#x88C5;&#x5305;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x6216;&#x8005;&#x5E76;&#x4E0D;&#x9700;&#x8981;&#x5176;&#x4ED6;&#x7684;&#x4E00;&#x4E9B;&#x989D;&#x5916;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x7528;&#x7CFB;&#x7EDF;&#x7684;&#x65B9;&#x6CD5;&#x5373;&#x53EF;&#x6EE1;&#x8DB3;.</p>
<h3 id="&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x751F;&#x6210;"><a href="#&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x751F;&#x6210;" class="headerlink" title="&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x751F;&#x6210;"></a>&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x751F;&#x6210;</h3><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIImage</span> *)createNonInterpolated<span class="built_in">UIImageFormCIImage</span>:(<span class="built_in">CIImage</span> *)image withSize:(<span class="built_in">CGFloat</span>) size waterImageSize:(<span class="built_in">CGFloat</span>)waterImagesize{</span><br><span class="line">    <span class="built_in">CGRect</span> extent = <span class="built_in">CGRectIntegral</span>(image.extent);</span><br><span class="line">    <span class="built_in">CGFloat</span> scale = MIN(size/<span class="built_in">CGRectGetWidth</span>(extent), size/<span class="built_in">CGRectGetHeight</span>(extent));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 1.&#x521B;&#x5EFA;bitmap;</span></span><br><span class="line">    size_t width = <span class="built_in">CGRectGetWidth</span>(extent) * scale;</span><br><span class="line">    size_t height = <span class="built_in">CGRectGetHeight</span>(extent) * scale;</span><br><span class="line">    <span class="comment">//&#x521B;&#x5EFA;&#x4E00;&#x4E2A;DeviceGray&#x989C;&#x8272;&#x7A7A;&#x95F4;</span></span><br><span class="line">    <span class="built_in">CGColorSpaceRef</span> cs = <span class="built_in">CGColorSpaceCreateDeviceGray</span>();</span><br><span class="line">    <span class="comment">//CGBitmapContextCreate(void * _Nullable data, size_t width, size_t height, size_t bitsPerComponent, size_t bytesPerRow, CGColorSpaceRef  _Nullable space, uint32_t bitmapInfo)</span></span><br><span class="line">    <span class="comment">//width&#xFF1A;&#x56FE;&#x7247;&#x5BBD;&#x5EA6;&#x50CF;&#x7D20;</span></span><br><span class="line">    <span class="comment">//height&#xFF1A;&#x56FE;&#x7247;&#x9AD8;&#x5EA6;&#x50CF;&#x7D20;</span></span><br><span class="line">    <span class="comment">//bitsPerComponent&#xFF1A;&#x6BCF;&#x4E2A;&#x989C;&#x8272;&#x7684;&#x6BD4;&#x7279;&#x503C;&#xFF0C;&#x4F8B;&#x5982;&#x5728;rgba-32&#x6A21;&#x5F0F;&#x4E0B;&#x4E3A;8</span></span><br><span class="line">    <span class="comment">//bitmapInfo&#xFF1A;&#x6307;&#x5B9A;&#x7684;&#x4F4D;&#x56FE;&#x5E94;&#x8BE5;&#x5305;&#x542B;&#x4E00;&#x4E2A;alpha&#x901A;&#x9053;&#x3002;</span></span><br><span class="line">    <span class="built_in">CGContextRef</span> bitmapRef = <span class="built_in">CGBitmapContextCreate</span>(<span class="literal">nil</span>, width, height, <span class="number">8</span>, <span class="number">0</span>, cs, (<span class="built_in">CGBitmapInfo</span>)k<span class="built_in">CGImageAlphaNone</span>);</span><br><span class="line">    <span class="built_in">CIContext</span> *context = [<span class="built_in">CIContext</span> contextWithOptions:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">//&#x521B;&#x5EFA;CoreGraphics image</span></span><br><span class="line">    <span class="built_in">CGImageRef</span> bitmapImage = [context create<span class="built_in">CGImage</span>:image fromRect:extent];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGContextSetInterpolationQuality</span>(bitmapRef, k<span class="built_in">CGInterpolationNone</span>);</span><br><span class="line">    <span class="built_in">CGContextScaleCTM</span>(bitmapRef, scale, scale);</span><br><span class="line">    <span class="built_in">CGContextDrawImage</span>(bitmapRef, extent, bitmapImage);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 2.&#x4FDD;&#x5B58;bitmap&#x5230;&#x56FE;&#x7247;</span></span><br><span class="line">    <span class="built_in">CGImageRef</span> scaledImage = <span class="built_in">CGBitmapContextCreateImage</span>(bitmapRef);</span><br><span class="line">    <span class="built_in">CGContextRelease</span>(bitmapRef); <span class="built_in">CGImageRelease</span>(bitmapImage);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x539F;&#x56FE;</span></span><br><span class="line">    <span class="built_in">UIImage</span> *outputImage = [<span class="built_in">UIImage</span> imageWith<span class="built_in">CGImage</span>:scaledImage];</span><br><span class="line">    <span class="comment">//&#x7ED9;&#x4E8C;&#x7EF4;&#x7801;&#x52A0; logo &#x56FE;</span></span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(outputImage.size, <span class="literal">NO</span>, [[<span class="built_in">UIScreen</span> mainScreen] scale]);</span><br><span class="line">    [outputImage drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>,<span class="number">0</span> , size, size)];</span><br><span class="line">    <span class="comment">//logo&#x56FE;</span></span><br><span class="line">    <span class="built_in">UIImage</span> *waterimage = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@&quot;icon_imgApp&quot;</span>];</span><br><span class="line">    <span class="comment">//&#x628A;logo&#x56FE;&#x753B;&#x5230;&#x751F;&#x6210;&#x7684;&#x4E8C;&#x7EF4;&#x7801;&#x56FE;&#x7247;&#x4E0A;&#xFF0C;&#x6CE8;&#x610F;&#x5C3A;&#x5BF8;&#x4E0D;&#x8981;&#x592A;&#x5927;&#xFF08;&#x6700;&#x5927;&#x4E0D;&#x8D85;&#x8FC7;&#x4E8C;&#x7EF4;&#x7801;&#x56FE;&#x7247;&#x7684;%30&#xFF09;&#xFF0C;&#x592A;&#x5927;&#x4F1A;&#x9020;&#x6210;&#x626B;&#x4E0D;&#x51FA;&#x6765;</span></span><br><span class="line">    [waterimage drawInRect:<span class="built_in">CGRectMake</span>((size-waterImagesize)/<span class="number">2.0</span>, (size-waterImagesize)/<span class="number">2.0</span>, waterImagesize, waterImagesize)];</span><br><span class="line">    <span class="built_in">UIImage</span> *newPic = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    <span class="keyword">return</span> newPic;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h4 id="&#x8FD9;&#x4E2A;&#x662F;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x4E2D;&#x5BF9;inputMessage&#x548C;inputCorrectionLevel&#x7684;&#x89E3;&#x91CA;"><a href="#&#x8FD9;&#x4E2A;&#x662F;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x4E2D;&#x5BF9;inputMessage&#x548C;inputCorrectionLevel&#x7684;&#x89E3;&#x91CA;" class="headerlink" title="&#x8FD9;&#x4E2A;&#x662F;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x4E2D;&#x5BF9;inputMessage&#x548C;inputCorrectionLevel&#x7684;&#x89E3;&#x91CA;"></a>&#x8FD9;&#x4E2A;&#x662F;&#x5B98;&#x65B9;&#x6587;&#x6863;&#x4E2D;&#x5BF9;inputMessage&#x548C;inputCorrectionLevel&#x7684;&#x89E3;&#x91CA;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">  [<span class="built_in">CIQRCodeGenerator</span> ](https:<span class="comment">//developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CoreImageFilterReference/#//apple_ref/doc/filter/ci/CIQRCodeGenerator)</span></span><br><span class="line"></span><br><span class="line">Generates a Quick Response code (two-dimensional barcode) from input data.</span><br><span class="line">Parameters</span><br><span class="line">*inputMessage*</span><br><span class="line">The data to be encoded as a QR code. An<span class="built_in">NSData</span></span><br><span class="line">object whose display name is Message.</span><br><span class="line"></span><br><span class="line">*inputCorrectionLevel*</span><br><span class="line">A single letter specifying the error correction format. An<span class="built_in">NSString</span></span><br><span class="line">object whose display name is CorrectionLevel.</span><br><span class="line">Default value:M</span><br><span class="line"></span><br><span class="line">Discussion</span><br><span class="line">    Generates an output image representing the input data according to the ISO/IEC <span class="number">18004</span>:<span class="number">2006</span> standard. The width and height of each module (square dot) of the code <span class="keyword">in</span> the output image is one point. To create a QR code from a string or URL, convert it to an[<span class="built_in">NSData</span>](https:<span class="comment">//developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/index.html#//apple_ref/occ/cl/NSData)object using the[NSISOLatin1StringEncoding](https://developer.apple.com/library/ios/documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/index.html#//apple_ref/c/econst/NSISOLatin1StringEncoding)string encoding.</span></span><br><span class="line">The*inputCorrectionLevel*</span><br><span class="line">&#x3000;&#x3000;parameter controls the amount of additional data encoded <span class="keyword">in</span> the output image to provide error correction. Higher levels of error correction result <span class="keyword">in</span> larger output images but allow larger areas of the code to be damaged or obscured without. There are four possible correction modes (with corresponding error resilience levels):</span><br><span class="line">L&#x3000;: <span class="number">7</span>%</span><br><span class="line">M&#x3000;: <span class="number">15</span>%</span><br><span class="line">Q&#x3000;: <span class="number">25</span>%</span><br><span class="line">H&#x3000;: <span class="number">30</span>%</span><br><span class="line"></span><br><span class="line">Member Of</span><br><span class="line"><span class="built_in">CICategoryBuiltIn</span></span><br><span class="line">,<span class="built_in">CICategoryStillImage</span></span><br><span class="line">,<span class="built_in">CICategoryGenerator</span></span><br><span class="line">Sample Output</span><br><span class="line"> **Figure <span class="number">91</span>**The result of using the <span class="built_in">CIQRCodeGenerator</span> filter ![image: ../Art/<span class="built_in">CIQRCodeGenerator</span>.pdf](https:<span class="comment">//developer.apple.com/library/ios/documentation/GraphicsImaging/Reference/CoreImageFilterReference/Art/CIQRCodeGenerator_2x.png)</span></span><br></pre></td></tr></table></figure>
<p>&#x3000;&#x3000;&#x4FEE;&#x6539;&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x989C;&#x8272;,&#x8FD9;&#x4E00;&#x6BB5;&#x662F;&#x5728;&#x7F51;&#x4E0A;&#x627E;&#x7684;&#xFF0C;&#x628A;&#x751F;&#x6210;&#x7684;&#x4E8C;&#x7EF4;&#x7801;&#x56FE;&#x7247;&#x4F20;&#x5165;&#xFF0C;&#x518D;&#x4F20;&#x5165;&#x60F3;&#x8981;&#x7684;&#x989C;&#x8272;&#x5373;&#x53EF;<br>&#x3000;&#x3000;&#x56FE;&#x7247;&#x8981;&#x4F20;&#x6CA1;&#x6709;&#x52A0;&#x8FC7; logo &#x7684;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">UIImage</span>*)imageBlackToTransparent:(<span class="built_in">UIImage</span>*)image withRed:(<span class="built_in">CGFloat</span>)red andGreen:(<span class="built_in">CGFloat</span>)green andBlue:(<span class="built_in">CGFloat</span>)blue{</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> imageWidth = image.size.width;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> imageHeight = image.size.height;</span><br><span class="line">    size_t bytesPerRow = imageWidth * <span class="number">4</span>;</span><br><span class="line">    uint32_t* rgbImageBuf = (uint32_t*)malloc(bytesPerRow * imageHeight);</span><br><span class="line">    <span class="built_in">CGColorSpaceRef</span> colorSpace = <span class="built_in">CGColorSpaceCreateDeviceRGB</span>();</span><br><span class="line">    <span class="built_in">CGContextRef</span> context = <span class="built_in">CGBitmapContextCreate</span>(rgbImageBuf, imageWidth, imageHeight, <span class="number">8</span>, bytesPerRow, colorSpace, k<span class="built_in">CGBitmapByteOrder32Little</span> | k<span class="built_in">CGImageAlphaNoneSkipLast</span>);</span><br><span class="line">    <span class="built_in">CGContextDrawImage</span>(context, <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, imageWidth, imageHeight), image.CGImage); <span class="comment">// &#x904D;&#x5386;&#x50CF;&#x7D20;</span></span><br><span class="line">    <span class="keyword">int</span> pixelNum = imageWidth * imageHeight;</span><br><span class="line">    uint32_t* pCurPtr = rgbImageBuf;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; pixelNum; i++, pCurPtr++){</span><br><span class="line">        <span class="keyword">if</span> ((*pCurPtr &amp; <span class="number">0xFFFFFF00</span>) &lt; <span class="number">0x99999900</span>) <span class="comment">// &#x5C06;&#x767D;&#x8272;&#x53D8;&#x6210;&#x900F;&#x660E;</span></span><br><span class="line">    {</span><br><span class="line">        <span class="comment">// &#x6539;&#x6210;&#x4E0B;&#x9762;&#x7684;&#x4EE3;&#x7801;&#xFF0C;&#x4F1A;&#x5C06;&#x56FE;&#x7247;&#x8F6C;&#x6210;&#x60F3;&#x8981;&#x7684;&#x989C;&#x8272;</span></span><br><span class="line">        uint8_t* ptr = (uint8_t*)pCurPtr;</span><br><span class="line">        ptr[<span class="number">3</span>] = red; <span class="comment">//0~255</span></span><br><span class="line">        ptr[<span class="number">2</span>] = green;</span><br><span class="line">        ptr[<span class="number">1</span>] = blue;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        uint8_t* ptr = (uint8_t*)pCurPtr;</span><br><span class="line">        ptr[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// &#x8F93;&#x51FA;&#x56FE;&#x7247;</span></span><br><span class="line">    <span class="built_in">CGDataProviderRef</span> dataProvider = <span class="built_in">CGDataProviderCreateWithData</span>(<span class="literal">NULL</span>, rgbImageBuf, bytesPerRow * imageHeight, <span class="literal">nil</span>);</span><br><span class="line">    <span class="built_in">CGImageRef</span> imageRef = <span class="built_in">CGImageCreate</span>(imageWidth, imageHeight, <span class="number">8</span>, <span class="number">32</span>, bytesPerRow, colorSpace, k<span class="built_in">CGImageAlphaLast</span> | k<span class="built_in">CGBitmapByteOrder32Little</span>, dataProvider, <span class="literal">NULL</span>, <span class="literal">true</span>, k<span class="built_in">CGRenderingIntentDefault</span>);</span><br><span class="line">    <span class="built_in">CGDataProviderRelease</span>(dataProvider);</span><br><span class="line">    <span class="built_in">UIImage</span>* result<span class="built_in">UIImage</span> = [<span class="built_in">UIImage</span> imageWith<span class="built_in">CGImage</span>:imageRef]; <span class="comment">// &#x6E05;&#x7406;&#x7A7A;&#x95F4;</span></span><br><span class="line">    <span class="built_in">CGImageRelease</span>(imageRef);</span><br><span class="line">    <span class="built_in">CGContextRelease</span>(context);</span><br><span class="line">    <span class="built_in">CGColorSpaceRelease</span>(colorSpace);</span><br><span class="line">    <span class="keyword">return</span> result<span class="built_in">UIImage</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h3 id="&#x626B;&#x7801;"><a href="#&#x626B;&#x7801;" class="headerlink" title="&#x626B;&#x7801;"></a>&#x626B;&#x7801;</h3><p>&#x3000;&#x3000;&#x626B;&#x7801;&#x4E3B;&#x8981;&#x7528;&#x5230;&#x7684;&#x662F;AVFoundation&#x7528;&#x5230;&#x7684;&#x4E1C;&#x897F;&#x548C;&#x76F8;&#x673A;&#x57FA;&#x672C;&#x76F8;&#x540C;&#xFF0C;&#x76F8;&#x673A;&#x8BF7;&#x53C2;&#x8003;&#x6211;&#x7684;&#x53E6;&#x5916;&#x4E00;&#x7BC7;&#x6587;&#x7AE0;<br><img src="http://upload-images.jianshu.io/upload_images/966908-4540ac0268f17202.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="&#x5C4F;&#x5E55;&#x5FEB;&#x7167; 2016-04-11 &#x4E0A;&#x5348;11.46.38.png"></p>
<h4 id="&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;&#xFF0C;&#x9075;&#x5B88;AVCaptureMetadataOutputObjectsDelegate"><a href="#&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;&#xFF0C;&#x9075;&#x5B88;AVCaptureMetadataOutputObjectsDelegate" class="headerlink" title="&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;&#xFF0C;&#x9075;&#x5B88;AVCaptureMetadataOutputObjectsDelegate"></a>&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;&#xFF0C;&#x9075;&#x5B88;AVCaptureMetadataOutputObjectsDelegate</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ScanQRViewController</span> ()&lt;<span class="title">AVCaptureMetadataOutputObjectsDelegate</span>&gt;</span></span><br><span class="line"><span class="comment">//&#x6355;&#x83B7;&#x8BBE;&#x5907;&#xFF0C;&#x901A;&#x5E38;&#x662F;&#x524D;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#xFF0C;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#xFF0C;&#x9EA6;&#x514B;&#x98CE;&#xFF08;&#x97F3;&#x9891;&#x8F93;&#x5165;&#xFF09;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>)<span class="built_in">AVCaptureDevice</span> *device;</span><br><span class="line"></span><br><span class="line"><span class="comment">//AVCaptureDeviceInput &#x4EE3;&#x8868;&#x8F93;&#x5165;&#x8BBE;&#x5907;&#xFF0C;&#x4ED6;&#x4F7F;&#x7528;AVCaptureDevice &#x6765;&#x521D;&#x59CB;&#x5316;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>)<span class="built_in">AVCaptureDeviceInput</span> *input;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x8BBE;&#x7F6E;&#x8F93;&#x51FA;&#x7C7B;&#x578B;&#x4E3A;Metadata&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x79CD;&#x8F93;&#x51FA;&#x7C7B;&#x578B;&#x4E2D;&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x626B;&#x63CF;&#x7684;&#x7C7B;&#x578B;&#xFF0C;&#x8B6C;&#x5982;&#x4E8C;&#x7EF4;&#x7801;</span></span><br><span class="line"><span class="comment">//&#x5F53;&#x542F;&#x52A8;&#x6444;&#x50CF;&#x5934;&#x5F00;&#x59CB;&#x6355;&#x83B7;&#x8F93;&#x5165;&#x65F6;&#xFF0C;&#x5982;&#x679C;&#x8F93;&#x5165;&#x4E2D;&#x5305;&#x542B;&#x4E8C;&#x7EF4;&#x7801;&#xFF0C;&#x5C31;&#x4F1A;&#x4EA7;&#x751F;&#x8F93;&#x51FA;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>)<span class="built_in">AVCaptureMetadataOutput</span> *output;</span><br><span class="line"></span><br><span class="line"><span class="comment">//session&#xFF1A;&#x7531;&#x4ED6;&#x628A;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7ED3;&#x5408;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x5E76;&#x5F00;&#x59CB;&#x542F;&#x52A8;&#x6355;&#x83B7;&#x8BBE;&#x5907;&#xFF08;&#x6444;&#x50CF;&#x5934;&#xFF09;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>)<span class="built_in">AVCaptureSession</span> *session;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x56FE;&#x50CF;&#x9884;&#x89C8;&#x5C42;&#xFF0C;&#x5B9E;&#x65F6;&#x663E;&#x793A;&#x6355;&#x83B7;&#x7684;&#x56FE;&#x50CF;</span></span><br><span class="line"><span class="keyword">@property</span>(<span class="keyword">nonatomic</span>)<span class="built_in">AVCaptureVideoPreviewLayer</span> *previewLayer;</span><br></pre></td></tr></table></figure>
<h4 id="&#x521D;&#x59CB;&#x5316;&#x5404;&#x5BF9;&#x8C61;&#xFF0C;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x8BBE;&#x5907;&#x7ED3;&#x5408;"><a href="#&#x521D;&#x59CB;&#x5316;&#x5404;&#x5BF9;&#x8C61;&#xFF0C;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x8BBE;&#x5907;&#x7ED3;&#x5408;" class="headerlink" title="&#x521D;&#x59CB;&#x5316;&#x5404;&#x5BF9;&#x8C61;&#xFF0C;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x8BBE;&#x5907;&#x7ED3;&#x5408;"></a>&#x521D;&#x59CB;&#x5316;&#x5404;&#x5BF9;&#x8C61;&#xFF0C;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x8BBE;&#x5907;&#x7ED3;&#x5408;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)creatCaptureDevice{</span><br><span class="line">    <span class="comment">//&#x4F7F;&#x7528;AVMediaTypeVideo &#x6307;&#x660E;self.device&#x4EE3;&#x8868;&#x89C6;&#x9891;&#xFF0C;&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x8FDB;&#x884C;&#x521D;&#x59CB;&#x5316;</span></span><br><span class="line">    <span class="keyword">self</span>.device = [<span class="built_in">AVCaptureDevice</span> defaultDeviceWithMediaType:<span class="built_in">AVMediaTypeVideo</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x4F7F;&#x7528;&#x8BBE;&#x5907;&#x521D;&#x59CB;&#x5316;&#x8F93;&#x5165;</span></span><br><span class="line">    <span class="keyword">self</span>.input = [[<span class="built_in">AVCaptureDeviceInput</span> alloc]initWithDevice:<span class="keyword">self</span>.device error:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x751F;&#x6210;&#x8F93;&#x51FA;&#x5BF9;&#x8C61;</span></span><br><span class="line">    <span class="keyword">self</span>.output = [[<span class="built_in">AVCaptureMetadataOutput</span> alloc]init];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x8BBE;&#x7F6E;&#x4EE3;&#x7406;&#xFF0C;&#x4E00;&#x65E6;&#x626B;&#x63CF;&#x5230;&#x6307;&#x5B9A;&#x7C7B;&#x578B;&#x7684;&#x6570;&#x636E;&#xFF0C;&#x5C31;&#x4F1A;&#x901A;&#x8FC7;&#x4EE3;&#x7406;&#x8F93;&#x51FA;</span></span><br><span class="line">    <span class="comment">//&#x5728;&#x626B;&#x63CF;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4F1A;&#x5206;&#x6790;&#x626B;&#x63CF;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x5206;&#x6790;&#x6210;&#x529F;&#x540E;&#x5C31;&#x4F1A;&#x8C03;&#x7528;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#x5728;&#x961F;&#x5217;&#x4E2D;&#x8F93;&#x51FA;</span></span><br><span class="line">    [<span class="keyword">self</span>.output setMetadataObjectsDelegate:<span class="keyword">self</span> queue:dispatch_get_main_queue()];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x751F;&#x6210;&#x4F1A;&#x8BDD;&#xFF0C;&#x7528;&#x6765;&#x7ED3;&#x5408;&#x8F93;&#x5165;&#x8F93;&#x51FA;</span></span><br><span class="line">    <span class="keyword">self</span>.session = [[<span class="built_in">AVCaptureSession</span> alloc]init];</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.session canAddInput:<span class="keyword">self</span>.input]) {</span><br><span class="line">        [<span class="keyword">self</span>.session addInput:<span class="keyword">self</span>.input];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.session canAddOutput:<span class="keyword">self</span>.output]) {</span><br><span class="line">        [<span class="keyword">self</span>.session addOutput:<span class="keyword">self</span>.output];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x6307;&#x5B9A;&#x5F53;&#x626B;&#x63CF;&#x5230;&#x4E8C;&#x7EF4;&#x7801;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4EA7;&#x751F;&#x8F93;&#x51FA;</span></span><br><span class="line">    <span class="comment">//AVMetadataObjectTypeQRCode &#x6307;&#x5B9A;&#x4E8C;&#x7EF4;&#x7801;</span></span><br><span class="line">    <span class="comment">//&#x6307;&#x5B9A;&#x8BC6;&#x522B;&#x7C7B;&#x578B;&#x4E00;&#x5B9A;&#x8981;&#x653E;&#x5230;&#x6DFB;&#x52A0;&#x5230;session&#x4E4B;&#x540E;</span></span><br><span class="line">    [<span class="keyword">self</span>.output setMetadataObjectTypes:@[<span class="built_in">AVMetadataObjectTypeQRCode</span>]];</span><br><span class="line"><span class="comment">//&#x8BBE;&#x7F6E;&#x626B;&#x63CF;&#x4FE1;&#x606F;&#x7684;&#x8BC6;&#x522B;&#x533A;&#x57DF;&#xFF0C;&#x5DE6;&#x4E0A;&#x89D2;&#x4E3A;(0,0),&#x53F3;&#x4E0B;&#x89D2;&#x4E3A;(1,1),&#x4E0D;&#x8BBE;&#x7684;&#x8BDD;&#x5168;&#x5C4F;&#x90FD;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x3002;&#x8BBE;&#x7F6E;&#x8FC7;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x7F29;&#x5C0F;&#x4FE1;&#x606F;&#x626B;&#x63CF;&#x9762;&#x79EF;&#x52A0;&#x5FEB;&#x8BC6;&#x522B;&#x901F;&#x5EA6;&#x3002;</span></span><br><span class="line"><span class="comment">//&#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#x5E76;&#x4E0D;&#x597D;&#x8BBE;&#x7F6E;&#xFF0C;&#x6574;&#x4E86;&#x534A;&#x5929;&#x4E5F;&#x6CA1;&#x592A;&#x641E;&#x660E;&#x767D;&#xFF0C;&#x5230;&#x5E95;x,y,width,height,&#x600E;&#x4E48;&#x662F;&#x5BF9;&#x5E94;&#x7684;&#xFF0C;&#x8FD9;&#x662F;&#x6211;&#x4E00;&#x70B9;&#x4E00;&#x70B9;&#x8BD5;&#x7684;&#x626B;&#x63CF;&#x533A;&#x57DF;&#xFF0C;&#x770B;&#x4E0D;&#x5230;&#x53EA;&#x80FD;&#x8C03;&#x4E00;&#x4E0B;&#xFF0C;&#x626B;&#x4E00;&#x626B;&#x8BD5;&#x8BD5;</span></span><br><span class="line">    [<span class="keyword">self</span>.output setRectOfInterest:<span class="built_in">CGRectMake</span>(<span class="number">0.1</span> ,<span class="number">0.3</span> , <span class="number">0.4</span>, <span class="number">0.4</span>)];</span><br><span class="line">    <span class="comment">//&#x4F7F;&#x7528;self.session&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x9884;&#x89C8;&#x5C42;&#xFF0C;self.session&#x8D1F;&#x8D23;&#x9A71;&#x52A8;input&#x8FDB;&#x884C;&#x4FE1;&#x606F;&#x7684;&#x91C7;&#x96C6;&#xFF0C;layer&#x8D1F;&#x8D23;&#x628A;&#x56FE;&#x50CF;&#x6E32;&#x67D3;&#x663E;&#x793A;</span></span><br><span class="line">    <span class="keyword">self</span>.previewLayer = [[<span class="built_in">AVCaptureVideoPreviewLayer</span> alloc]initWithSession:<span class="keyword">self</span>.session];</span><br><span class="line">    <span class="keyword">self</span>.previewLayer.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, kScreenWidth , kScreenHeight);</span><br><span class="line">    <span class="keyword">self</span>.previewLayer.videoGravity = <span class="built_in">AVLayerVideoGravityResizeAspectFill</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view.layer addSublayer:<span class="keyword">self</span>.previewLayer];</span><br><span class="line"></span><br><span class="line">    <span class="comment">//&#x5F00;&#x59CB;&#x542F;&#x52A8;</span></span><br><span class="line">    [<span class="keyword">self</span>.session startRunning];</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="&#x5B9E;&#x73B0;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;"><a href="#&#x5B9E;&#x73B0;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;" class="headerlink" title="&#x5B9E;&#x73B0;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;"></a>&#x5B9E;&#x73B0;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma mark &#x8F93;&#x51FA;&#x7684;&#x4EE3;&#x7406;</span></span><br><span class="line"><span class="comment">//metadataObjects &#xFF1A;&#x628A;&#x8BC6;&#x522B;&#x5230;&#x7684;&#x5185;&#x5BB9;&#x653E;&#x5230;&#x8BE5;&#x6570;&#x7EC4;&#x4E2D;</span></span><br><span class="line">- (<span class="keyword">void</span>)captureOutput:(<span class="built_in">AVCaptureOutput</span> *)captureOutput didOutputMetadataObjects:(<span class="built_in">NSArray</span> *)metadataObjects fromConnection:(<span class="built_in">AVCaptureConnection</span> *)connection</span><br><span class="line">{</span><br><span class="line">    <span class="comment">//&#x505C;&#x6B62;&#x626B;&#x63CF;</span></span><br><span class="line">    [<span class="keyword">self</span>.session stopRunning];</span><br><span class="line">    [<span class="keyword">self</span>.timer invalidate];</span><br><span class="line">    <span class="keyword">self</span>.timer = <span class="literal">nil</span>;</span><br><span class="line">    [<span class="keyword">self</span>.lineView removeFromSuperview];</span><br><span class="line">    <span class="keyword">if</span> ([metadataObjects count] &gt;= <span class="number">1</span>) {</span><br><span class="line">        <span class="comment">//&#x6570;&#x7EC4;&#x4E2D;&#x5305;&#x542B;&#x7684;&#x90FD;&#x662F;AVMetadataMachineReadableCodeObject &#x7C7B;&#x578B;&#x7684;&#x5BF9;&#x8C61;&#xFF0C;&#x8BE5;&#x5BF9;&#x8C61;&#x4E2D;&#x5305;&#x542B;&#x89E3;&#x7801;&#x540E;&#x7684;&#x6570;&#x636E;</span></span><br><span class="line">        <span class="built_in">AVMetadataMachineReadableCodeObject</span> *qrObject = [metadataObjects lastObject];</span><br><span class="line">        &#x62FF;&#x5230;&#x626B;&#x63CF;&#x5185;&#x5BB9;&#x5728;&#x8FD9;&#x91CC;&#x8FDB;&#x884C;&#x4E2A;&#x6027;&#x5316;&#x5904;&#x7406;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@&quot;&#x8BC6;&#x522B;&#x6210;&#x529F;%@&quot;</span>,qrObject.stringValue);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h3 id="&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;"><a href="#&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;" class="headerlink" title="&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;"></a>&#x9047;&#x5230;&#x7684;&#x95EE;&#x9898;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;</h3><p>&#xFF08;1&#xFF09;&#x4E8C;&#x7EF4;&#x7801;&#x4E0A;&#x52A0;logo&#x56FE;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x56FE;&#x7247;&#x5F88;&#x6A21;&#x7CCA;&#xFF0C;&#x8FD9;&#x662F;&#x7531;&#x4E8E;UIGraphicsBeginImageContextWithOptions&#x91CC;&#x7684; scale &#x9020;&#x6210;&#x7684;&#xFF0C;&#x7531;&#x4E8E; iPhone &#x7684;&#x5C4F;&#x5E55;&#x90FD;&#x662F;retina&#x5C4F;&#x5E55;&#xFF0C;&#x90FD;&#x662F;2&#x500D;&#xFF0C;3&#x500D;&#x50CF;&#x7D20;&#xFF0C;&#x8FD9;&#x91CC;&#x7684; scale &#x8981;&#x6839;&#x636E;&#x5C4F;&#x5E55;&#x6765;&#x8BBE;&#x7F6E; &#x5373;[[UIScreen mainScreen] scale]&#x8FD9;&#x6837;&#x56FE;&#x7247;&#x5C31;&#x4F1A;&#x5F88;&#x6E05;&#x6670;<br>&#xFF08;2&#xFF09;setRectOfInterest&#xFF1A;&#x8BBE;&#x7F6E;&#x626B;&#x63CF;&#x4FE1;&#x606F;&#x7684;&#x8BC6;&#x522B;&#x533A;&#x57DF;&#xFF0C;&#x5DE6;&#x4E0A;&#x89D2;&#x4E3A;(0,0),&#x53F3;&#x4E0B;&#x89D2;&#x4E3A;(1,1),&#x4E0D;&#x8BBE;&#x7684;&#x8BDD;&#x5168;&#x5C4F;&#x90FD;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;&#x3002;&#x8BBE;&#x7F6E;&#x8FC7;&#x4E4B;&#x540E;&#x53EF;&#x4EE5;&#x7F29;&#x5C0F;&#x4FE1;&#x606F;&#x626B;&#x63CF;&#x9762;&#x79EF;&#x52A0;&#x5FEB;&#x8BC6;&#x522B;&#x901F;&#x5EA6;&#xFF0C;&#x539F;&#x6765;&#x626B;&#x63CF;&#x7684;&#x662F;&#x6574;&#x4E2A;&#x5C4F;&#x5E55;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x53EA;&#x626B;&#x63CF;&#x4E00;&#x5757;&#x533A;&#x57DF;&#xFF0C;&#x4EE5;&#x6B64;&#x52A0;&#x5FEB;&#x8BC6;&#x522B;&#x901F;&#x5EA6;&#x3002;&#x4F46;&#x662F;&#x8FD9;&#x4E2A;&#x5C5E;&#x6027;&#x5E76;&#x4E0D;&#x597D;&#x8BBE;&#x7F6E;&#xFF0C;&#x6574;&#x4E86;&#x534A;&#x5929;&#x4E5F;&#x6CA1;&#x592A;&#x641E;&#x660E;&#x767D;&#xFF0C;&#x5230;&#x5E95;x,y,width,height,&#x600E;&#x4E48;&#x662F;&#x5BF9;&#x5E94;&#x7684;&#xFF0C;&#x800C;&#x4E14;&#x662F;&#x6BD4;&#x4F8B;&#x4E0D;&#x662F;&#x76F4;&#x63A5;&#x7684;&#x6570;&#x5B57;&#xFF0C;&#x6211;&#x662F;&#x4E00;&#x70B9;&#x4E00;&#x70B9;&#x8BD5;&#x7684;&#x626B;&#x63CF;&#x533A;&#x57DF;&#xFF0C;&#x770B;&#x4E0D;&#x5230;&#x60C5;&#x51B5;&#xFF0C;&#x53EA;&#x80FD;&#x8C03;&#x4E00;&#x4E0B;&#xFF0C;&#x626B;&#x4E00;&#x626B;&#x8BD5;&#x8BD5;<br>&#x6700;&#x540E;&#x4E5F;&#x6CA1;&#x6574;&#x660E;&#x767D;&#xFF0C;&#x54EA;&#x4F4D;&#x5927;&#x795E;&#x77E5;&#x9053;&#xFF0C;&#x6C42;&#x89E3;&#x7B54;<br>&#x9644;&#x4E0A;&#x5B98;&#x65B9;&#x89E3;&#x91CA;:<br>    The value of this property is a CGRect that determines the receiver&#x2019;s rectangle of interest for each frame of video.<br>    The rectangle&#x2019;s origin is top left and is relative to the coordinate space of the device providing the metadata.  Specifying<br>    a rectOfInterest may improve detection performance for certain types of metadata. The default value of this property is the<br>    value CGRectMake(0, 0, 1, 1).  Metadata objects whose bounds do not intersect with the rectOfInterest will not be returned.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[30分钟搞定iOS自定义相机]]></title>
      <url>http://nanshanyi.github.io/2016/05/07/xiangji/</url>
      <content type="html"><![CDATA[<p>&#x3000;&#x3000;&#x6700;&#x8FD1;&#x516C;&#x53F8;&#x7684;&#x9879;&#x76EE;&#x4E2D;&#x7528;&#x5230;&#x4E86;&#x76F8;&#x673A;&#xFF0C;&#x7531;&#x4E8E;&#x4E0D;&#x7528;&#x7CFB;&#x7EDF;&#x7684;&#x76F8;&#x673A;&#xFF0C;UI&#x7ED9;&#x7684;&#x76F8;&#x673A;&#x5207;&#x56FE;&#xFF0C;&#x5FC5;&#x987B;&#x81EA;&#x5B9A;&#x4E49;&#x624D;&#x53EF;&#x4EE5;&#x3002;&#x5C31;&#x82B1;&#x65F6;&#x95F4;&#x7B80;&#x5355;&#x7814;&#x7A76;&#x4E86;&#x4E00;&#x4E0B;&#x76F8;&#x673A;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x3002;<br>&#x3000;&#x3000;&#x76F8;&#x673A;&#x5C5E;&#x4E8E;&#x7CFB;&#x7EDF;&#x786C;&#x4EF6;&#xFF0C;&#x8FD9;&#x5C31;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x6765;&#x624B;&#x52A8;&#x8C03;&#x7528;iPhone&#x7684;&#x76F8;&#x673A;&#x786C;&#x4EF6;&#xFF0C;&#x5206;&#x4E3A;&#x4EE5;&#x4E0B;&#x6B65;&#x9AA4;&#xFF1A;<br><a id="more"></a><br><img src="/2016/05/07/xiangji/camera.png" alt=""></p>
<h4 id="&#x9996;&#x5148;&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;"><a href="#&#x9996;&#x5148;&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;" class="headerlink" title="&#x9996;&#x5148;&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;"></a>&#x9996;&#x5148;&#x58F0;&#x660E;&#x4EE5;&#x4E0B;&#x5BF9;&#x8C61;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></span><br><span class="line"><span class="comment">//&#x6355;&#x83B7;&#x8BBE;&#x5907;&#xFF0C;&#x901A;&#x5E38;&#x662F;&#x524D;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#xFF0C;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#xFF0C;&#x9EA6;&#x514B;&#x98CE;&#xFF08;&#x97F3;&#x9891;&#x8F93;&#x5165;&#xFF09;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">AVCaptureDevice</span> *device;</span><br><span class="line"></span><br><span class="line"><span class="comment">//AVCaptureDeviceInput &#x4EE3;&#x8868;&#x8F93;&#x5165;&#x8BBE;&#x5907;&#xFF0C;&#x4ED6;&#x4F7F;&#x7528;AVCaptureDevice &#x6765;&#x521D;&#x59CB;&#x5316;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">AVCaptureDeviceInput</span> *input;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x8F93;&#x51FA;&#x56FE;&#x7247;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span> ,<span class="keyword">strong</span>) <span class="built_in">AVCaptureStillImageOutput</span> *imageOutput;</span><br><span class="line"></span><br><span class="line"><span class="comment">//session&#xFF1A;&#x7531;&#x4ED6;&#x628A;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7ED3;&#x5408;&#x5728;&#x4E00;&#x8D77;&#xFF0C;&#x5E76;&#x5F00;&#x59CB;&#x542F;&#x52A8;&#x6355;&#x83B7;&#x8BBE;&#x5907;&#xFF08;&#x6444;&#x50CF;&#x5934;&#xFF09;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">strong</span>) <span class="built_in">AVCaptureSession</span> *session;</span><br><span class="line"></span><br><span class="line"><span class="comment">//&#x56FE;&#x50CF;&#x9884;&#x89C8;&#x5C42;&#xFF0C;&#x5B9E;&#x65F6;&#x663E;&#x793A;&#x6355;&#x83B7;&#x7684;&#x56FE;&#x50CF;</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span> ,<span class="keyword">strong</span>) <span class="built_in">AVCaptureVideoPreviewLayer</span> *previewLayer;</span><br></pre></td></tr></table></figure>
<h4 id="&#x521D;&#x59CB;&#x5316;&#x5404;&#x4E2A;&#x5BF9;&#x8C61;"><a href="#&#x521D;&#x59CB;&#x5316;&#x5404;&#x4E2A;&#x5BF9;&#x8C61;" class="headerlink" title="&#x521D;&#x59CB;&#x5316;&#x5404;&#x4E2A;&#x5BF9;&#x8C61;"></a>&#x521D;&#x59CB;&#x5316;&#x5404;&#x4E2A;&#x5BF9;&#x8C61;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)cameraDistrict</span><br><span class="line">{</span><br><span class="line"><span class="comment">//    AVCaptureDevicePositionBack  &#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;</span></span><br><span class="line"><span class="comment">//    AVCaptureDevicePositionFront &#x524D;&#x7F6E;&#x6444;&#x50CF;&#x5934;</span></span><br><span class="line">   <span class="keyword">self</span>.device = [<span class="keyword">self</span> cameraWithPosition:<span class="built_in">AVCaptureDevicePositionFront</span>];</span><br><span class="line">    <span class="keyword">self</span>.input = [[<span class="built_in">AVCaptureDeviceInput</span> alloc] initWithDevice:<span class="keyword">self</span>.device error:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.imageOutput = [[<span class="built_in">AVCaptureStillImageOutput</span> alloc] init];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span>.session = [[<span class="built_in">AVCaptureSession</span> alloc] init];</span><br><span class="line">    <span class="comment">//     &#x62FF;&#x5230;&#x7684;&#x56FE;&#x50CF;&#x7684;&#x5927;&#x5C0F;&#x53EF;&#x4EE5;&#x81EA;&#x884C;&#x8BBE;&#x5B9A;</span></span><br><span class="line">    <span class="comment">//    AVCaptureSessionPreset320x240</span></span><br><span class="line">    <span class="comment">//    AVCaptureSessionPreset352x288</span></span><br><span class="line">    <span class="comment">//    AVCaptureSessionPreset640x480</span></span><br><span class="line">    <span class="comment">//    AVCaptureSessionPreset960x540</span></span><br><span class="line">    <span class="comment">//    AVCaptureSessionPreset1280x720</span></span><br><span class="line">    <span class="comment">//    AVCaptureSessionPreset1920x1080</span></span><br><span class="line">    <span class="comment">//    AVCaptureSessionPreset3840x2160</span></span><br><span class="line">    <span class="keyword">self</span>.session.sessionPreset = <span class="built_in">AVCaptureSessionPreset640x480</span>;</span><br><span class="line">    <span class="comment">//&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x8BBE;&#x5907;&#x7ED3;&#x5408;</span></span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.session canAddInput:<span class="keyword">self</span>.input]) {</span><br><span class="line">        [<span class="keyword">self</span>.session addInput:<span class="keyword">self</span>.input];</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">if</span> ([<span class="keyword">self</span>.session canAddOutput:<span class="keyword">self</span>.imageOutput]) {</span><br><span class="line">        [<span class="keyword">self</span>.session addOutput:<span class="keyword">self</span>.imageOutput];</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//&#x9884;&#x89C8;&#x5C42;&#x7684;&#x751F;&#x6210;</span></span><br><span class="line">    <span class="keyword">self</span>.previewLayer = [[<span class="built_in">AVCaptureVideoPreviewLayer</span> alloc] initWithSession:<span class="keyword">self</span>.session];</span><br><span class="line">    <span class="keyword">self</span>.previewLayer.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">64</span>, SCREEN_WIDTH, SCREEN_HEIGHT<span class="number">-64</span>);</span><br><span class="line">    <span class="keyword">self</span>.previewLayer.videoGravity = <span class="built_in">AVLayerVideoGravityResizeAspectFill</span>;</span><br><span class="line">    [<span class="keyword">self</span>.view.layer addSublayer:<span class="keyword">self</span>.previewLayer];</span><br><span class="line">    <span class="comment">//&#x8BBE;&#x5907;&#x53D6;&#x666F;&#x5F00;&#x59CB;</span></span><br><span class="line">    [<span class="keyword">self</span>.session startRunning];</span><br><span class="line">    <span class="keyword">if</span> ([_device lockForConfiguration:<span class="literal">nil</span>]) {</span><br><span class="line">    <span class="comment">//&#x81EA;&#x52A8;&#x95EA;&#x5149;&#x706F;&#xFF0C;</span></span><br><span class="line">        <span class="keyword">if</span> ([_device isFlashModeSupported:<span class="built_in">AVCaptureFlashModeAuto</span>]) {</span><br><span class="line">            [_device setFlashMode:<span class="built_in">AVCaptureFlashModeAuto</span>];</span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//&#x81EA;&#x52A8;&#x767D;&#x5E73;&#x8861;,&#x4F46;&#x662F;&#x597D;&#x50CF;&#x4E00;&#x76F4;&#x90FD;&#x8FDB;&#x4E0D;&#x53BB;</span></span><br><span class="line">        <span class="keyword">if</span> ([_device isWhiteBalanceModeSupported:<span class="built_in">AVCaptureWhiteBalanceModeAutoWhiteBalance</span>]) {</span><br><span class="line">            [_device setWhiteBalanceMode:<span class="built_in">AVCaptureWhiteBalanceModeAutoWhiteBalance</span>];</span><br><span class="line">        }</span><br><span class="line">        [_device unlockForConfiguration];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>  &#x6839;&#x636E;&#x524D;&#x540E;&#x7F6E;&#x4F4D;&#x7F6E;&#x62FF;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x6444;&#x50CF;&#x5934;&#xFF1A;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">AVCaptureDevice</span> *)cameraWithPosition:(<span class="built_in">AVCaptureDevicePosition</span>)position{</span><br><span class="line">    <span class="built_in">NSArray</span> *devices = [<span class="built_in">AVCaptureDevice</span> devicesWithMediaType:<span class="built_in">AVMediaTypeVideo</span>];</span><br><span class="line">    <span class="keyword">for</span> ( <span class="built_in">AVCaptureDevice</span> *device <span class="keyword">in</span> devices )</span><br><span class="line">        <span class="keyword">if</span> ( device.position == position ){</span><br><span class="line">            <span class="keyword">return</span> device;</span><br><span class="line">        }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">}</span><br></pre></td></tr></table></figure></p>
<h4 id="&#x62CD;&#x7167;&#x62FF;&#x5230;&#x76F8;&#x5E94;&#x56FE;&#x7247;&#xFF1A;"><a href="#&#x62CD;&#x7167;&#x62FF;&#x5230;&#x76F8;&#x5E94;&#x56FE;&#x7247;&#xFF1A;" class="headerlink" title="&#x62CD;&#x7167;&#x62FF;&#x5230;&#x76F8;&#x5E94;&#x56FE;&#x7247;&#xFF1A;"></a>&#x62CD;&#x7167;&#x62FF;&#x5230;&#x76F8;&#x5E94;&#x56FE;&#x7247;&#xFF1A;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)photoBtnDidClick</span><br><span class="line">{</span><br><span class="line">    <span class="built_in">AVCaptureConnection</span> *conntion = [<span class="keyword">self</span>.imageOutput connectionWithMediaType:<span class="built_in">AVMediaTypeVideo</span>];</span><br><span class="line">      <span class="keyword">if</span> (!conntion) {</span><br><span class="line">          <span class="built_in">NSLog</span>(<span class="string">@&quot;&#x62CD;&#x7167;&#x5931;&#x8D25;!&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">          }</span><br><span class="line">    [<span class="keyword">self</span>.imageOutput captureStillImageAsynchronouslyFromConnection:conntion completionHandler:^(CMSampleBufferRef imageDataSampleBuffer, <span class="built_in">NSError</span> *error) {</span><br><span class="line">        <span class="keyword">if</span> (imageDataSampleBuffer == <span class="literal">nil</span>) {</span><br><span class="line">            <span class="keyword">return</span> ;</span><br><span class="line">          }</span><br><span class="line">        <span class="built_in">NSData</span> *imageData = [<span class="built_in">AVCaptureStillImageOutput</span> jpegStillImage<span class="built_in">NSDataRepresentation</span>:imageDataSampleBuffer];</span><br><span class="line">        <span class="keyword">self</span>.image = [<span class="built_in">UIImage</span> imageWithData:imageData];</span><br><span class="line">        [<span class="keyword">self</span>.session stopRunning];</span><br><span class="line">        [<span class="keyword">self</span>.view addSubview:<span class="keyword">self</span>.cameraImageView];</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="&#x4FDD;&#x5B58;&#x7167;&#x7247;&#x5230;&#x76F8;&#x518C;&#xFF1A;"><a href="#&#x4FDD;&#x5B58;&#x7167;&#x7247;&#x5230;&#x76F8;&#x518C;&#xFF1A;" class="headerlink" title="&#x4FDD;&#x5B58;&#x7167;&#x7247;&#x5230;&#x76F8;&#x518C;&#xFF1A;"></a>&#x4FDD;&#x5B58;&#x7167;&#x7247;&#x5230;&#x76F8;&#x518C;&#xFF1A;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#pragma - &#x4FDD;&#x5B58;&#x81F3;&#x76F8;&#x518C;</span></span><br><span class="line">- (<span class="keyword">void</span>)saveImageToPhotoAlbum:(<span class="built_in">UIImage</span>*)savedImage</span><br><span class="line">{</span><br><span class="line"></span><br><span class="line">    <span class="built_in">UIImageWriteToSavedPhotosAlbum</span>(savedImage, <span class="keyword">self</span>, <span class="keyword">@selector</span>(image:didFinishSavingWithError:contextInfo:), <span class="literal">NULL</span>);</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="comment">// &#x6307;&#x5B9A;&#x56DE;&#x8C03;&#x65B9;&#x6CD5;</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)image: (<span class="built_in">UIImage</span> *) image didFinishSavingWithError: (<span class="built_in">NSError</span> *) error contextInfo: (<span class="keyword">void</span> *) contextInfo</span><br><span class="line"></span><br><span class="line">{</span><br><span class="line">    <span class="built_in">NSString</span> *msg = <span class="literal">nil</span> ;</span><br><span class="line">    <span class="keyword">if</span>(error != <span class="literal">NULL</span>){</span><br><span class="line">        msg = <span class="string">@&quot;&#x4FDD;&#x5B58;&#x56FE;&#x7247;&#x5931;&#x8D25;&quot;</span> ;</span><br><span class="line">    }<span class="keyword">else</span>{</span><br><span class="line">        msg = <span class="string">@&quot;&#x4FDD;&#x5B58;&#x56FE;&#x7247;&#x6210;&#x529F;&quot;</span> ;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">UIAlertView</span> *alert = [[<span class="built_in">UIAlertView</span> alloc] initWithTitle:<span class="string">@&quot;&#x4FDD;&#x5B58;&#x56FE;&#x7247;&#x7ED3;&#x679C;&#x63D0;&#x793A;&quot;</span></span><br><span class="line">                                            message:msg</span><br><span class="line">                                            delegate:<span class="keyword">self</span></span><br><span class="line">                                          cancelButtonTitle:<span class="string">@&quot;&#x786E;&#x5B9A;&quot;</span></span><br><span class="line">                                          otherButtonTitles:<span class="literal">nil</span>];</span><br><span class="line">    [alert show];</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="&#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;"><a href="#&#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;" class="headerlink" title="&#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;"></a>&#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)changeCamera{</span><br><span class="line">    <span class="built_in">NSUInteger</span> cameraCount = [[<span class="built_in">AVCaptureDevice</span> devicesWithMediaType:<span class="built_in">AVMediaTypeVideo</span>] count];</span><br><span class="line">    <span class="keyword">if</span> (cameraCount &gt; <span class="number">1</span>) {</span><br><span class="line">        <span class="built_in">NSError</span> *error;</span><br><span class="line">        <span class="comment">//&#x7ED9;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;&#x6DFB;&#x52A0;&#x7FFB;&#x8F6C;&#x52A8;&#x753B;</span></span><br><span class="line">        <span class="built_in">CATransition</span> *animation = [<span class="built_in">CATransition</span> animation]&#xFF1B;</span><br><span class="line">        animation.duration = <span class="number">.5</span>f&#xFF1B;</span><br><span class="line">        animation.timingFunction = [<span class="built_in">CAMediaTimingFunction</span> functionWithName:k<span class="built_in">CAMediaTimingFunctionEaseInEaseOut</span>];</span><br><span class="line">        animation.type = <span class="string">@&quot;oglFlip&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">AVCaptureDevice</span> *newCamera = <span class="literal">nil</span>;</span><br><span class="line">        <span class="built_in">AVCaptureDeviceInput</span> *newInput = <span class="literal">nil</span>;</span><br><span class="line">  <span class="comment">//&#x62FF;&#x5230;&#x53E6;&#x5916;&#x4E00;&#x4E2A;&#x6444;&#x50CF;&#x5934;&#x4F4D;&#x7F6E;</span></span><br><span class="line">        <span class="built_in">AVCaptureDevicePosition</span> position = [[_input device] position];</span><br><span class="line">        <span class="keyword">if</span> (position == <span class="built_in">AVCaptureDevicePositionFront</span>){</span><br><span class="line">            newCamera = [<span class="keyword">self</span> cameraWithPosition:<span class="built_in">AVCaptureDevicePositionBack</span>];</span><br><span class="line">            animation.subtype = k<span class="built_in">CATransitionFromLeft</span>;<span class="comment">//&#x52A8;&#x753B;&#x7FFB;&#x8F6C;&#x65B9;&#x5411;</span></span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> {</span><br><span class="line">            newCamera = [<span class="keyword">self</span> cameraWithPosition:<span class="built_in">AVCaptureDevicePositionFront</span>];</span><br><span class="line">            animation.subtype = k<span class="built_in">CATransitionFromRight</span>;<span class="comment">//&#x52A8;&#x753B;&#x7FFB;&#x8F6C;&#x65B9;&#x5411;</span></span><br><span class="line">        }</span><br><span class="line">        <span class="comment">//&#x751F;&#x6210;&#x65B0;&#x7684;&#x8F93;&#x5165;</span></span><br><span class="line">        newInput = [<span class="built_in">AVCaptureDeviceInput</span> deviceInputWithDevice:newCamera error:<span class="literal">nil</span>];</span><br><span class="line">        [<span class="keyword">self</span>.previewLayer addAnimation:animation forKey:<span class="literal">nil</span>];</span><br><span class="line">        <span class="keyword">if</span> (newInput != <span class="literal">nil</span>) {</span><br><span class="line">            [<span class="keyword">self</span>.session beginConfiguration];</span><br><span class="line">            [<span class="keyword">self</span>.session removeInput:<span class="keyword">self</span>.input];</span><br><span class="line">            <span class="keyword">if</span> ([<span class="keyword">self</span>.session canAddInput:newInput]) {</span><br><span class="line">                [<span class="keyword">self</span>.session addInput:newInput];</span><br><span class="line">                <span class="keyword">self</span>.input = newInput;</span><br><span class="line"></span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                [<span class="keyword">self</span>.session addInput:<span class="keyword">self</span>.input];</span><br><span class="line">            }</span><br><span class="line">            [<span class="keyword">self</span>.session commitConfiguration];</span><br><span class="line"></span><br><span class="line">        } <span class="keyword">else</span> <span class="keyword">if</span> (error) {</span><br><span class="line">            <span class="built_in">NSLog</span>(<span class="string">@&quot;toggle carema failed, error = %@&quot;</span>, error);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="&#x76F8;&#x673A;&#x7684;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;"><a href="#&#x76F8;&#x673A;&#x7684;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;" class="headerlink" title="&#x76F8;&#x673A;&#x7684;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;"></a>&#x76F8;&#x673A;&#x7684;&#x5176;&#x5B83;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;</h4><pre><code class="objectivec"><span class="comment">//AVCaptureFlashMode  &#x95EA;&#x5149;&#x706F;</span>
<span class="comment">//AVCaptureFocusMode  &#x5BF9;&#x7126;</span>
<span class="comment">//AVCaptureExposureMode  &#x66DD;&#x5149;</span>
<span class="comment">//AVCaptureWhiteBalanceMode  &#x767D;&#x5E73;&#x8861;</span>
<span class="comment">//&#x95EA;&#x5149;&#x706F;&#x548C;&#x767D;&#x5E73;&#x8861;&#x53EF;&#x4EE5;&#x5728;&#x751F;&#x6210;&#x76F8;&#x673A;&#x65F6;&#x5019;&#x8BBE;&#x7F6E;</span>
<span class="comment">//&#x66DD;&#x5149;&#x8981;&#x6839;&#x636E;&#x5BF9;&#x7126;&#x70B9;&#x7684;&#x5149;&#x7EBF;&#x72B6;&#x51B5;&#x800C;&#x51B3;&#x5B9A;,&#x6240;&#x4EE5;&#x548C;&#x5BF9;&#x7126;&#x4E00;&#x5757;&#x5199;</span>
<span class="comment">//point&#x4E3A;&#x70B9;&#x51FB;&#x7684;&#x4F4D;&#x7F6E;</span>
- (<span class="keyword">void</span>)focusAtPoint:(<span class="built_in">CGPoint</span>)point{
    <span class="built_in">CGSize</span> size = <span class="keyword">self</span>.view.bounds.size;
    <span class="built_in">CGPoint</span> focusPoint = <span class="built_in">CGPointMake</span>( point.y /size.height ,<span class="number">1</span>-point.x/size.width );
    <span class="built_in">NSError</span> *error;
    <span class="keyword">if</span> ([<span class="keyword">self</span>.device lockForConfiguration:&amp;error]) {
        <span class="comment">//&#x5BF9;&#x7126;&#x6A21;&#x5F0F;&#x548C;&#x5BF9;&#x7126;&#x70B9;</span>
        <span class="keyword">if</span> ([<span class="keyword">self</span>.device isFocusModeSupported:<span class="built_in">AVCaptureFocusModeAutoFocus</span>]) {
            [<span class="keyword">self</span>.device setFocusPointOfInterest:focusPoint];
            [<span class="keyword">self</span>.device setFocusMode:<span class="built_in">AVCaptureFocusModeAutoFocus</span>];
        }
        <span class="comment">//&#x66DD;&#x5149;&#x6A21;&#x5F0F;&#x548C;&#x66DD;&#x5149;&#x70B9;</span>
        <span class="keyword">if</span> ([<span class="keyword">self</span>.device isExposureModeSupported:<span class="built_in">AVCaptureExposureModeAutoExpose</span> ]) {
            [<span class="keyword">self</span>.device setExposurePointOfInterest:focusPoint];
            [<span class="keyword">self</span>.device setExposureMode:<span class="built_in">AVCaptureExposureModeAutoExpose</span>];
        }

        [<span class="keyword">self</span>.device unlockForConfiguration];
        <span class="comment">//&#x8BBE;&#x7F6E;&#x5BF9;&#x7126;&#x52A8;&#x753B;</span>
        _focusView.center = point;
        _focusView.hidden = <span class="literal">NO</span>;
        [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.3</span> animations:^{
            _focusView.transform = <span class="built_in">CGAffineTransformMakeScale</span>(<span class="number">1.25</span>, <span class="number">1.25</span>);
        }completion:^(<span class="built_in">BOOL</span> finished) {
            [<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.5</span> animations:^{
                _focusView.transform = <span class="built_in">CGAffineTransformIdentity</span>;
            } completion:^(<span class="built_in">BOOL</span> finished) {
                _focusView.hidden = <span class="literal">YES</span>;
            }];
        }];
    }

}
</code></pre>
<h4 id="&#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x5751;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;"><a href="#&#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x5751;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;" class="headerlink" title="&#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x5751;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;"></a>&#x9047;&#x5230;&#x7684;&#x4E00;&#x4E9B;&#x5751;&#x548C;&#x89E3;&#x51B3;&#x529E;&#x6CD5;</h4><h5 id="1-&#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;"><a href="#1-&#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;" class="headerlink" title="1) &#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;"></a>1) &#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x7684;&#x5207;&#x6362;</h5><p>&#x3000;&#x3000;&#x524D;&#x540E;&#x503C;&#x4E0D;&#x80FD;&#x5207;&#x6362;&#xFF0C;&#x5404;&#x79CD;&#x5C1D;&#x8BD5;&#x627E;&#x4E86;&#x534A;&#x5929;&#x6CA1;&#x627E;&#x5230;&#x6709;&#x539F;&#x56E0;&#x3002;&#x540E;&#x6765;&#x53D1;&#x73B0;&#x6211;&#x5728;&#x8BBE;&#x7F6E;&#x56FE;&#x7247;&#x5C3A;&#x5BF8;&#x7684;&#x65F6;&#x5019;&#x8BBE;&#x7F6E;&#x4E3A;1080P [self.session canSetSessionPreset: AVCaptureSessionPreset1920x1080]   &#xFF0C;&#x524D;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x5E76;&#x4E0D;&#x652F;&#x6301;&#x8FD9;&#x4E48;&#x5927;&#x7684;&#x5C3A;&#x5BF8;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x4E0D;&#x80FD;&#x5207;&#x6362;&#x524D;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x3002;&#x6211;&#x9A8C;&#x8BC1;&#x4E86;&#x4E0B; &#x524D;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x6700;&#x9AD8;&#x652F;&#x6301;720P,720P&#x4EE5;&#x5185;&#x53EF;&#x81EA;&#x7531;&#x5207;&#x6362;&#x3002;&#x3000;&#x3000;&#x5F53;&#x7136;&#x4E5F;&#x53EF;&#x4EE5;&#x5728;&#x524D;&#x540E;&#x7F6E;&#x6444;&#x50CF;&#x5934;&#x5207;&#x6362;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x6839;&#x636E;&#x524D;&#x540E;&#x6444;&#x50CF;&#x5934;&#x6765;&#x8BBE;&#x7F6E;&#x4E0D;&#x540C;&#x7684;&#x5C3A;&#x5BF8;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x5728;&#x8D58;&#x8FF0;&#x3002;</p>
<h5 id="2&#xFF09;&#x7126;&#x70B9;&#x4F4D;&#x7F6E;"><a href="#2&#xFF09;&#x7126;&#x70B9;&#x4F4D;&#x7F6E;" class="headerlink" title="2&#xFF09;&#x7126;&#x70B9;&#x4F4D;&#x7F6E;"></a>2&#xFF09;&#x7126;&#x70B9;&#x4F4D;&#x7F6E;</h5><p>&#x3000;&#x3000;CGPoint focusPoint = CGPointMake( point.y /size.height ,1-point.x/size.width );<br>setExposurePointOfInterest&#xFF1A;focusPoint &#x51FD;&#x6570;&#x540E;&#x9762;Point&#x53D6;&#x503C;&#x8303;&#x56F4;&#x662F;&#x53D6;&#x666F;&#x6846;&#x5DE6;&#x4E0A;&#x89D2;&#xFF08;0&#xFF0C;0&#xFF09;&#x5230;&#x53D6;&#x666F;&#x6846;&#x53F3;&#x4E0B;&#x89D2;&#xFF08;1&#xFF0C;1&#xFF09;&#x4E4B;&#x95F4;&#x3002;&#x5B98;&#x65B9;&#x662F;&#x8FD9;&#x4E48;&#x5199;&#x7684;&#xFF1A;<br>&#x3000;&#x3000;The value of this property is a CGPoint that determines the receiver&#x2019;s focus point of interest, if it has one. A value of (0,0) indicates that the camera should focus on the top left corner of the image, while a value of (1,1) indicates that it should focus on the bottom right. The default value is (0.5,0.5).<br>&#x3000;&#x3000;&#x6211;&#x4E5F;&#x8BD5;&#x4E86;&#x6309;&#x8FD9;&#x4E2A;&#x6765;&#x4F46;&#x4F4D;&#x7F6E;&#x5C31;&#x662F;&#x4E0D;&#x5BF9;&#xFF0C;&#x53EA;&#x80FD;&#x6309;&#x4E0A;&#x9762;&#x7684;&#x5199;&#x6CD5;&#x624D;&#x53EF;&#x4EE5;&#x3002;&#x524D;&#x9762;&#x662F;&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;&#x7684;y/PreviewLayer&#x7684;&#x9AD8;&#x5EA6;&#xFF0C;&#x540E;&#x9762;&#x662F;1-&#x70B9;&#x51FB;&#x4F4D;&#x7F6E;&#x7684;x/PreviewLayer&#x7684;&#x5BBD;&#x5EA6;</p>
<h5 id="3&#xFF09;&#x5BF9;&#x7126;&#x548C;&#x66DD;&#x5149;"><a href="#3&#xFF09;&#x5BF9;&#x7126;&#x548C;&#x66DD;&#x5149;" class="headerlink" title="3&#xFF09;&#x5BF9;&#x7126;&#x548C;&#x66DD;&#x5149;"></a>3&#xFF09;&#x5BF9;&#x7126;&#x548C;&#x66DD;&#x5149;</h5><p>&#x3000;&#x3000;&#x6211;&#x5728;&#x8BBE;&#x7F6E;&#x5BF9;&#x7126;&#x662F; &#x5148;&#x8BBE;&#x7F6E;&#x4E86;&#x6A21;&#x5F0F;setFocusMode&#xFF0C;&#x540E;&#x8BBE;&#x7F6E;&#x5BF9;&#x7126;&#x4F4D;&#x7F6E;&#xFF0C;&#x5C31;&#x4F1A;&#x5BFC;&#x81F4;&#x5F88;&#x5947;&#x602A;&#x7684;&#x73B0;&#x8C61;&#xFF0C;&#x5BF9;&#x7126;&#x4F4D;&#x7F6E;&#x662F;&#x4F60;&#x4E0A;&#x6B21;&#x70B9;&#x51FB;&#x7684;&#x4F4D;&#x7F6E;&#x3002;&#x6240;&#x4EE5;&#x4E00;&#x5B9A;&#x8981;&#x5148;&#x8BBE;&#x7F6E;&#x4F4D;&#x7F6E;&#xFF0C;&#x518D;&#x8BBE;&#x7F6E;&#x5BF9;&#x7126;&#x6A21;&#x5F0F;&#x3002;<br>&#x3000;&#x3000;&#x66DD;&#x5149;&#x540C;&#x4E0A;</p>
<h4 id="&#x5199;&#x5728;&#x6700;&#x540E;"><a href="#&#x5199;&#x5728;&#x6700;&#x540E;" class="headerlink" title="&#x5199;&#x5728;&#x6700;&#x540E;"></a>&#x5199;&#x5728;&#x6700;&#x540E;</h4><p>&#x3000;&#x3000;&#x9644;&#x4E0A; <a href="https://github.com/nanshanyi/photographDemo" target="_blank" rel="external">demo</a><br>&#x3000;&#x3000;&#x5E38;&#x7528;&#x5230;&#x7684;&#x57FA;&#x672C;&#x5C31;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x5199;&#x7684;&#x5E76;&#x4E0D;&#x5B8C;&#x5584;&#xFF0C;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x5BF9;&#x7684;&#xFF0C;&#x6B22;&#x8FCE;&#x5927;&#x5BB6;&#x6279;&#x8BC4;&#x6307;&#x6B63;&#xFF0C;&#x5171;&#x540C;&#x5B66;&#x4E60;&#x3002;</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[3DTouch应用详解]]></title>
      <url>http://nanshanyi.github.io/2016/04/20/3dtouch/</url>
      <content type="html"><![CDATA[<p>3D touch&#x4E5F;&#x51FA;&#x4E86;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#x4E86;&#xFF0C;&#x8FD9;&#x6B21;&#x82B1;&#x65F6;&#x95F4;&#x597D;&#x597D;&#x7814;&#x7A76;&#x4E86;&#x4E00;&#x4E0B;&#xFF0C;&#x628A;&#x7ECF;&#x9A8C;&#x4E0E;&#x5927;&#x5BB6;&#x5206;&#x4EAB;&#x4E00;&#x4E0B;</p>
<h4 id="&#x4E3B;&#x754C;&#x9762;&#x91CD;&#x6309;APP&#x56FE;&#x6807;&#xFF0C;&#x5F39;&#x51FA;Touch&#x83DC;&#x5355;"><a href="#&#x4E3B;&#x754C;&#x9762;&#x91CD;&#x6309;APP&#x56FE;&#x6807;&#xFF0C;&#x5F39;&#x51FA;Touch&#x83DC;&#x5355;" class="headerlink" title="&#x4E3B;&#x754C;&#x9762;&#x91CD;&#x6309;APP&#x56FE;&#x6807;&#xFF0C;&#x5F39;&#x51FA;Touch&#x83DC;&#x5355;"></a>&#x4E3B;&#x754C;&#x9762;&#x91CD;&#x6309;APP&#x56FE;&#x6807;&#xFF0C;&#x5F39;&#x51FA;Touch&#x83DC;&#x5355;</h4><p>&#x3000;&#x9759;&#x6001;&#x5FEB;&#x901F;&#x9009;&#x9879;<br>&#x3000;&#x3000;&#x3000;(iOS&#x6570;&#x7EC4;)&#x7ED9;APP&#x6307;&#x5B9A;&#x9759;&#x6001;&#x4E3B;&#x5C4F;&#x5E55;&#x7684;&#x5FEB;&#x901F;&#x9009;&#x9879;&#xFF0C;&#x8FD9;&#x4E2A;&#x952E;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x6570;&#x7EC4;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B57;&#x5178;&#x5305;&#x542B;&#x5173;&#x4E8E;&#x4E00;&#x4E2A;&#x5FEB;&#x901F;&#x9009;&#x9879;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x9759;&#x6001;&#x5FEB;&#x901F;&#x9009;&#x9879;&#x7ED9;&#x4F60;&#x7684;APP&#x7528;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x6570;&#x7EC4;&#x3002;<br><img src="/2016/04/20/3dtouch/966908-a293ac389bddf444.png" alt=""><br>&#x3000;UIApplicationShortcutItems (iOS&#x6570;&#x7EC4;)&#x7ED9;APP&#x6307;&#x5B9A;&#x9759;&#x6001;&#x4E3B;&#x5C4F;&#x5E55;&#x7684;&#x5FEB;&#x901F;&#x9009;&#x9879;&#xFF0C;&#x8FD9;&#x4E2A;&#x952E;&#x5305;&#x542B;&#x4E86;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x6570;&#x7EC4;&#xFF0C;&#x6BCF;&#x4E2A;&#x5B57;&#x5178;&#x5305;&#x542B;&#x5173;&#x4E8E;&#x4E00;&#x4E2A;&#x5FEB;&#x901F;&#x9009;&#x9879;&#x7684;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;&#x3002;&#x4F60;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x9759;&#x6001;&#x5FEB;&#x901F;&#x9009;&#x9879;&#x7ED9;&#x4F60;&#x7684;APP&#x7528;&#x4E00;&#x4E2A;&#x5B57;&#x5178;&#x6570;&#x7EC4;&#x3002;<br><a id="more"></a><br>&#x9759;&#x6001;&#x5B9A;&#x4E49;&#x5FEB;&#x901F;&#x5728;&#x8FD0;&#x884C;&#x65F6;&#x5E38;&#x7528;&#x7684;key:<br>UIApplicationShortcutItemType (&#x5FC5;&#x987B;&#x4F7F;&#x7528;) &#x7528;&#x6765;&#x533A;&#x5206;&#x4E0E;&#x5176;&#x4ED6;&#x5FEB;&#x901F;&#x9009;&#x9879;&#x7684;&#x5206;&#x7C7B;<br>UIApplicationShortcutItemTitle (&#x5FC5;&#x987B;&#x4F7F;&#x7528;) &#x5FEB;&#x901F;&#x9009;&#x9879;&#x663E;&#x793A;&#x7684;&#x6807;&#x9898;<br>UIApplicationShortcutItemSubtitle &#x5FEB;&#x901F;&#x9009;&#x9879;&#x663E;&#x793A;&#x7684;&#x5B50;&#x6807;&#x9898;<br>UIApplicationShortcutItemIconType &#x56FE;&#x7247;&#x7C7B;&#x578B;&#x7531;&#x7CFB;&#x7EDF;&#x63D0;&#x4F9B;&#xFF08; iOS9.1&#x4E4B;&#x540E;&#x65B0;&#x6DFB;&#x52A0;&#x4E86;&#x8BB8;&#x591A;&#x56FE;&#x7247;&#x7C7B;&#x578B;&#xFF09;<br>UIApplicationShortcutItemIconFile &#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x56FE;&#x6807;<br>UIApplicationShortcutItemUserInfo &#x9644;&#x52A0;&#x4FE1;&#x606F;</p>
<h4 id="&#x52A8;&#x6001;&#x5FEB;&#x901F;&#x9009;&#x9879;"><a href="#&#x52A8;&#x6001;&#x5FEB;&#x901F;&#x9009;&#x9879;" class="headerlink" title="&#x52A8;&#x6001;&#x5FEB;&#x901F;&#x9009;&#x9879;"></a>&#x52A8;&#x6001;&#x5FEB;&#x901F;&#x9009;&#x9879;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions {</span><br><span class="line"><span class="built_in">UIApplicationShortcutItem</span> * item = [[<span class="built_in">UIApplicationShortcutItem</span> alloc]initWithType:<span class="string">@&quot;two&quot;</span> localizedTitle:<span class="string">@&quot;&#x641C;&#x7D22;&quot;</span> localizedSubtitle:<span class="string">@&quot;&#x4E00;&#x6B65;&#x5230;&#x8FBE;&#x6307;&#x5B9A;&#x5730;&#x70B9;&quot;</span> icon:[<span class="built_in">UIApplicationShortcutIcon</span> iconWithType:<span class="built_in">UIApplicationShortcutIconTypeSearch</span>] userInfo:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">UIApplicationShortcutItem</span> * item1 = [[<span class="built_in">UIApplicationShortcutItem</span> alloc]initWithType:<span class="string">@&quot;three&quot;</span> localizedTitle:<span class="string">@&quot;&#x9644;&#x8FD1;&quot;</span> localizedSubtitle:<span class="string">@&quot;&#x597D;&#x5403;&#x7684;&quot;</span> icon:[<span class="built_in">UIApplicationShortcutIcon</span> iconWithType:<span class="built_in">UIApplicationShortcutIconTypeMarkLocation</span>] userInfo:<span class="literal">nil</span>];</span><br><span class="line">[<span class="built_in">UIApplication</span> sharedApplication].shortcutItems = @[item,item1];</span><br></pre></td></tr></table></figure>
<p><img src="/2016/04/20/3dtouch/966908-b0ccf43482e4f83d.png" alt=""></p>
<h4 id="&#x9009;&#x62E9;item&#x540E;&#x89E6;&#x53D1;&#x7684;&#x65B9;&#x6CD5;"><a href="#&#x9009;&#x62E9;item&#x540E;&#x89E6;&#x53D1;&#x7684;&#x65B9;&#x6CD5;" class="headerlink" title="&#x9009;&#x62E9;item&#x540E;&#x89E6;&#x53D1;&#x7684;&#x65B9;&#x6CD5;"></a>&#x9009;&#x62E9;item&#x540E;&#x89E6;&#x53D1;&#x7684;&#x65B9;&#x6CD5;</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"> - (<span class="keyword">void</span>)application:(<span class="built_in">UIApplication</span> *)application performActionForShortcutItem:(nonnull     <span class="built_in">UIApplicationShortcutItem</span> *)shortcutItem completionHandler:(nonnull <span class="keyword">void</span>   (^)(<span class="built_in">BOOL</span>))completionHandler{</span><br><span class="line">&#x3000;&#x3000;<span class="comment">//&#x901A;&#x8FC7;shortcutItem.type&#x6765;&#x5224;&#x65AD;&#x70B9;&#x51FB;&#x7684;&#x662F;&#x54EA;&#x4E00;&#x4E2A;item&#xFF0C;&#x6765;&#x8FDB;&#x884C;&#x4E0D;&#x540C;&#x7684;&#x64CD;&#x4F5C;</span></span><br><span class="line">  <span class="keyword">if</span> ([shortcutItem.type isEqualToString:<span class="string">@&quot;one&quot;</span>]) {</span><br><span class="line">        <span class="built_in">UITabBarController</span> *mytab = (<span class="built_in">UITabBarController</span>*)<span class="keyword">self</span>.window.rootViewController;</span><br><span class="line">        mytab.selectedIndex = <span class="number">0</span>;</span><br><span class="line">    }<span class="keyword">else</span> <span class="keyword">if</span> ([shortcutItem.type isEqualToString:<span class="string">@&quot;two&quot;</span>]){</span><br><span class="line">        SearchVC *searchVC = [[SearchVC alloc]init];</span><br><span class="line">        <span class="built_in">UITabBarController</span> *mytab = (<span class="built_in">UITabBarController</span>*)<span class="keyword">self</span>.window.rootViewController;</span><br><span class="line">        <span class="built_in">UINavigationController</span> *myNAV = [mytab.viewControllers firstObject];</span><br><span class="line">      [myNAV pushViewController:searchVC animated:<span class="literal">YES</span>];</span><br><span class="line"><span class="comment">// [self.window.rootViewController presentViewController:searchVC animated:YES completion:nil];</span></span><br><span class="line">  }<span class="keyword">else</span>{</span><br><span class="line">      FPHNearbyVC *vc = [[FPHNearbyVC alloc] init];</span><br><span class="line">      <span class="built_in">UITabBarController</span> *mytab = (<span class="built_in">UITabBarController</span>*)<span class="keyword">self</span>.window.rootViewController;</span><br><span class="line">      <span class="built_in">UINavigationController</span> *myNAV = [mytab.viewControllers firstObject];</span><br><span class="line">      vc.hidesBottomBarWhenPushed = <span class="literal">YES</span>;</span><br><span class="line">       [myNAV pushViewController:vc animated:<span class="literal">YES</span>];</span><br><span class="line">     }</span><br><span class="line">     completionHandler(<span class="literal">YES</span>);</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<h4 id="APP&#x5185;&#x90E8;peek&#x548C;pop&#x7684;&#x4F7F;&#x7528;&#xFF08;&#x4EE5;tableView&#x4E2D;&#x7684;&#x4F7F;&#x7528;&#x4E3A;&#x4F8B;&#xFF09;"><a href="#APP&#x5185;&#x90E8;peek&#x548C;pop&#x7684;&#x4F7F;&#x7528;&#xFF08;&#x4EE5;tableView&#x4E2D;&#x7684;&#x4F7F;&#x7528;&#x4E3A;&#x4F8B;&#xFF09;" class="headerlink" title="APP&#x5185;&#x90E8;peek&#x548C;pop&#x7684;&#x4F7F;&#x7528;&#xFF08;&#x4EE5;tableView&#x4E2D;&#x7684;&#x4F7F;&#x7528;&#x4E3A;&#x4F8B;&#xFF09;"></a>APP&#x5185;&#x90E8;peek&#x548C;pop&#x7684;&#x4F7F;&#x7528;&#xFF08;&#x4EE5;tableView&#x4E2D;&#x7684;&#x4F7F;&#x7528;&#x4E3A;&#x4F8B;&#xFF09;</h4><p>&#x3000;&#x3000;&#x9996;&#x5148;&#x9075;&#x5B88;&#x534F;&#x8BAE;UIViewControllerPreviewingDelegate<br>&#x3000;&#x3000;&#x68C0;&#x6D4B;&#x662F;&#x5426;&#x6709;3Dtouch&#xFF1B;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)check3DTouch{</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">self</span>.traitCollection.forceTouchCapability == <span class="built_in">UIForceTouchCapabilityAvailable</span>)</span><br><span class="line">{</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@&quot;3D Touch &#x5F00;&#x542F;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line">   <span class="keyword">else</span>{</span><br><span class="line"></span><br><span class="line">      }</span><br><span class="line">  }</span><br></pre></td></tr></table></figure></p>
<p>&#x3000;&#x3000;&#x4E0B;&#x9762;&#x6765;&#x5B9E;&#x73B0;&#x76F8;&#x5E94;&#x7684;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//peek&#x7684;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#xFF0C;&#x8F7B;&#x6309;&#x5373;&#x53EF;&#x89E6;&#x53D1;&#x5F39;&#x51FA;vc</span></span><br><span class="line"> - (<span class="built_in">UIViewController</span> *)previewingContext:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerPreviewing</span>&gt;)previewingContext viewControllerForLocation:(<span class="built_in">CGPoint</span>)location{</span><br><span class="line">     <span class="built_in">NSIndexPath</span> *indexPath = [_tableView indexPathForCell:(<span class="built_in">UITableViewCell</span>* )[previewingContext sourceView]];</span><br><span class="line"><span class="comment">//&#x901A;&#x8FC7;[previewingContext sourceView]&#x62FF;&#x5230;&#x5BF9;&#x5E94;&#x7684;cell&#xFF1B;&#x3000;&#x3000;</span></span><br><span class="line">  NewVC *vc = [[FPHNewHouseDetailVC alloc] init];</span><br><span class="line">  newModel *model= [_tableView objectAtIndex:indexPath.row];</span><br><span class="line">  vc.pid = house.id;</span><br><span class="line"></span><br><span class="line">  <span class="built_in">NSLog</span>(<span class="string">@&quot;%@&quot;</span>,location);</span><br><span class="line">  <span class="keyword">return</span> vc;</span><br><span class="line">   }</span><br><span class="line"><span class="comment">//pop&#x7684;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#xFF0C;&#x5728;&#x6B64;&#x5904;&#x53EF;&#x5BF9;&#x5C06;&#x8981;&#x8FDB;&#x5165;&#x7684;vc&#x8FDB;&#x884C;&#x5904;&#x7406;&#xFF0C;&#x6BD4;&#x5982;&#x9690;&#x85CF;tabBar&#xFF1B;</span></span><br><span class="line"> - (<span class="keyword">void</span>)previewingContext:(<span class="keyword">id</span> &lt;<span class="built_in">UIViewControllerPreviewing</span>&gt;)previewingContext commitViewController:(<span class="built_in">UIViewController</span> *)viewControllerToCommit</span><br><span class="line"> {</span><br><span class="line">     viewControllerToCommit.hidesBottomBarWhenPushed = <span class="literal">YES</span>;</span><br><span class="line">    [<span class="keyword">self</span> showViewController:viewControllerToCommit sender:<span class="keyword">self</span>];</span><br><span class="line"> }</span><br></pre></td></tr></table></figure></p>
<p> <strong>&#x6CE8;&#x610F;&#xFF1A;</strong>tableView&#x5728;<br>&#x3000;&#x3000;&#x3000;&#x3000;- (UITableViewCell<em>)tableView:(UITableView </em>)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath<br>&#x3000;&#x3000;&#x65B9;&#x6CD5;&#x4E2D;&#x4E00;&#x5B9A;&#x8981;&#x5BF9;&#x6BCF;&#x4E2A;cell&#x8FDB;&#x884C;&#x6CE8;&#x518C;&#x4EE3;&#x7406;&#x65B9;&#x6CD5;&#x5982;&#x4E0B;<br>&#x3000;&#x3000;[self registerForPreviewingWithDelegate:self sourceView:cell];</p>
<h4 id="&#x9884;&#x89C8;&#x65F6;&#x5E95;&#x90E8;&#x83DC;&#x5355;&#x7684;&#x6DFB;&#x52A0;"><a href="#&#x9884;&#x89C8;&#x65F6;&#x5E95;&#x90E8;&#x83DC;&#x5355;&#x7684;&#x6DFB;&#x52A0;" class="headerlink" title="&#x9884;&#x89C8;&#x65F6;&#x5E95;&#x90E8;&#x83DC;&#x5355;&#x7684;&#x6DFB;&#x52A0;"></a>&#x9884;&#x89C8;&#x65F6;&#x5E95;&#x90E8;&#x83DC;&#x5355;&#x7684;&#x6DFB;&#x52A0;</h4><p>&#x5728;&#x8981;&#x9884;&#x89C8;&#x7684;VC&#x4E2D;&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">-(<span class="built_in">NSArray</span>&lt;<span class="keyword">id</span>&lt;<span class="built_in">UIPreviewActionItem</span>&gt;&gt; *)previewActionItems</span><br><span class="line">{</span><br><span class="line"><span class="built_in">UIPreviewAction</span> * action1 = [<span class="built_in">UIPreviewAction</span> actionWithTitle:<span class="string">@&quot;&#x6807;&#x9898;1&quot;</span> style:<span class="number">1</span> handler:^(<span class="built_in">UIPreviewAction</span> * _Nonnull action, <span class="built_in">UIViewController</span> * _Nonnull previewViewController) {</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;&#x6807;&#x9898;1&quot;</span>);</span><br><span class="line"> }];</span><br><span class="line"></span><br><span class="line"><span class="built_in">UIPreviewAction</span> * action2 = [<span class="built_in">UIPreviewAction</span> actionWithTitle:<span class="string">@&quot;&#x6807;&#x9898;2&quot;</span> style:<span class="number">0</span> handler:^(<span class="built_in">UIPreviewAction</span> * _Nonnull action, <span class="built_in">UIViewController</span> * _Nonnull previewViewController) {</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@&quot;&#x6807;&#x9898;2&quot;</span>);</span><br><span class="line"></span><br><span class="line"> }];</span><br><span class="line"><span class="built_in">UIPreviewAction</span> * action3 = [<span class="built_in">UIPreviewAction</span> actionWithTitle:<span class="string">@&quot;&#x6807;&#x9898;3&quot;</span> style:<span class="number">2</span> handler:^(<span class="built_in">UIPreviewAction</span> * _Nonnull action, <span class="built_in">UIViewController</span> * _Nonnull previewViewController) {</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@&quot;&#x6807;&#x9898;3&quot;</span>);</span><br><span class="line"> }];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSArray</span> * actions = @[action1,action2,action3];</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> actions;</span><br><span class="line">}</span><br></pre></td></tr></table></figure>
<p>&#x3000;&#x3000;&#x3000;&#x3000;block&#x91CC;&#x9762;&#x76F4;&#x63A5;&#x5199;&#x70B9;&#x51FB;&#x540E;&#x8981;&#x5B9E;&#x73B0;&#x7684;&#x64CD;&#x4F5C;<br>&#x6700;&#x7EC8;&#x6548;&#x679C;&#xFF1A;<br><img src="/2016/04/20/3dtouch/966908-976af00f57dd4439.png" alt=""><br> &#x3000;&#x3000;&#x6682;&#x65F6;&#x5C31;&#x5199;&#x8FD9;&#x4E48;&#x591A;&#xFF0C;&#x6709;&#x4EC0;&#x4E48;&#x4E0D;&#x5BF9;&#x7684;&#x5730;&#x65B9;&#x8BF7;&#x5927;&#x5BB6;&#x6307;&#x6559;&#xFF0C;&#x5927;&#x5BB6;&#x4E92;&#x76F8;&#x5B66;&#x4E60;&#x3002;</p>
]]></content>
    </entry>
    
  
  
</search>
